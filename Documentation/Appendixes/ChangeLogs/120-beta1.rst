====================
1.2.0-beta1
====================

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Base Distribution
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[TASK] Composer manifest: Switch to Flow 2.3 beta
-----------------------------------------------------------------------------------------

* Commit: `82f6730 <https://git.typo3.org/Neos/Distributions/Base.git/commit/82f673070ebfeb94b7df839897fb7905cbf4570b>`_

[TASK] Composer manifest: drop dev stability and use Flow 2.3 branch
-----------------------------------------------------------------------------------------

Related: NEOS-259

* Commit: `10e5dea <https://git.typo3.org/Neos/Distributions/Base.git/commit/10e5deaf27b692616091afb79c6aab9e76a73205>`_

[TASK] Update composer manifest
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/typo3-neos-branch/4/

* Commit: `ca03b87 <https://git.typo3.org/Neos/Distributions/Base.git/commit/ca03b874541e4fe9bc8c4be0e1de7ee31a60f721>`_

[TASK] Update release scripts to include Media with Neos
-----------------------------------------------------------------------------------------

This makes sure TYPO3.Media is released together with Neos.

* Commit: `3fcfe89 <https://git.typo3.org/Neos/Distributions/Base.git/commit/3fcfe89747f8bc34bbf298e9d18cde8526945bc6>`_

[TASK] Add PHP_CodeSniffer to composer dev requirements
-----------------------------------------------------------------------------------------

This change enables the possibility to run codesniffs with
the following command:

bin/phpcs --standard=TYPO3Flow --extensions=php <path to sniff>

* Commit: `9de75db <https://git.typo3.org/Neos/Distributions/Base.git/commit/9de75db4fdb9ab04b9f180f283dc02fcda0185fa>`_

[TASK] Remove unneeded selenium testing configuration
-----------------------------------------------------------------------------------------

This removes the Tests folder and build.xml from the
Neos Base Distribution.

Resolves: NEOS-300

* Commit: `7de7b41 <https://git.typo3.org/Neos/Distributions/Base.git/commit/7de7b41a8b4ab8051364b7975efbb0bde3ffec21>`_

[TASK] Upgrade PHPUnit to 4.0.*
-----------------------------------------------------------------------------------------

* Commit: `dc01514 <https://git.typo3.org/Neos/Distributions/Base.git/commit/dc01514ea1141bc4ea6a477020692c4fb400f639>`_

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TYPO3.Neos
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[TASK] Update references in documentation
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/TYPO3%20Neos%20Release/20/

* Commit: `8ab1552 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8ab1552f8c3a743e84bcd5328a66094ae693731d>`_

[TASK] Document custom validator/editor use for node properties
-----------------------------------------------------------------------------------------

Documents the use of custom (JS) validators and editors for the
inspector implemented with https://review.typo3.org/26005.

Resolves: NEOS-223

* Commit: `1ddb4c0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1ddb4c0ad5e13eea8ba0d5877f97ef5eec49f71a>`_

[TASK] Make preset name & preset configuration available in dimension menu
-----------------------------------------------------------------------------------------

Related: NEOS-299

* Commit: `cb22ac4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/cb22ac41f9b44ea4722ca1d5106803320eee65e3>`_

[FEATURE] Dimension/Language Menu
-----------------------------------------------------------------------------------------

Create links to other node variants (e.g. variants of the
current node in another dimension) by using this TypoScript object.

Minimal Example, outputting a language menu with all configured
dimensions::

	languageMenu = TYPO3.Neos:DimensionMenu {
		dimension = 'language'
	}

If you only want to render a subset of the available dimensions
or manually define a specific order for this language menu,
you can override the "presets":

Overridden presets::

	languageMenu = TYPO3.Neos:DimensionMenu {
		dimension = 'language'
		presets = ${['en_US', 'de_DE']}
	}

No matter how many languages are defined, only these two are displayed.

Resolves: NEOS-118

(cherry picked from commit 475a82e1c298c23e33d32f42a196b91a9f4adbd1)

* Commit: `4d945e4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4d945e4c62035a60dc2e899c1bf3920810bc6db0>`_

[TASK] Add documentation about content dimensions and translating content
-----------------------------------------------------------------------------------------

Resolves: NEOS-299

(cherry picked from commit b2fba7b2df308a99627ea05791177c568a0555c3)

* Commit: `ef25f2f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ef25f2fbfa496c6df6038c60a7bc47dc00651897>`_

[!!!][TASK] Move FlowQueryOperations concerning nodes to TYPO3CR
-----------------------------------------------------------------------------------------

All FlowQuery operations concerning nodes have no dependencies
on the TYPO3.Neos package, but only on the TYPO3.TYPO3CR package.
The rightfully belong there and probably ended up in the Neos
package before the TYPO3.Eel package became part of the Flow base
distribution. Now that Eel is available all the time the
operations can as well reside in TYPO3CR which allows to use
them without installing the Neos package at all.

This change is breaking if you extended the FlowQueryOperations
that are now moved. You need to extend from the same class in
TYPO3CR now.

The needed namespace replacement is from::

  ``TYPO3\\Neos\\TypoScript\\FlowQueryOperations``

to::

  ``TYPO3\\TYPO3CR\\Eel\\FlowQueryOperations``

Resolves: NEOS-405

* Commit: `51cf7d4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/51cf7d4d30eb3a74873c18b71acba55b8bfe17f5>`_

[BUGFIX] Routing: only flush related caches when a node changes
-----------------------------------------------------------------------------------------

Currently the complete routing cache is flushed whenever a node is
changed. This can have a noticeable negative impact on performance of
both Frontend and Backend.

With this change only the cache for affected nodes is cleared when
a node is published and/or the "uriPathSegment" property was changed.

Depends: I49da56cd705e41fdc96fe84ac4936d268a0b6f06

Fixes: NEOS-673
Related: NEOS-296

* Commit: `54e5cd7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/54e5cd7e6709d74157e51bb11ee87482279b56e9>`_

[BUGFIX] Adjust code migration identifier pattern to contain the full timestamp
-----------------------------------------------------------------------------------------

Previously code migrations are expected to have a class name with the
pattern ``Version<YYYYMMDDhhmm>`` and the unique identifier was
determined extracting the last 12 characters of the class name (which
are expected to be the timestamp).

This change adjusts existing code migrations to use the full timestamp in
order to establish the new guideline (note: those migrations still
return the old identifier so that they won't be applied again with a
new identifier).

Related: FLOW-110

* Commit: `e4a816a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e4a816ac1c1094848905da76ad71b7be661c9765>`_

[TASK] Remove unused method in NodeView
-----------------------------------------------------------------------------------------

* Commit: `0c07f05 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0c07f05b267d66036008e4c3ce28730ffb1eb1aa>`_

[FEATURE] Dynamically loaded options for the inspectors SelectBoxEditor
-----------------------------------------------------------------------------------------

Introduces a concept of data sources to allow easy
integration of data source end points, to provide
data to the editing interface without having to define
routes, policies, controller.

Usage::

  'Acme.Demo:FAQ':
    properties:
      questions:
        ui:
          inspector:
            editor: 'Content/Inspector/Editors/SelectBoxEditor'
            editorOptions:
              dataSourceIdentifier: 'questions'
              # alternatively using a custom uri:
              dataSourceUri: 'custom-route/end-point'

Accompanied by a class that implements
``TYPO3\\Neos\\Service\\DataSource\\DataSourceInterface``, preferably by
extending ``TYPO3\\Neos\\Service\\DataSource\\AbstractDataSource``.

Resolves: NEOS-529

* Commit: `58f7d7d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/58f7d7d401734b38e6083ace0f6fe390a435864b>`_

[TASK] Improve exception handling during rendering
-----------------------------------------------------------------------------------------

Improves the exception handling by changing the way
exceptions are thrown for content and by rendering
a fallback page if the whole page couldn't be rendered.

The exception handling for content elements is changed so
that it now only outputs a XML comment in the frontend in
production context. When logged in a short message, without
technical detail is displayed in production context.
In development the output is the same as before, consisting
of a exception message and a TypoScript path.

The exception handling for the whole page is improved so
instead of just always displaying a message when broken,
it renders an error page with a styled message. In development
context a technical message is displayed, while it's only outputted
as a XML comment in production context. This makes it possible to
navigate the backend, even though the current page is broken.

Resolves: NEOS-344

* Commit: `d1b0496 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d1b0496f9ed538008c5588174868a3df8577d561>`_

[!!!][BUGFIX] Fix linking behavior
-----------------------------------------------------------------------------------------

This adjusts Neos' way of dealing with links to shortcut nodes in several
areas.
Links to shortcut pages are now properly resolved: The label of the link
will be taken from the shortcut page node but the link points directly to
the target node or external URI.

This is a breaking change if you relied on the previous behavior.
That is especially noticeable if the root node of a site is a shortcut.
In that case a link pointing to the "homepage" will now directly point
to the target of the root node instead of pointing to "/" and
redirecting to the target on click.

Related: NEOS-564

* Commit: `e56f442 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e56f4420abfcfd50fab0665cecf5f281516bedb0>`_

[BUGFIX] Content dimensions fetched in modules
-----------------------------------------------------------------------------------------

When opening a module the content dimension selector
fetches the available dimensions, even though the
content dimension selector won't be displayed.

Related: NEOS-546

* Commit: `c360960 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c3609604319f77a5d68284dc2e7b99f62fa3ab9a>`_

[TASK] Add QUnit for running JavaScript tests
-----------------------------------------------------------------------------------------

This adds a new grunt task for running the JS tests. In the Neos package, do::

  cd Scripts
  grunt test

PhantomJS is installed automatically as a dependency via npm for this, see
``Scripts/install-phantomjs.sh`` for some dependencies you might need on top.

Resolves: NEOS-663

* Commit: `9a40286 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9a402864f78c8789955aa604206c2c3397d1c7e7>`_

[TASK] Use grunt for building css and js
-----------------------------------------------------------------------------------------

To have consistent results the processes for compiling scss
and js files into those files loaded by the browser, we now
use grunt to have a defined process. This also means we need
to define exactly which version of the tools is used.

Therefore we install compass locally into the project
instead of using a version installed into the system. To
install compass the ruby package manager bundler is used.

For new developers it might be hard to figure out what needs
to be installed. This therefore also adds a script which
gives hints how to install necessary tools like node, npm
and bundler. It then uses these tools to install grunt,
compass, etc.

::

  Scripts/install-grunt.sh

To prevent confusion with the old r.js -o build.js command
the build.js is moved to the Scripts folder. Compiling
all javascript and css can now be done by 'grunt build'::

  cd Scripts
  grunt build

Related: NEOS-439

* Commit: `daf866d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/daf866de48d52ecd139f9ac99475a10934c45ed9>`_

[BUGFIX] Fix duplicate error codes in PasswordValidator and HostnameValidator
-----------------------------------------------------------------------------------------

This change assigns a new error code to the "invalid hostname" error in
the HostnameValidator (the PasswordValidator is older and thus "wins").

This is needed to allow correct detection, display and error message
translation of that error.

The XLIFF files are adjusted as well and the (wrong) translations are
reset to the original (english) string.

* Commit: `1bc88b1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1bc88b1f42d503e64d994842044f4c1f1500e76b>`_

[TASK] Update the Page prototype to use the new TS prototype Http.Message
-----------------------------------------------------------------------------------------

This adds a way to change the HTTP status code and headers in TypoScript::

    prototype(YourPackage:Page) < prototype(TYPO3.TypoScript:Http.Message) {
	    httpResponseHead {
		    headers {
			    Content-Type = 'application/xml'
    		}
    	}
    	content = TYPO3.TypoScript:Template {
    		...
    	}
    }

Related: NEOS-449

* Commit: `1d85ce6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1d85ce6da9b7066da6f391dd12c342c0c0401c81>`_

[!!!][FEATURE] Make button label and highlighting mode configurable
-----------------------------------------------------------------------------------------

The HTML editor uses code mirror and could thus be used to edit
other types of textual content as well. To allow this two new
``editorOptions`` are introduced:

- ``buttonLabel`` overwrites the text on the button to open the editor
- ``highlightingMode`` overwrites the default (text/html) highlighting

This is breaking if you used the HtmlEditor in your node types. To
adjust, you need to replace *HtmlEditor* with *CodeEditor*, either
manually or with::

  ./flow core:migrate --package-key <your package>

Resolves: NEOS-379

* Commit: `6ffcff4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6ffcff469a5d74bb9a35b70da1a42b95a033fcf3>`_

[BUGFIX] Make legacy site import tests independent from demo site
-----------------------------------------------------------------------------------------

Adjusts the LegacySiteImportServiceTest fixture so that the functional
tests don't fail if the ``TYPO3.NeosDemoTypo3Org`` package is not
installed.

* Commit: `690c05d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/690c05de926efc64584158e18f648577a1754765>`_

[TASK] Fix content cache clearing in Behat scenarios
-----------------------------------------------------------------------------------------

The glob pattern could not match any directory, so the content cache
produced wrong results for the scenarios.

Additionally a leaking detached Workspace instance is prevented by
clearing all node instances before importing the site.

* Commit: `b6aef86 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b6aef86ebe2639f685e288b254e573c31fad6be7>`_

[BUGFIX] Incorrect handling of integer values in SelectBoxEditor
-----------------------------------------------------------------------------------------

If a option value is can be interpreted as a finite number it is
treated as an integer, regardless of it being a string value.
This results in wrong behavior where the editor is marked as
modified, without it actually being so.

Related: NEOS-419

* Commit: `cca2c5e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/cca2c5e6e2fdda209b9097eb100e8cd810e19977>`_

[BUGFIX] Skip null values in inspector SelectBoxEditor
-----------------------------------------------------------------------------------------

Values without configuration should be treated as unset
values and not included as selectable options.

Related: NEOS-419

* Commit: `7c71526 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7c71526e61e673b9a4e8a92be56e54c462efb1d4>`_

[FEATURE] Routing: content dimension / translation support
-----------------------------------------------------------------------------------------

This change introduces translatable URI segments and
general support for content dimensions in the frontend node
route part handler. Editors may change the path segment of
a specific document node (for example a page) in the inspector.

The route part handler which renders and matches the URIs
does not use a node's name anymore but refers to a new
node property "uriPathSegment". This finally decouples
URI generation from the internal node structure and naming.

This change also makes sure that router caches are flushed if
any node is updated, removed, published or discarded. That
is refined in a separate change.

In order to migrate existing websites, you must run the "node:repair"
command in order to fill the new uriPathSegment properties.

If you used the "LocalizedRoutePartHandler" from a development
version of Neos, you need to remove the respective Objects.yaml
configuration.

Resolves: NEOS-296

* Commit: `757fca6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/757fca6f3602f019a9496b9ac1f952e10c54c1ce>`_

[TASK] Add icons to reference(s) inspector editor results
-----------------------------------------------------------------------------------------

Resolves: NEOS-409

* Commit: `1834ec6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1834ec613bbcf49b0a44388c07734d893805a32b>`_

[TASK] Improve usability of publishing button
-----------------------------------------------------------------------------------------

* Change publish button state during publishing (add ellipsis)
* Change dropdown button during publish all/discard actions (ellipsis
  instead of arrow)
* Ensure buttons cannot be clicked during publishing/discarding
* Disable buttons during saving of content changes/having
  pending content saves
* Change publish button color to orange when save changes are pending
* Ensure publish all count is updated after publishing/discarding
* Display error messages if publish/discard failed
* Only discard changes if actually nodes to be discarded are available

Related: NEOS-348

* Commit: `74ca5b2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/74ca5b2d397fb968c53b398b38f716d313339a9f>`_

[FEATURE] Crop aspect ratio lock presets (image editor)
-----------------------------------------------------------------------------------------

Introduces aspect ratio lock presets for the cropping
in the inspector image editor. Multiple presets can be
configured, additionally it's optional to allow custom
ratios and to enable the original ratio as an option.

Additionally a locked aspect ratio can be configured
to ensure a specific aspect ratio of all images in
that image property.

Example configuration::

  editorOptions:
    crop:
      aspectRatio:
        options:
          square:
            width: 1
            height: 1
            label: 'Square'
          fourFive:
            width: 4
            height: 5
        enableOriginal: TRUE
        allowCustom: TRUE
        locked:
          width: 0
          height: 0

Example of disabling available options::

  # Disable ``square`` option
  'Acme.Demo:Image':
    properties:
      image:
        ui:
          inspector:
            editorOptions:
              crop:
                aspectRatio:
                  options:
                    square: ~

Resolves: NEOS-557

* Commit: `6ac1370 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6ac1370d1fe21392226b03af098921603438200b>`_

[BUGFIX] Gracefully handle links to removed nodes/assets
-----------------------------------------------------------------------------------------

Links to nodes/assets that cannot be resolved will now be
unlinked automatically.

When nodes and assets can not be resolved in the LinkService an
exception is thrown. This causes an issue in the ConvertUrisImplementation
object as it will throw an exception. This leads to the fatal
error ``__toString should not throw an exception`` and as such
a white page on production servers.

This change makes LinkingService::createNodeUri() and createAssetUri()
return NULL if $node/$asset was NULL as well (which was already
anticipated by the method anyways).

Fixes: NEOS-564

(cherry picked from commit be6ddf5d68e140b667996e077c1545f6aff47e2e)

* Commit: `2fcd3c5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2fcd3c55f0a63fe8d71d93824f2c31cf7d9a1271>`_

[TASK] Document change in layout properties
-----------------------------------------------------------------------------------------

(cherry picked from commit bd88d62e6942247744feba3da3977704a5870085)

* Commit: `1166150 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/116615035a0bf92e5131cab701be42ba3293b8cd>`_

[FEATURE] External events when panels open/close and layout changes
-----------------------------------------------------------------------------------------

This change adds several new events that will be triggered a
panel is opened or closed, causing the viewport of the content
area to be resized.

 - ``Neos.LayoutChanged`` When the content window layout changes (when panels
                          that alter the body margin are opened/closed).
 - ``Neos.NavigatePanelOpened`` When the navigate panel is opened.
 - ``Neos.NavigatePanelClosed`` When the inspector panel is closed.
 - ``Neos.InspectorPanelOpened`` When the navigate panel is opened.
 - ``Neos.InspectorPanelClosed`` When the inspector panel is closed.
 - ``Neos.EditPreviewPanelOpened`` When the edit/preview panel is opened.
 - ``Neos.EditPreviewPanelClosed`` When the edit/preview panel is closed.
 - ``Neos.MenuPanelOpened`` When the menu panel is opened.
 - ``Neos.MenuPanelClosed`` When the menu panel is closed.

Resolves: NEOS-408

* Commit: `a2a39e4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a2a39e43df7a44e8d3cd6a3b394a3e6b58bc1a08>`_

[FEATURE] Extensible node search service
-----------------------------------------------------------------------------------------

Add an interface for the node search service allowing
it to be extended with a better search algorithm.

Resolves: NEOS-535

* Commit: `17572bb <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/17572bb0b507e9265ccb72628aae5e48fc6c52d4>`_

[TASK] Refactor usage of data attributes for node data
-----------------------------------------------------------------------------------------

The usage and naming of data attributes for the node data
is very inconsistent and there's no clear rules.

- Renames node attributes from data-neos-* to data-node-*.
  Direct properties of the node are prefixed with _ and internal
  non properties are prefixed with __.
- Replaces all usage of .attr('data with .data('
- Renames some of the attributes to match their actual content
- Replaces usages of reserved word "arguments"
- Adds missing dependency in PluginViewEditor

Resolves: NEOS-356

* Commit: `50478e2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/50478e20a9a70151a86eb3816cc7bdba1c7ba772>`_

[TASK] Document TS include syntax in Integrator Guide
-----------------------------------------------------------------------------------------

This adds a section on TypoScript ``include`` to the Integrator Guide
chapter "Inside TypoScript".

Related: NEOS-440

* Commit: `cf6b494 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/cf6b49459efd6e5e2e707f298a1f76a5e1d7334e>`_

[!!!][FEATURE] Use node label for link.node view helper
-----------------------------------------------------------------------------------------

Changes the output of the view helper to use the node's label
if nothing else is defined. Additionally it makes the linked node
available as a variable named "linkedNode" that can be used when
rendering the content. Example::

  <n:link.node node="subpage">{linkedNode.label}</n:link.node>

The variable name can be changed by defining
the "nodeVariableName" argument.

This is breaking since it changes the behavior of empty links,
so if you relied on that you need to use the f:link.uri view helper
inside the href attribute of a normal a tag.

Resolves: NEOS-367

* Commit: `31672e5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/31672e5a7f36bd6c812467421f16c233ef47921e>`_

[BUGFIX] Deleting text in inline editable properties is slow
-----------------------------------------------------------------------------------------

When deleting text in an inline editable property it is very slow.
The problem was caused by inserting some elements that weren't even
used. The slowness was possibly caused by the elements being duplicated
multiple times.

Fixes: NEOS-585
(cherry picked from commit a1bdb096475502ecaa39349698492895df6dca32)

* Commit: `5c37db1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5c37db1610fc4580ff041b5a608344ea5d237c28>`_

[TASK] Adapt after the NodeInterface::getFullLabel removal
-----------------------------------------------------------------------------------------

This change adapt the Neos navigate component to crop node label on the
client site with CSS.

We also remove technical informations from the structure tree to have a
more clean interface. The icon for Content Collection is now a folder.

Related: NEOS-441

(cherry picked from commit 4382d4d49179e073b1205456b03310f74006f185)

* Commit: `acd6edb <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/acd6edbd51491f5bd9e76152a05b0500992bff16>`_

[TASK] Update composer manifest
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/typo3-neos-branch/4/

* Commit: `d6d7196 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d6d7196d9215d7868cdb2fdc7aa485ede1b147a1>`_

[FEATURE] Make authentication provider an argument for user:* commands
-----------------------------------------------------------------------------------------

This change allows using the CLI commands for user management
for other authentication providers than the Typo3BackendProvider.

Resolves: NEOS-592

* Commit: `9fff992 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9fff99263452fab60aa70042d58c6eec4f6b55c7>`_

[BUGFIX] Class attribute for content elements breaks with arrays
-----------------------------------------------------------------------------------------

Using a RawArray for the class attribute on content elements, an error
is thrown for not being able to convert array to string. This happens
because the node type processor tries to append to the value, which
doesn't work in case it's an array.

Fixes: NEOS-315
Fixes: NEOS-513

* Commit: `127f81f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/127f81f7f4328bc48b73e8be32bf81ef47f183f4>`_

[TASK] Login screen removes username on failed login
-----------------------------------------------------------------------------------------

When a login failed on the login screen both the username and
password fields are emptied, which is not very user friendly.

Improve it by keeping the username.

Resolves: NEOS-537

* Commit: `07e1743 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/07e17437803e7cd034b9f4e4e03d8fe68400eb3f>`_

[BUGFIX] Editor options not merged recursively
-----------------------------------------------------------------------------------------

When the editor options from different configuration
sources is merged, it only merged on the first level.
Now the merging is recursiv, which is needed for certain
inspector property editors.

* Commit: `6286244 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6286244c58d3015bad9e93eb95adf9807ace83be>`_

[BUGFIX] Node labels should not include tags
-----------------------------------------------------------------------------------------

This fixes a regression introduced with
I351b08ed576407222d32efbf35ed97668034b76a because the generated
labels with the EEL expression still contained HTML tags which
the original NodeLabelGenerator removed.
This fixes it by applying String.stripTags to the label.

* Commit: `5e4e4e5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5e4e4e5c0f24a199d57168c87658bc1b86771f8f>`_

[BUGFIX] Hostname validator produces false negatives
-----------------------------------------------------------------------------------------

The regex used in the hostname validator produced false negatives.
The commit changes the regex and adds a unit test with commom
test cases.

Fixes: NEOS-475

* Commit: `239a41f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/239a41feb4c8c6408162873d6f80a45fe8eec7f8>`_

[TASK] Code cleanup in SelectBoxEditor
-----------------------------------------------------------------------------------------

Related: NEOS-419

* Commit: `ff19e1d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ff19e1da5afc5b9641c6ae0da4235bee228ffab0>`_

[FEATURE] Multiple selection & grouping in inspector SelectBoxEditor
-----------------------------------------------------------------------------------------

Adds support for selection of multiple values in the SelectBoxEditor.
Additionally support for grouping and icons is added.
This change replaces the usage of Chosen with Select2.

Example::

  'Acme.Demo:Test':
    properties:
      multiple: TRUE
      allowEmpty: TRUE
      placeholder: 'Choose'
      values:
        a:
          label: 'A'
          group: 'x'
          icon: 'icon-legal'
        b:
          label: 'B'
          group: 'x'
          icon: 'icon-fire'

Supports:
 - Deselection for single
 - Placeholder for multi & deselectable single
 - Grouping for single & multi
 - Adds support for icons
 - Adds search icon
 - Adds no results text
 - Adds title for concatinated values
 - Fixes various issues with layout, scrolling & closing
 - Supports modified state
 - Supports revert of initial value (discard)

Affects additional editors:
 - ReferenceEditor
 - ReferencesEditor
 - LinkEditor
 - NodeTypeEditor
 - PluginViewEditor
 - MasterPluginEditor

Resolves: NEOS-419
Resolves: NEOS-421
Related: NEOS-420

* Commit: `f0dab21 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f0dab21e4a2fdde14f02399a35228e976a7c6f13>`_

[TASK] Adjust to newly available TypoScript conditions
-----------------------------------------------------------------------------------------

Replace the TypoScript processors that removed the content in
the live workspace with conditions. This is a lot quicker since
the content is not generated in the live workspace.

Additionally it cleans up the usage of security and workspace
checks.

Related: NEOS-109

* Commit: `422847d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/422847d4edd51d35a786a2aaff062471c8b8859f>`_

[!!!][TASK] Update Aloha editor
-----------------------------------------------------------------------------------------

Updates the Aloha editor to the latest stable version 1.1.3

Fixes several Aloha editing issues including the format changing
not always triggering a visual change.

Implements the autoparagraph plugin to always wrap text in paragraph tags.

Target _blank is now added automatically to external links.

Replaces b and u tags with strong and em by default (old ones are still configurable).

Enables usage of del tag (strikethrough).

Update includes options for selecting different list stylings.

Resolves a naming conflict issue between jQueryUI and Twitter
Bootstrap.

Updates jQueryUI to 1.10.4 from 1.10.3

Removes many unused parts of Aloha and jQueryUI from the build.

Fixes: NEOS-341

* Commit: `dde0c7d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/dde0c7d0210a5da3496a4bd6f32e6e41d148aac8>`_

[TASK] Allow closing dialogs with esc key
-----------------------------------------------------------------------------------------

Resolves: NEOS-217

* Commit: `28185e0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/28185e0f16019fe04358ce050b4d8ba760f3efc8>`_

[TASK] Missing compiled css for chosen-sprite@2x.png 404
-----------------------------------------------------------------------------------------

I8adec20848fbec84eb00ac397825a46396b834f0 was missing some
compiled css to work in all places.

Related: NEOS-149

* Commit: `68847b9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/68847b9d36f74c03b1d2e010ab5a79aeadca4b0f>`_

[BUGFIX] Fix 404 on loading the chosen-sprite@2x.png background image
-----------------------------------------------------------------------------------------

Fixes: NEOS-149

* Commit: `1033908 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/103390822bfdebc8beef02ff0561ae04f9424c65>`_

[BUGFIX] Use the original image in the image inspector editor
-----------------------------------------------------------------------------------------

Fixes: NEOS-416

* Commit: `7b5e777 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7b5e77782d6935ed55c122a366bfc25908b957fb>`_

[BUGFIX] Table options not visible for inline editable properties
-----------------------------------------------------------------------------------------

The Aloha table options are not displayed in the inspector when
selecting a table inside an inline editable property.

Fixes: NEOS-586

* Commit: `04183af <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/04183af9a4e628a834cdd28cc7d7888ab31ae699>`_

[BUGFIX] Prevent error when selecting inline table elements
-----------------------------------------------------------------------------------------

A regression was introduced with the node type constraints,
causing an error when selecting a table in an inline editable
property.

* Commit: `5c6dd21 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5c6dd217df00f6047835ad696cbd7f445da2cd5b>`_

[TASK] Prevent warning when compiling CSS with compass 1.0
-----------------------------------------------------------------------------------------

* Commit: `bbae73a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/bbae73a0df69c9c72efdadb7ddeeb3e97acc923c>`_

[TASK] Compile CSS using compass 1.0
-----------------------------------------------------------------------------------------

* Commit: `d856da9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d856da91fcc9e551ae9c3cbf983b8c5b61616aad>`_

[BUGFIX] Re-adds the old dummy-image.png to prevent breaking
-----------------------------------------------------------------------------------------

Fixes: NEOS-584

* Commit: `e4f03dd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e4f03dde09c48022919d421efbb85457c309469d>`_

[FEATURE] Tabs for property groups in the inspector
-----------------------------------------------------------------------------------------

Enables defining tabs to organize the property editor groups in the
inspector. Selects the last selected tab group if available when
selecting different element. If no tabs are found, nothing is shown.
Tabs can be positioned like groups.

Example::

  'Acme.Demo:Page':
    ui:
      inspector:
        tabs:
          stats:
            label: 'Statistics'
            icon: 'icon-bar-chart'
        groups:
          analytics:
            label: 'Analytics'
            tab: stats

Resolves: NEOS-580

* Commit: `87db64d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/87db64d0ee69c160eb98c5e7a254975c2b3c2b80>`_

[TASK] Refactor site:* services to use TYPO3CR services
-----------------------------------------------------------------------------------------

This changes the implementation of the site:export and site:import
service to use the new TYPO3CR node export / import domain services
instead. Only the "site" specific part remains in Neos.

If the "legacy" (1.0 and 1.1) Sites.xml format is detected, the old parser
is used (which has been renamed to LegacySiteImportService).

Resolves: NEOS-166

* Commit: `05f83d7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/05f83d729b506ab5d85992e09311be868b16a5a4>`_

[BUGFIX] Assign account only if securityContext can be initialized
-----------------------------------------------------------------------------------------

With the change I10fab119aeab6f6e2e86a217ba71c6f2b5c1efe0 rendering TS
in a CLI context from Neos became impossible (again). This change makes
sure the account is only assigned if the security context can be
initialized.

Related: NEOS-183

* Commit: `46cdece <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/46cdece8671b5b28af3c5a2e7867ed8a6893a0e8>`_

[TASK] Redirect if navigating to the login page while logged in
-----------------------------------------------------------------------------------------

Redirect to the backend if the user navigates to the login page while
logged in.

Resolves: NEOS-553

* Commit: `04c74c2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/04c74c2eef2c8f496eb58128281ea69aedaa0f44>`_

[BUGFIX] Content dimension selector and format bar clashes
-----------------------------------------------------------------------------------------

Additionally fixes some overflow issues.

Related: NEOS-361

* Commit: `4494359 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/449435937726b61917f078c1f0633a92e18e00c5>`_

[BUGFIX] Node type editor fails for document nodes without parents
-----------------------------------------------------------------------------------------

Related: NEOS-34

* Commit: `03e4db2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/03e4db2a44eec098520b5e032bc7ab4c39f39466>`_

[BUGFIX] Error action not allowed for service controllers
-----------------------------------------------------------------------------------------

Fixes: NEOS-410

* Commit: `a8749dc <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a8749dcf989f92a9785286fdac30fc017c37bdb7>`_

[BUGFIX] Failed Ajax requests leads to JS error
-----------------------------------------------------------------------------------------

Related: NEOS-183

* Commit: `790411f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/790411fd787a771f087308bf0a15f9f2c44229e4>`_

[BUGFIX] Deselecting image elements leads to an error
-----------------------------------------------------------------------------------------

When deselecting an element containing an image property,
the request for the image is aborted if it's still in progress.

However the abort method was removed in
I10fab119aeab6f6e2e86a217ba71c6f2b5c1efe0 as part of a cleanup.

This change reintroduces the abort method, preventing the error
from happening.

Fixes: NEOS-555

* Commit: `e53292e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e53292e4afd9699336fe41934479ab489cac3359>`_

[BUGFIX] MenuImplementation breaks with external shortcut targets
-----------------------------------------------------------------------------------------

The introduction of external targets for shortcuts broke the
MenuImplementation, as that did not know how to deal with strings being
returned as resolved shortcuts.

Fixes: NEOS-547

* Commit: `9cfab27 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9cfab2717fc2ddd2929731790d9891eef31c16e6>`_

[BUGFIX] Test failure in TypoScriptViewTest
-----------------------------------------------------------------------------------------

The change I10fab119aeab6f6e2e86a217ba71c6f2b5c1efe0 did not adjust one
unit test as needed, leading to failure.

Related: NEOS-183

* Commit: `4a356ff <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4a356ffae7a19de12b7986f7a98c63d34ea337cf>`_

[TASK] Warn the user about an expired / lost session
-----------------------------------------------------------------------------------------

When a session has expired or been lost, a popup appears
if a Ajax request throws a 401 status code. The blocked
request is then deferred until a successful login has
been made.

Resolves: NEOS-183

* Commit: `3a71b2a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3a71b2a809cc1d21f1fd3daf5de8e0a8e22c9516>`_

[BUGFIX] Default value not used in structure tree
-----------------------------------------------------------------------------------------

When you create a node from the content structure tree it loses the title.
The default title of the node should be always the title for the structure tree.
Before the node is rendered in the structure tree there should be shown "Loading".

Fixes: NEOS-82

* Commit: `6c9d5ff <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6c9d5ffd9404fb2a7b10cd5eb4c22d66264d3dc1>`_

[BUGFIX] Breadcrumb in Inspector has one element too much
-----------------------------------------------------------------------------------------

Fixes: NEOS-123

* Commit: `f993153 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f99315383a996afbe835b4d40541ccac20c5f675>`_

[!!!][TASK] Harmonize TypoScript paths
-----------------------------------------------------------------------------------------

All TypoScript is now in: ``Resources/Private/TypoScript/´´

The TypoScript ``autoInclude`` will now try to include a file
``Resources/Private/TypoScript/Root.ts2`` along with the old path which
is marked as deprecated and will not be supported startingwith 2.0.

In site packages the Root.ts2 file should be at the same path.

The included code migration will take care of moving files to
the right places, but you might still need to adjust include
statements in your ts2 files that point to older paths.

Resolves: NEOS-390

* Commit: `cc5d1d6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/cc5d1d6885ed77bc04c81cb7226936ce649558d2>`_

[TASK] Adjust unit test to changed CLI output handling
-----------------------------------------------------------------------------------------

Related to the changes in https://review.typo3.org/33112.

* Commit: `6645f0c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6645f0cfd206cbaff9ac6d42b15974f54f7d922f>`_

[TASK] Update exception message to mention the new node:repair command
-----------------------------------------------------------------------------------------

Related: NEOS-296

* Commit: `5b0eeb3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5b0eeb3d04b1beae9c7f54800726c6e666946a68>`_

[BUGFIX] FlowQuery find operation on multiple nodes
-----------------------------------------------------------------------------------------

Now the find operation finds descendants for all given nodes in the
context. This could lead to more results than before if the FlowQuery
context contains more than one node.

Fixes: NEOS-430

* Commit: `8dc3252 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8dc325293fcaa66f8068ba0fed3e3e5a62ace792>`_

[BUGFIX] NumberRangeValidator shows incorrect message
-----------------------------------------------------------------------------------------

Fixes the issue where the NumberRangeValidator evaluated every
number as invalid.
Fixes the issue where wrong feedback was given depending on the
input type.
Removes the check for the empty value as it wasn't working and
that is actually a different validation.

Resolves: NEOS-477

* Commit: `168d86f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/168d86f5ff31a1bc3ec777007c11c62a8c776996>`_

[BUGFIX] Publishing the page after moving a content element broken
-----------------------------------------------------------------------------------------

After moving a content element on a page and publishing using the
"Publish" button, a "Conflict" error is thrown. This is due to the
shadow node being rendered and being included as a unpublished node,
but when trying to publish it cannot find it since it's removed.

Related: NEOS-389

* Commit: `318e038 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/318e038d589f6433da79f79fe2369dacd891ee32>`_

[BUGFIX] Timezone for date properties overwritten in backend
-----------------------------------------------------------------------------------------

When logged in date properties for nodes get their timezone overwritten,
because it's set in the content element wrapping service directly instead
of on a clone.

Related: NEOS-203

* Commit: `0945258 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/094525858e5510d0ab931d8492be686a0f76353d>`_

[BUGFIX] Not inline editable overlay exclude padding
-----------------------------------------------------------------------------------------

The overlay added to content elements without inline
editable properties, doesn't fill out all the space
within the outline. This makes it possible to click it,
which shouldn't be possible.

Resolves: NEOS-436

* Commit: `a621459 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a6214598c307e874e6f67580d798071eb59934b2>`_

[TASK] Warn editors when navigating away during saving/publishing
-----------------------------------------------------------------------------------------

Adds listeners to the "beforeunload" event for showing an alert
in case content changes are still pending or an active AJAX request
is in progress.

A request manager is introduced to keep track of active AJAX requests.

Resolves: NEOS-347

* Commit: `f159f3f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f159f3f21a927a76ee112ed2c427535e085c0a36>`_

[TASK] Improve stability of content saving
-----------------------------------------------------------------------------------------

 - Improves the responseness of the saving indicator
 - Changes the behavior of saving changes, instead of
   checking and saving every 5 seconds, it now checks
   every 100 ms, debounce the save by 500 ms so changes
   made in a short timespan delays the save. Last the
   actual persist to the server is throttled to 2500 ms
   to prevent bottle necks on the server side.
 - Ensures pending changes are saved before loading a new page
 - Listens directly to create.js's changes, to change the state
   as soon as a save is pending and not just when saving to the server
 - Moves the saving indicator to the publishing button

Resolves: NEOS-179

* Commit: `5765a0d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5765a0da803dd9f4dfa04fe713dd34d85c27b9d2>`_

[TASK] Improve 404 handling in Neos backend
-----------------------------------------------------------------------------------------

Currently if the editor discards a page that doesn't exist in the live
workspace, Neos returns a server error.

This patch solves the problem by returning a proper 404 error and handle
this error in the HttpClient. Neos will try to go up in the tree until
it find a valid document to display.

This patch also introduces a new aspect to add the current node
identifier as a cache tag. This allows more flexible cache invalidation
in Neos.

Resolves: NEOS-138

* Commit: `9e51d11 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9e51d11f240f7c61d8b7f50aa7818d724021ed11>`_

[FEATURE] Expose public JavaScript API for reloading the page
-----------------------------------------------------------------------------------------

This change exports a function of the Neos backend to reload the current
page. It can be called using the global ``Typo3Neos`` namespace::

	Typo3Neos.Content.reloadPage();

This API can be extended in the future to expose more functions as
needed.

Resolves: NEOS-394

* Commit: `9122362 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/91223626684171087b59ceefa644f84aa302b6e9>`_

[!!!][FEATURE] Add ability to Shortcut to an external target
-----------------------------------------------------------------------------------------

In the previous commit the Shortcut document type gained the ability to
link to an external target.

To adjust your existing Shortcut nodes, run the following node migration::

  ./flow node:migrate 20140930125621

Related: NEOS-375

* Commit: `641ec49 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/641ec4946e4693886b3a2bacb5a59af793946358>`_

[BUGFIX] NodeViewHelper test using testing view helper
-----------------------------------------------------------------------------------------

Related: NEOS-302

* Commit: `41fc75f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/41fc75f7412d73fbd46f1c278a8a35000fef315b>`_

[FEATURE] Add ability to Shortcut to an external target
-----------------------------------------------------------------------------------------

The Shortcut document type gains the ability to link to an external
target with this change.

Resolves: NEOS-375

* Commit: `5dc4a77 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5dc4a77c7556c5749c373c7560782a49e24b6b0e>`_

[FEATURE] LinkHelper (Neos.Link) for dealing with link schemas
-----------------------------------------------------------------------------------------

* Commit: `5eb5d87 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5eb5d870174118944753d100a150cc4c55dd2931>`_

[BUGFIX] Fix wrong key in node migration for languages dimension
-----------------------------------------------------------------------------------------

The newDimensionName had a typo in the migration YAML file.

* Commit: `2973067 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/297306702e8f8d32eb110c4a9adb0b6bf16fed44>`_

[TASK] Move node:// and asset:// conversion code to LinkingService
-----------------------------------------------------------------------------------------

To be able to use code for conversion of asset:// and node:// links elsewhere
this change moves it from ConvertUrisImplementation to the LinkingService.

* Commit: `733b422 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/733b4220fe67ffbd1446a82dd8dda65d79acef00>`_

[TASK] Use correct icons for node results in Aloha link field
-----------------------------------------------------------------------------------------

Related: NEOS-230

* Commit: `74a7b1c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/74a7b1c63a8d7520ad6c0c9a46b9881b5bd2d33e>`_

[TASK] Improve usability of link inspector editor
-----------------------------------------------------------------------------------------

 - Improves various styling and additional information
 - Makes it possible to hit enter to complete links
 - Adds correct icons to node results
 - Makes it possible to tab to the remove button
 - Hide search if no results are found
 - Shows node results above asset results
 - Make it configurable to include nodeTypes/assets

Related: NEOS-231

* Commit: `0d3c572 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0d3c572a161484800f3577756d64d29ff862e1bf>`_

[FEATURE] add <code> tag to Aloha Editor (disabled by default)
-----------------------------------------------------------------------------------------

In order to enable the <code> tag, the following NodeTypes.yaml is needed:

'TYPO3.Neos.NodeTypes:Text':
  properties:
    text:
      ui:
        aloha:
          format:
            code: TRUE

For testing this, make sure to compile the SASS, else the button will
not be visible at all.

Resolves: NEOS-364

* Commit: `8f9ad88 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8f9ad88871d283d048a690dda2ee444a963792ba>`_

[BUGFIX] Adjust to new nodes & assets REST services
-----------------------------------------------------------------------------------------

This change adjusts the LinkEditor and the Aloha link plugin
to use the nodes & assets REST services.

Related: NEOS-199
Related: NEOS-231

* Commit: `f2a07c7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f2a07c7292323eba6071e8aa1137405d7c5d373c>`_

[FEATURE] Basic RESTful Assets service
-----------------------------------------------------------------------------------------

This change refactors and introduces more functionality for a RESTful
service providing access to assets in Neos. The preferred output format
is HTML, but JSON is also supported (triggered via Accept header).

The existing AssetController was renamed to AssetsController and
references to it were corrected accordingly.

The change also fixes the JSON output for the Nodes service.

Resolves: NEOS-200
Related: NEOS-199

* Commit: `8376006 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/83760069b8f18a27060428bd18d03fd24fa6cd66>`_

[BUGFIX] Fatal error when using content element view helper with root page
-----------------------------------------------------------------------------------------

Related: NEOS-34

* Commit: `f83a5ea <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f83a5ea42e8500a82fb6599ce9190b8b8a0100e3>`_

[TASK] Add option force conversion in ConvertUris processor
-----------------------------------------------------------------------------------------

In certain cases (e.g. links that are not inline editable) the link
conversion should happen in workspaces other than live. This can now
be enforced using the forceConversion flag on the processor.

Related: NEOS-375

* Commit: `33ff8c6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/33ff8c68a6a90441cc846fbba28d5d3dd227a0c9>`_

[TASK] Rename NodeLinkingService to LinkingService
-----------------------------------------------------------------------------------------

This is in preparation of moving some functionality to the service that
is not only related to nodes (assets to begin with).

Related: NEOS-375

* Commit: `b75cc72 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b75cc724f2c29342afdbf8661f6daad4e63b8841>`_

[TASK] Hover state for date time editor remove button
-----------------------------------------------------------------------------------------

Related: NEOS-14

* Commit: `4a5c8ab <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4a5c8ab2c672cdbd762f2ee70639b34d869f31ca>`_

[BUGFIX] Reference editor keeps searching if no results are found
-----------------------------------------------------------------------------------------

Fixes: NEOS-352

* Commit: `9f54870 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9f548706061669e00add3c8c860ffc45aa8b998e>`_

[TASK] Replaces the dummy image used in the image inspector editor
-----------------------------------------------------------------------------------------

This is just a small and quick change to make the image look nicer.
We now use an SVG instead of a PNG.

* Commit: `e791917 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e791917e9ca0345aa30ddf9b3609ce0c582649de>`_

[TASK] Adjust documentation to node type constraint inheritance
-----------------------------------------------------------------------------------------

Related: NEOS-239

* Commit: `4b3b402 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4b3b40257700a289a7cba671ed5fa8b66408abee>`_

[TASK] Code cleanup in NodeTypes.yaml
-----------------------------------------------------------------------------------------

* Commit: `08a00df <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/08a00dfd99cc06daea4d7b1c66274ff63fe652cc>`_

[TASK] Document TypoScript conditions
-----------------------------------------------------------------------------------------

Related: NEOS-109

* Commit: `d4e5f85 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d4e5f855e79510eba4e6d7dfbf2cef70e06feb2e>`_

[FEATURE] External event for node creation / removal
-----------------------------------------------------------------------------------------

This change adds two new events ``Neos.NodeCreated`` and ``Neos.NodeRemoved``
that will be triggered when a node was created/removed on the page.

Resolves: NEOS-393

* Commit: `5eaf35a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5eaf35ad3f0dd2b28d3c0ffda9263349a10c0293>`_

[BUGFIX] Incorrect documentation for external JavaScript events
-----------------------------------------------------------------------------------------

Fixes: NEOS-406

* Commit: `5b740c8 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5b740c87ec935ef998b458181c5e290ff87d4710>`_

[TASK] Adapt to new node label management
-----------------------------------------------------------------------------------------

Node labels can now be defined with EEL. This change sets an
expression to the TYPO3.Neos:Node that does the same as the
former ``DefaultNodeLabelGenerator`` for full backwards
compatibility. For information on how to change the expression
or use a ``NodeLabelGenerator`` see the related change in
TYPO3.TYPO3CR.

Related: I1d5e3c79f43fa658f4fc28999cc2bde729cf9781
Resolves: NEOS-257

* Commit: `f699224 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f699224ea9663d9e191f53b1aa409afff9fbbd92>`_

[BUGFIX] Inline editable properties outline doubled
-----------------------------------------------------------------------------------------

A regression was introduced in I455ad1b431882930e2f422095ccab73b807215b8,
causing a double outline for inline properties inside content elements
that weren't active.

* Commit: `aa55d19 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/aa55d196cd39fb123d9422bf3ce35b4b39588078>`_

[BUGFIX] NodeController deals with unneeded context information
-----------------------------------------------------------------------------------------

The NodeController set context properties depending on the backend
access of the current user. This is unnecessary as the
NodeConverter already takes care of that. Only thing the
NodeController needs to take care for is to redirect to login if the
requested Node is not in live workspace and the user has no access
to the backend.

Resolves: NEOS-246

* Commit: `9acc0de <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9acc0de24c85238f8aab8d3cffb515e8f42bc877>`_

[FEATURE] Allow asset import during site:import
-----------------------------------------------------------------------------------------

The site:export would export Assets just fine, but during site:import
an error would be thrown.

This changes adds AssetInterface import capability to the
SiteImportService so an exported site can be imported again.

* Commit: `ee26ed4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ee26ed4451e4a3aabec0d12af99a9eb103aee04d>`_

[TASK] Allow linking to site node in NodeLinkingService
-----------------------------------------------------------------------------------------

The TypoScript object and view helpers will now accept the string value
"~" for the node argument to resolve the current site node.

Resolves: NEOS-279

* Commit: `cb13dc1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/cb13dc19f96c64b99576c9f7c6f3f51e8e7decd5>`_

[BUGFIX] Menu item attributes should have access to item in context
-----------------------------------------------------------------------------------------

This change updates the Fluid templates for menu rendering to pass
the item variable to the attributes rendering.

Resolves: NEOS-276

* Commit: `7a748e7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7a748e77ad3f8e2492820d9f96c67133a462573a>`_

[TASK] Use more specific entry tag for cached ContentCollection
-----------------------------------------------------------------------------------------

Change Ida9227b1d0731ab48ad7dd6c446b6a771f76ff67 introduced a new cache
tag to publish new ContentCollection when creating new documents.
The additional tag can be restricted to just the ContentCollection node
for less flushing on changes to descendant nodes of the parent document.

Related: NEOS-339

* Commit: `c18c44a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c18c44abe988d5e01266ed9194615fe6ec78afff>`_

[BUGFIX] Exception for missing site package in sites module
-----------------------------------------------------------------------------------------

An exception is thrown if a site's package cannot be found when
displaying details of a site. Instead a flash message error is
shown.

Fixes: NEOS-380

* Commit: `afaa5e2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/afaa5e2f2d9c4e3827fcd113ebec792d487be3ca>`_

[FEATURE] NodeUri TypoScript object for linking to nodes
-----------------------------------------------------------------------------------------

Introduces a new TypoScript object for making linking to nodes
easier.

The commit also extracts the node linking view helper logic into
a new NodeLinkingService that the two node linking view helpers
can use as well as a new NodeUri TypoScript object.

Resolves: NEOS-302

* Commit: `db2f6c8 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/db2f6c85ba24bd469f76cd8ef2d7b85ba60cfab4>`_

[BUGFIX] Better error checking for missing content collection nodes
-----------------------------------------------------------------------------------------

This change introduces a backward compatible helper that will search
for a content collection node on the current or parent node. If none is
found a speaking error message is generated in an exception that should
help to solve the error.

Fixes: NEOS-150

* Commit: `023c1aa <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/023c1aa3f80cb7dd40d6f6c40199c140421d9e66>`_

[BUGFIX] Focus lost for inline editing after deletion on every save
-----------------------------------------------------------------------------------------

After a content element has been deleted the "contentChanged" event
is triggered for every "contentSaved" event afterwards. Instead it
should only happen once. Regression introduced in
I7104d0ceab260c8e679e67cdc716ca33e2880836.

The focus is only lost if the structure tree is open.

Fixes: NEOS-368

* Commit: `b7ebf31 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b7ebf31112735648a373b9e8b4042f4d76b4b208>`_

[BUGFIX] Backend not loaded on first request
-----------------------------------------------------------------------------------------

The backend breaks if the node type configuration isn't cached
in the session, due to a race conditiion. Problem introduced
with I1848117ba4440e6cefade219b5b1ed40d0ab0487.

* Commit: `28a88c4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/28a88c4425c4288771ec064b2a5eaf65cad23d12>`_

[BUGFIX] Context dependent exception handler causes fatal error
-----------------------------------------------------------------------------------------

The context dependent exception handler doesn't pass on the
TypoScript runtime to the new exception handlers, leading to
a fatal error when the exception handling checks if the
content cache should be disalbed.

* Commit: `2d3ad94 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2d3ad94f7d748214f08b6df88f7cf1cf812ff41f>`_

[TASK] Generate outdated reference documentation appendixes
-----------------------------------------------------------------------------------------

* Commit: `b30ad62 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b30ad62b0a731b100780b643ca291f7599908c32>`_

[TASK] Enhance documentation
-----------------------------------------------------------------------------------------

* Commit: `deff518 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/deff518e87bf72f16641cff53d419159787e6682>`_

[TASK] Use placeholder instead of default value in inline link editor
-----------------------------------------------------------------------------------------

When creating a new link the link field now holds a placeholder
instead of the default value "http://" explaining that the field
can be used for links and searching for nodes/assets. If a link is
inserted without http:// it is prefixed automatically if it matches
an external link pattern, to avoid broken links.

Resolves: NEOS-232

* Commit: `b143f3a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b143f3a34710db3883de2ce32970205e31bc8def>`_

[TASK] Improve usability of new/paste buttons in navigate component
-----------------------------------------------------------------------------------------

- Adds a hint to the title of the button
- Adds a trinagle in the lower left corner of the button indicating
  there's something more

Resolves: NEOS-215

* Commit: `49a8eaa <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/49a8eaa77ef61b71d3ec5336ba511dcaa8b75891>`_

[FEATURE] Commands to activate/deactivate domains
-----------------------------------------------------------------------------------------

 - Adds "domain:activate" and "domain:deactivate" commands
 - Adds active state to output of list command
 - Sorts domains in list command by site and then host pattern

Resolves: NEOS-98

* Commit: `7640a7e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7640a7ed885d6c82d91356551d394d18e2e0675c>`_

[TASK] Add documentation for updated Attributes behavior
-----------------------------------------------------------------------------------------

Related: NEOS-275

* Commit: `58a84ce <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/58a84cef1382f13f55ebce73a78cd9cca7136aea>`_

[FEATURE] Apply constraints to content element handles
-----------------------------------------------------------------------------------------

This change introduces checks for the insert / paste handles. They
now take the nodetype constraints into account.

Besides that the NodeActions and ContentCommands objects are refactored
to do all actions on the node object

Resolves: NEOS-160
Resolves: NEOS-175

* Commit: `2e3798a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2e3798a456d1d296c02aa82361a3b4831cdb1096>`_

[TASK] Move tests from Neos package to TYPO3CR
-----------------------------------------------------------------------------------------

The move of the ConfigurationContentDimensionsPresetSource from Neos
broke a unit test, this showed some of the tests should have been moved
as well (see If52b4b570d52c9f39c06ce192421d785e85f54bc).

* Commit: `29b0ac9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/29b0ac9bb9f728050b8210f4ee4e742b94989282>`_

[BUGFIX] Keep PHP version requirements on 5.3
-----------------------------------------------------------------------------------------

* Commit: `f664b2d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f664b2d6b01b7b5df1abae58b1c82cb3dab7c2ee>`_

[BUGFIX] Add missing compiled css
-----------------------------------------------------------------------------------------

* Commit: `7f1fd65 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7f1fd65b367d14e9c46bb748aa88b5f2bbe67dcf>`_

[TASK] Remove false comment in aloha.js
-----------------------------------------------------------------------------------------

* Commit: `d4ed232 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d4ed2325263b56b11b4fa579ed62dcb1abb75b06>`_

[BUGFIX] Inline editable properties for documents not visible
-----------------------------------------------------------------------------------------

When a property is inline editable directly on the document,
it's not visible in any way. Now a gray outline is displayed on
hover as well as a blue outline when focussed matching the behavior
of the content elements.

Fixes: NEOS-362

* Commit: `706b434 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/706b434c636b26867846c1a1022583d13aecc4ba>`_

[BUGFIX] Format bar hidden for inline editables
-----------------------------------------------------------------------------------------

The formatting bar is hidden for inline editable
properties for the document, meaning not inside
a content element. This happens because it's only
shown when the class "neos-contentelement-selected"
is set, but that only happens for content elements.

Fixes: NEOS-361

* Commit: `7163e03 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7163e0320b6358ea3c3af48367d62aade03a4464>`_

[!!!][TASK] Unify dimension settings into TYPO3CR
-----------------------------------------------------------------------------------------

This change adapts to the according change in TYPO3CR by moving
configuration of dimensions to the TYPO3CR and reducing the
ContentDimensionPresetSource to uri handling that is only
important for Neos.

Related: If52b4b570d52c9f39c06ce192421d785e85f54bc

* Commit: `1405fd5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1405fd5a6d34523c683e82d8fef0f18b34384a90>`_

[TASK] Prevent empty class attribute in wrapped elements
-----------------------------------------------------------------------------------------

* Commit: `f7c60c8 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f7c60c89813cef248800438ced841e85ecd8422d>`_

[FEATURE] Make Aloha formatless pasting configurable
-----------------------------------------------------------------------------------------

Allow the Aloha formatless pasting to be configurable.
It's possible to enalbe/disable the button, set the default
behavior as well as define which elements should be stripped.

Resolves: NEOS-260

* Commit: `d0febcd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d0febcd3cab304aa4c576aaf24cc261ed4c53fcf>`_

[TASK] Rename node:autocreatechildnodes command to node:repair
-----------------------------------------------------------------------------------------

This change renames the node:autocreatechildnodes to node:repair and
by that creates a command which can perform further "repair" tasks in
the future. From a user's perspective simply running "repair" will likely
solve all structural node problems.

Further more, the command controller is moved to the TYPO3CR package
and thus consists of two commits: this one which removes the controller
from TYPO3.Neos and a second one which adds it to TYPO3CR.

Related: NEOS-325

* Commit: `4b049c1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4b049c18f9e5a00185e3c4d4060df5c2a3db7db2>`_

[TASK] Adapt functional tests to changes in CR
-----------------------------------------------------------------------------------------

TYPO3CR test have been made independent from other packages by
putting all used node types in a testing namespace. This change
adapts Neos to those new node type names.

Related TYPO3.TYPO3CR change: I46e08720632aa70504a3ab98634816474b841619

Related: NEOS-34

* Commit: `3d85b7d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3d85b7de86e79368a3037ba72ae6496bd63a8c22>`_

[BUGFIX] Behat test "Toggle Preview Mode" is broken
-----------------------------------------------------------------------------------------

The "Toggle Preview Mode" test is broken as the "Full Screen" button
might not yet be rendered during the test. This change introduces
a new @When method to the Behat feature context to support waiting
for an element to be rendered.

Usage::

  When I wait for the "Open full screen" button to be visible

The element should be added to the switch statement in the
namedElementSelectorExists method of the FeatureContext.

Fixes: NEOS-173

* Commit: `518ff35 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/518ff3593100211c647af5bd9e795dbb2b54f043>`_

[TASK] Set default date editor format in Settings.yaml
-----------------------------------------------------------------------------------------

This serves as a reference making it unnecessary to read
the documentation for learning about it.

Related: NEOS-203

* Commit: `d0eb126 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d0eb126ddfef71b1ab3499fc1a9fbd024e70f0b8>`_

[TASK] Add time to date format for TYPO3.Neos:Timable
-----------------------------------------------------------------------------------------

Related: NEOS-203

* Commit: `5359282 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/535928265deb015ed88387942d8202436e0f3d0b>`_

[!!!][FEATURE] Switch to PHP date format for inspector date editor
-----------------------------------------------------------------------------------------

Switch from a custom date format used in the inspector date editor
to the standard PHP date format. This is a format that more people
are familiar with so it makes sense to use it instead. It also
makes the format indenpendent of the date edtior implementation.

Example configuration::

  editorOptions:
    format: 'd-m-Y H:i'

This is marked breaking due to the format change, meaning that if you
have changed the default date format you have to migrate to the new
one.

To adjust the code use the new format, it should be enough to run this
on your site package(s)::

      ./flow flow:core:migrate --package-key <sitepackagekey>

Resolves: NEOS-205

* Commit: `cf6dda3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/cf6dda34e63ee415aedbd938718fee35a6f5e50f>`_

[BUGFIX] a property "type" might not be set
-----------------------------------------------------------------------------------------

This checks if a property actually has a ``type`` defined
in NodeTypes configuration, because it will result in PHP
warnings if not.

Related: NEOS-297

* Commit: `bd17073 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/bd1707342c1c2ff938151504dc8816413accd348>`_

[BUGFIX] 404 Error on select2x2.png
-----------------------------------------------------------------------------------------

The select2 selectboxes use an incorrect path to a
sprite image that we don't even use. This change
suppresses the background image to be used.

* Commit: `a4aae23 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a4aae23cbef945ac0af5dd327934cd16fc81633b>`_

[TASK] Make pagination styles globally available
-----------------------------------------------------------------------------------------

Move styles for pagination widget to global place so that backend modules
can also make use of it.

* Commit: `c576d1d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c576d1d6c305e22418b74318b0aad014e189e265>`_

[FEATURE] Apply ConvertUris to inlineEditable properties
-----------------------------------------------------------------------------------------

With this change all string properties that are inline
editable have the TYPO3.Neos:ConvertUris process automatically
applied.

That means a property *title* configured with::

  type: string
  ui:
    inlineEditable: TRUE

Will have the additional TypoScript line::

  title.@process.convertUris = TYPO3.Neos:ConvertUris

automatically generated.

Resolves: NEOS-297

* Commit: `1614b25 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1614b25922beaadfce64f3094c9f53483417d2fe>`_

[!!!][TASK] Deprecate unused IncludeJavaScriptViewHelper
-----------------------------------------------------------------------------------------

This VH has been mostly untouched since it's inception and is no longer
used. The best practice for including JS is now a different one: either have
your scripts in a section of your template or add them to the TS Array in
page.head.javascripts in your TypoScript.

Thus this VH is deprecated and will be removed in three versions from now.

* Commit: `a4559a5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a4559a5689a31d3b4f04b6e2234fa2b88d53ac47>`_

[BUGFIX] Content collection falls back to first child if nodePath is empty
-----------------------------------------------------------------------------------------

When a content collection cannot find a node in the given path, it falls
back to the first found child node on the current page. This leads to very
unexpected and confusing results, e.g. rendering the main content collection
right before the content collection with the unfound node.

* Commit: `575a608 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/575a608722c6225bf944795be83a162fa4230ac2>`_

[BUGFIX] Site Export should be able to handle broken assets/images
-----------------------------------------------------------------------------------------

This is a workaround for NEOS-121 which fixes the site export e.g.
with the demo site.

In order to test this, the demo site should be exported directly
after it was imported. This broke without that change.

Related: NEOS-121

* Commit: `d772782 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d772782eee6e8935dbf315294d9de6b42e7279d6>`_

[BUGFIX] Importing of resources broken due to wrong argument order
-----------------------------------------------------------------------------------------

Creating resources during site import was broken for assets in arrays
that were not used elsewhere.

* Commit: `fb63ad5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fb63ad5dfdca4f2b489874d9835c6372950d15e8>`_

[FEATURE] Improved workspace:* commands
-----------------------------------------------------------------------------------------

This change renames and improves the workspace:publishall
and workspace:discardall commands. The new commands
workspace:publish and workspace:discard accept a new
argument "--dry-run" which allows for simulating publishing
and discarding of the given workspace.

The old commands are still available for backwards
compatibility. They are now marked as deprecated.

* Commit: `5446c38 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5446c38c123d973ffd0416559ab2b56c7d670b50>`_

[TASK] Configure behat to use saucelabs for behavior tests
-----------------------------------------------------------------------------------------

Adds example configuration and documentation on how to run
javascript behat tests  on saucelab’s virtual machines for
cross browser testing.

* Resolves: `#54171 <http://forge.typo3.org/issues/54171>`_
* Commit: `8355bc3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8355bc36fed15e57f0805638c7279285c71b90ab>`_

[BUGFIX] Wrapping pages results in PHP notice
-----------------------------------------------------------------------------------------

Using the ContentElementWrappingService on document nodes can
lead to PHP notices because the attribute ``class`` might not
have been defined prior to concatenating. This leads to Flow
exceptions and break the site.
This change fixes it by initializing the empty class array
entry at the beginning.
The problem was introduced with the related change below.

Related: Ia11ac5b6c7bef4c30e005b53f21215d0b17637c1

* Commit: `0ab4d7a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0ab4d7afebb0e709204184cbaab378a8bf6d6bdc>`_

[TASK] Code cleanup in node controller
-----------------------------------------------------------------------------------------

Related: NEOS-338

* Commit: `e0341f1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e0341f1bca495b5c5255a0cee2607956d42034aa>`_

[FEATURE] Sorting of node types in insert new panels
-----------------------------------------------------------------------------------------

This change enables the node types that appear in the insert new panels
to be sortable according to their position setting from the configuration.

* Commit: `e6caa64 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e6caa64762a3052723f97b40ffecef687ea8c78b>`_

[TASK] Change RUBY_VERSION check to match versions > 1.9
-----------------------------------------------------------------------------------------

The current check for the RUBY_VERSION only checked if a
1.9 version of Ruby is installed and as such does not work
on 2.0 or higher. This change updates the comparison so it
works for all versions higher than 1.9

* Commit: `cd72ea1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/cd72ea19e6e2b8ac43fd5bfb357c31abac426737>`_

[TASK] Add hint for fixing symlinks in Behat testing documentation
-----------------------------------------------------------------------------------------

This change adds a hint for the user how to fix a possibly
missing symlink in the bin folder as composer does not recreate
this symlink if it gets lost.

* Commit: `c821f9e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c821f9ef8583c4f11eb14f4d81f811a02eaa2116>`_

[FEATURE] Apply constraints to new/paste buttons in navigate component
-----------------------------------------------------------------------------------------

Applies constraints to the new/paste buttons in the navigate component
trees (node tree/context structure tree). This is done by checking if
the selected node allows children or siblings and if so allows the
matching position. In case of pasting the cut/copied node is checked
against the allowed children/siblings. If there's no available position
the buttons are disabled. If the chosen position is not available the last
available option is chosen by default (into/after). Takes the unmodifiable
levels configuration into account.

Resolves: NEOS-187
Resolves: NEOS-159
Related: NEOS-215

* Commit: `4af79b4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4af79b44008dee558b6eace1db778ca471589904>`_

[BUGFIX] UnpublishedNodes includes root node in PublishingService
-----------------------------------------------------------------------------------------

The getUnpublishedNodes method in the PublishingService shouldn't
include the root node, since it's not publishable.

Besides that the getUnpublishedNodes() method now returns 0
if it's called for the live workspace as this workspace will
never have unpublished nodes.

* Commit: `d8a94f7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d8a94f7313a757b7209c8af624d6e315bf0dddbd>`_

[BUGFIX] Content collections marked unpublished for new pages
-----------------------------------------------------------------------------------------

When creating a new page and publishing the changes, the content
collections remain shown as unpublished changes. This is due to
the cache for the content collections not being flushed when
publishing the first time. Afterwards the content collections
will remain in the live workspace, so clearing the content cache
solves the issue for existing pages.

It is solved by adding a entry tag for all content collections
directly in the document, making sure that content collections
are flushed when the document is.

Fixes: NEOS-339

* Commit: `83b4278 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/83b427866b2f9fde1bc3086d4dc138102976175c>`_

[BUGFIX] allow to set related content nodes
-----------------------------------------------------------------------------------------

The service nodes/show (which is used by the "related" editor)
should also work with non-document nodes.

Without this change, loading already-related nodes which are
no documents fails with a "404" error, because the routing
cannot generate URIs for them.

Fixes: NEOS-338
Related: NEOS-337

* Commit: `5b763df <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5b763df76189baaa25902427f26c402072d94ce7>`_

[TASK] Use primary button styling in Site management
-----------------------------------------------------------------------------------------

The button should be blue.

Resolves: NEOS-221

* Commit: `abccf99 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/abccf99fbdc6b4ec226a06a0059f7a8012092c40>`_

[FEATURE] "workspace:list" command
-----------------------------------------------------------------------------------------

Adds a new list command to the workspace commands to list
existing workspaces needed for the existing commands.

Resolves: NEOS-324

* Commit: `a5b6c6c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a5b6c6c2d412e1c532e647a3b847e5553527397c>`_

[BUGFIX] lastVisitedNode should be reset when changing sites
-----------------------------------------------------------------------------------------

The lastVisistedNode session variable is always pointing to the
node that was last open in frontend to redirect to that page.
If the node is removed this redirect will lead to a "page not
found" error. This can happen for example if something is
changed in sites management. Therefore changes in sites
management should clear this session variable.

Fixes: NEOS-127

* Commit: `aa05962 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/aa059625730c6330ee720fc379f462b1bf55535a>`_

[BUGFIX] Throw exception for missing node in editable view helper
-----------------------------------------------------------------------------------------

This happens when a node is could not be found, but the view helper is
still used. Now a catchable exception is thrown instead.

Fixes: NEOS-328

* Commit: `7ee3c5c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7ee3c5c017efcce6662b68ac9f90d19ac145f6a8>`_

[BUGFIX] Tests for Publishing Service fix
-----------------------------------------------------------------------------------------

These are updated tests for the previously merged fix for NEOS-308.

Related: NEOS-308

* Commit: `7387b12 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7387b1238159b9d33a5e3d18f43a01af323b1c70>`_

[BUGFIX] Publishable nodes in Neos UI uses wrong dimensions
-----------------------------------------------------------------------------------------

This fixes a bug in the Neos Publishing Service which did not consider
content dimensions when retrieving the currently unpublished nodes.

Requires a related change in TYPO3CR (see topic NEOS-308).

Resolves: NEOS-308

* Commit: `e1b3d55 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e1b3d554f3b8464d0bd608a9ae3ba43c2585925a>`_

[TASK] Remove link interception for Aloha floating menu
-----------------------------------------------------------------------------------------

The Aloha floating menu has been disabled, so there's
no need for intercepting links on that element.

* Commit: `408517b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/408517b89f5ca9eec4567cf753b45699542dca0f>`_

[TASK] Add missing title attribute for "Toggle context structure"
-----------------------------------------------------------------------------------------

* Commit: `330687d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/330687db17f974e6f31000fe18d8c3eb7dae2f1a>`_

[FEATURE] Time support for the inspector date editor
-----------------------------------------------------------------------------------------

Add support for date formats with time in the inspector
date editor. To support this the format is changed to include
time and timezone offset, to ensure consistency between
server and client.

Example configuration::

  editorOptions:
    format: 'dd-mm-yyyy hh:ii'

Additionally fixes a bug where the date isn't reset when
the inspector changes are discarded.

Resolves: NEOS-203

* Commit: `c721526 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c721526e840d8199e8f22a2428bba057edc46036>`_

[TASK] Change "TYPO3's" to "TYPO3 Neos" in RoutingLoggingAspect comment
-----------------------------------------------------------------------------------------

* Commit: `021fad2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/021fad29f90d9076f22960917217d093afc734de>`_

[TASK] Swap some access checks with workspace checks
-----------------------------------------------------------------------------------------

This change inverts a number of checks for the workspace being not the
live workspace and for access to the TYPO3_Neos_Backend_GeneralAccess
resource.

This makes it possible to render full Neos pages in a CLI context (where
the security framework cannot be initialized) and should speed up things
a tiny bit along the way (by avoiding security checks in case of live
being rendered).

* Commit: `b78d79b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b78d79b23f34ed7533edc7983702bbe07994ff34>`_

[BUGFIX] Fix failing unit test
-----------------------------------------------------------------------------------------

In  I54cc0776d56d58c77955225b7484b39dde465b64 some code was added that
broke a unit test. This change fixes that test.

* Commit: `ffabd16 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ffabd16f35a440335c63cdd53f7f3abff6a11bae>`_

[BUGFIX] respect "workspace" argument consistently when auto-creating child nodes
-----------------------------------------------------------------------------------------

How to reproduce
================

* Create a new page (which then only exists in your user workspace)
* Then, modify NodeTypes yaml to add a new (auto-created) child node
* Then, run ./flow node:autocreatechildnodes. We'd expect *no changes*
  on your newly created page, because it only exists in your user
  workspace, but not in live workspace (where auto-creation is applied).
* However, without this change, the node (with all childnodes) gets created
  in live workspace as well, leading to duplicated nodes in the node tree.

* Commit: `2748340 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2748340766273526765c069430445da0ec9fea79>`_

[BUGFIX] Robust initialization of ContentDimensionSelector
-----------------------------------------------------------------------------------------

The ContentDimensionSelector is sometimes not initialized.
This seems to happen because the observed properties on the
Controller are already set when the view is initialized thus
never triggering the ``_initialize`` method. Calling it in
the ``init`` method of the view seems to fix the problem.

Additionally Ember.run.next is used now.

Fixes: NEOS-288

* Commit: `042d0b1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/042d0b1e5ccca40bfe01190ddfbdea98bbe8dcba>`_

[FEATURE] Set current locale in Flow from language dimension
-----------------------------------------------------------------------------------------

This sets the current locale in Flow to the current language dimension
when rendering TypoScript. The fallback rule in Flow is set as well.

* Commit: `99520fa <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/99520fa889fc20a184507019cc414b36ed4cc823>`_

[TASK] Notify users of log out in final setup step
-----------------------------------------------------------------------------------------

* Commit: `c53b4f1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c53b4f1920281f7576b08d93e9e4b49358b047d6>`_

[TASK] Make site import setup step clearer
-----------------------------------------------------------------------------------------

* Commit: `e6a2908 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e6a2908bd3efa1e52e2a192f4cac39c6556d5cec>`_

[BUGFIX] Doctrine eventListener registered without key
-----------------------------------------------------------------------------------------

Because the Doctrine event listener for the account post
listener is registered without a key, registering another
event listener in another package will result in overwriting
the listener causing undesired side-effects.

* Commit: `a217bd2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a217bd2fc92760e8d422d4fd57e3d55053bcf1e8>`_

[BUGFIX] Class names missing for setup steps
-----------------------------------------------------------------------------------------

* Commit: `4e2bfc9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4e2bfc916fd1343d11052cc2a7321181305e652f>`_

[BUGFIX] Stylesheet out of sync with source
-----------------------------------------------------------------------------------------

* Commit: `e65c3a3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e65c3a36318365edea0d9ecd3c230131a5701466>`_

[BUGFIX] Root node points to wrong language after switching languages
-----------------------------------------------------------------------------------------

Fixes an issue with the node tree, whose root node link pointed to a
wrong content dimension after switching the dimension (for example the
language) in the content dimension selector.

Resolves: NEOS-289

* Commit: `3719f0a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3719f0ad6d61afd661cb4188e2aadc4a57dfdc4b>`_

[BUGFIX] Update select2 in jquery-with-dependencies.js
-----------------------------------------------------------------------------------------

This is a follow-up to I7f2bb6b19694d6f93e5b7c4930bbfe6cf64dba00 and 
includes an update to select2.js, fixing the unstyled dimension selector.

Related: NEOS-14

* Commit: `d87b1f8 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d87b1f859a79de0b96b99c714653ef849294f793>`_

[FEATURE] Hide content dimensions selector if there are not enough options
-----------------------------------------------------------------------------------------

This change introduces a check which hides the content dimensions
selector altogether if no dimensions or no dimensions with more than
one preset exists.

Resolves: NEOS-277

* Commit: `771b163 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/771b1638fc165a4d178d29160ed3a90c078b8795>`_

[BUGFIX] Selector forgets current dimension and has no multi-dimension support
-----------------------------------------------------------------------------------------

This change addresses an issue where the content dimension selector
looses the current selection after switching the dimension. It also
improves support for scenarios with multiple content dimensions.

The code design was also improved: the content dimension selector is
now less coupled to the content module (Application.js) and reloads
the node tree more reliably.

Resolves: NEOS-284

* Commit: `10fff4b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/10fff4bad8da2fc31d29c676fc75c8d92e7def77>`_

[TASK] Rename neos-page-metainformation to neos-document-metadata
-----------------------------------------------------------------------------------------

In order to become more consistent with the "document" paradigm we
follow in Neos, this change replaces all occurrences of the
"neos-page-metainformation" attribute used in the Neos UI with
"neos-document-metadata".

Resolves: NEOS-283

* Commit: `580a743 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/580a743e8d6de2c6b653a7bb4066590c7c00f12a>`_

[TASK] Rename "languages" content dimension to "language"
-----------------------------------------------------------------------------------------

This renames the content dimension "languages" to "language".

Note that if you already have content in your content repository which
has been using the "languages" dimension, you will need to run a node
migration::

  ./flow node:migrate 20140723115900

Resolves: NEOS-211

* Commit: `ae219d2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ae219d2a38e90e0260c399c7c157b16ca1bde5e0>`_

[BUGFIX] Fix JsonView configuration in NodesJsonView
-----------------------------------------------------------------------------------------

The configuration was configured based on outdated assumptions.

Related: NEOS-199

* Commit: `76a715a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/76a715a5cdc9651de114abfdae652442ecb4c5b3>`_

[TASK] Tweak select2 implementation
-----------------------------------------------------------------------------------------

We aim for rendering all DOM elements below #neos-application.
Select2 adds itself to the closes body element effectively rendering
outside the Neos DOM structure.

This change automatically builds a version of select2 that renders
the selectbox below #neos-application. Besides that it tweaks the
implementation removing unneeded jQuery wraps and tunes setting
the placeholder.

Related: NEOS-14

* Commit: `71e2e40 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/71e2e401628ac8be464957caadf989af5a683838>`_

[FEATURE] Neos UI: content dimensions selector
-----------------------------------------------------------------------------------------

This change provides a first implementation of a content dimensions
selector (which can be used, for example, as a language selector)
for the Neos user interface.

In order to translate website content with this rudimentary feature you
must make sure to have content dimension fallbacks defined for the
languages you want to translate, otherwise you'll end up with multiple
completely separate content trees.

This selector has mainly been tested with a single dimension (that is,
"languages"). It does support multiple content dimensions, but true
support for more than one dimensions requires additional features in
the routing system first (if dimensions should be triggered through
a frontend URL, see NEOS-176).

Please note that you still need to enable the
LocalizedFrontendNodeRoutePartHandler manually in order to test multi
language support.

Resolves: NEOS-17

* Commit: `4eb3043 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4eb304378bf315fc86fe6a151bf6b2c0e94a7c04>`_

[FEATURE] Rudimentary RESTful Nodes service
-----------------------------------------------------------------------------------------

This change refactors and introduces more functionality for a RESTful
service providing access to nodes in Neos. The preferred output format
is HTML, but JSON is also supported (triggered via Accept header).

The existing NodeController was renamed to NodesController and references
to it were corrected accordingly.

Related: NEOS-199

* Commit: `3bfdaa8 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3bfdaa8ab562b5090dde310e89c62fb607fe3505>`_

[TASK] Fix code in nodetype examples
-----------------------------------------------------------------------------------------

This fixes two typos in the node type examples in the Integrator's
Cookbook.

* Commit: `fdabd85 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fdabd851af9c29a5a45431d464d2c7c70fc5bff5>`_

[FEATURE] REST HTTP client implementation for the user interface
-----------------------------------------------------------------------------------------

This change introduces a simple HTTP client for accessing the Neos
REST services. As we start using this service, it will be improved
and enhanced. This version at least support simple operations like
GET http://foo.com/neos/service/nodes and
GET http://foo.com/neos/service/nodes/123467890abcdef

Resolves: NEOS-204

* Commit: `a6fad69 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a6fad6923346f49f1de5100c25cf8d66b464c9b2>`_

[FEATURE] Make site available in page body template
-----------------------------------------------------------------------------------------

Usually you will have a link to the homepage in your body template
therefor it makes sense to expose the site node in the template
by default.

* Commit: `1187696 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1187696c7a32f9d2d1229db9a661fe56f0f49d85>`_

[BUGFIX] NodeSearchService working as before
-----------------------------------------------------------------------------------------

Due to the fix of case sensitive like queries merged in Flow
(I53cd80e145eb49bcf8251f0045b9f3ec4fd61105) the NodeSearchService
currently returns wrong results as it cannot properly lowercase
the content of the properties blob field.

As we already discussed this cannot be fixed easily so for now
the NodeSearchService will not attempt to search case insensitive.

This also needs to be backported to all branches that will get the
Flow bugfix.

Fixes: NEOS-267

* Commit: `cceae28 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/cceae28af4d1a463bc7e81b81e8b4278cc5a3954>`_

[FEATURE] Link editor for nodes, assets and external links
-----------------------------------------------------------------------------------------

This adds an inspector editor than can be used to create links
to nodes, assets or external links.

It is to be applied to a 'string' type property like this::

  link:
    type: string
      ui:
        inspector:
          editor: 'TYPO3.Neos/Inspector/Editors/LinkEditor'

The searchbox will accept:

- node document titles
- asset titles and tags
- valid URLs
- valid email addresses

Resolves: NEOS-231
Resolves: NEOS-174

* Commit: `14449e5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/14449e5fdb8abc7fd46d7206367c875aca533eab>`_

[BUGFIX] Inline link editor shown when linking is disabled
-----------------------------------------------------------------------------------------

When linking is disabled for a inline editable property the
link field is always shown due to the plugin not being updated
when the selection changes.

Fixes: NEOS-261

* Commit: `fb746fe <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fb746fe48eb142aa57135ac05f48d011eef26a04>`_

[TASK] Document missing configuration options for aloha
-----------------------------------------------------------------------------------------

Resolves: NEOS-263

* Commit: `da60d66 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/da60d660ca584144e09a7e9922718c9af818a8c1>`_

[TASK] Improve ViewHelper documentation, add reference
-----------------------------------------------------------------------------------------

The documentation of the Neos ViewHelpers is amended and fixed with this
changes.

A Neos ViewHelper reference (in an appendix) is added to the
documentation with this change.

* Commit: `7009bd1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7009bd13ef1b325097dc0cc678d834c421fe0b77>`_

[TASK] Update processed create.js
-----------------------------------------------------------------------------------------

* Commit: `4b28b8b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4b28b8b6a7b406c82a531e0940ee8f301afeab2d>`_

[TASK] Improve asset search results for inline link field
-----------------------------------------------------------------------------------------

Adds thumbnails to the result, use identifier as secondary
information like with nodes and adjust styling.

Resolves: NEOS-233

* Commit: `614bdf3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/614bdf31252e3240f824c72b77d5fe835106b097>`_

[FEATURE] NodeType constraints
-----------------------------------------------------------------------------------------

This change adds support for NodeType constraints in the new
node wizard from the content element handles and in the new
node wizard for the navigate component.

Additionally, it also supports these restrictions while changing
node types and moving nodes in the Navigate component.

See the changelog and documentation (which is included in this change)
for a detailed description of the feature.

Resolves: NEOS-34

* Commit: `a11bae6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a11bae6e91545131863105d9ee1f47cd3dc022b4>`_

[BUGFIX] Clicking outside the body should deselect active element
-----------------------------------------------------------------------------------------

When a page is shorter than the height of the browser window
and a content element is selected, clicking outside the body
tag doesn't deselect the active content element like it normally
does when clicking outside any content elements.

Fixes: NEOS-207

* Commit: `64334cc <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/64334cced1b38445f82147110a0efe33075ee5cd>`_

[BUGFIX] Emptying a collection breaks create new
-----------------------------------------------------------------------------------------

When a element in a content collection is removed it's
not possible to create new elements without reloading the
page. This happens when there are removed elements in the
collection and it checks if it should insert before one
of them, which fails because they cannot be found.

Fixes: NEOS-182

* Commit: `f2386a7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f2386a7dc45980f6cee4dbe8116c72c8639fafeb>`_

[BUGFIX] Set correct cache mode for ContentCollection by default
-----------------------------------------------------------------------------------------

Change the default TypoScript for ContentCollection to make it
cached or embedded depending on the context.

With the power of prototype context dependent TypoScript declarations
we can mitigate the problems when updating to Neos 1.1 or when
new static ContentCollections are created.

The documentation and comments are updated to remove the need for user
action in these cases.

Resolves: NEOS-227

* Commit: `666e4b6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/666e4b6d031bb9f008b6ebe87688d66b321790ea>`_

[BUGFIX] Remove neos-contentelement class from page metainformation
-----------------------------------------------------------------------------------------

The page's metadata wrapper gets the class neos-contentelement set.

This change also makes sure the class attribute is trimmed, which can
be necessary for content collections.

* Commit: `21812d1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/21812d151cb00e9185cf42f275ed1227a7c33c11>`_

[BUGFIX] Enable/disable edit in create uses different selector
-----------------------------------------------------------------------------------------

The enable/disable edit methods in create uses a different selector,
meaning that it could happen that some entities are not disabled
correctly.

* Commit: `d52417e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d52417e7f26dbab56af953e889b3c4b61955e763>`_

[BUGFIX] Backend redirects breaks with invisible/inaccessible nodes
-----------------------------------------------------------------------------------------

If a node is inaccessible or invisible (hidden after/before) the backend
redirect service cannot find it thus leading to not being able to
redirect to the page.
In case the fallback redirect is used to the site's root node and the root
node is inaccessible/invisible the backend will throw a 404, even though
the page can be accessed just fine in the content module.

This is caused because the context created for finding the nodes in the
backend redirect service doesn't allow inaccessible/invisible nodes.

Fixes: NEOS-225

* Commit: `4f45c76 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4f45c7673444f514f86b3b7f031af64dad48692a>`_

[BUGFIX] Structure tree contains removed nodes after removal
-----------------------------------------------------------------------------------------

Removing content outside the structure tree does not remove node from
structure tree. This is due to the structure tree being reloaded before
the removal has been saved to the server. To resolve this issue a new
event 'contentSaved' has been introduced to storage.js.
The remove nodeAction listens to the first 'contentSaved' event and
triggers 'contentChanged' afterwards.

* Resolves: `#57839 <http://forge.typo3.org/issues/57839>`_
* Commit: `70dbb67 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/70dbb67288e77f52ac14379b55d12e0b6bb3670e>`_

[BUGFIX] Content element overlay not displayed
-----------------------------------------------------------------------------------------

This change fixes the content element overlay to display properly
over the actual content by getting the full width/height including
padding of content and apply to the overlay.

* Resolves: `#57290 <http://forge.typo3.org/issues/57290>`_
* Commit: `d13fff6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d13fff6ff3e07316a81080018b2a29e8098314dc>`_

[BUGFIX] `Find` FlowQuery operation breaks with empty context
-----------------------------------------------------------------------------------------

When the `find` operation is used on an empty context an exception
is thrown because the ``canEvaluate`` method will return FALSE.
This happens because there is no fallback operation for `find` and
it can only evaluate if the first context element is a NodeInterface.

Fixes: NEOS-208

* Commit: `4a6c7da <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4a6c7dad0c990db5cb79b83ccf5496bc25f5c923>`_

[BUGFIX] `Has` FlowQuery operation breaks with empty context
-----------------------------------------------------------------------------------------

When the `has` operation is used on an empty context an exception
is thrown because the ``canEvaluate`` method will return FALSE.
This happens because there is no fallback operation for `has` and
it can only evaluate if the first context element is a NodeInterface.

Fixes: NEOS-209

* Commit: `1e89274 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1e892744d4ac7701de197baf05c612f520133546>`_

[BUGFIX] Children operation should only work with nodes
-----------------------------------------------------------------------------------------

* Commit: `55c8c74 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/55c8c74ae90a31148e2f7c71923015de3fb2b2d2>`_

[TASK] Rename NodeTypeSchemaBuilder to VieSchemaBuilder
-----------------------------------------------------------------------------------------

* Commit: `de96836 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/de968366a7296aa50e9dff53ec51f5eac91cd528>`_

[TASK] Hide content handles for elements outside collections
-----------------------------------------------------------------------------------------

When a content element is rendered directly outside a
collection the handles should not be shown.

* Commit: `26040a1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/26040a1b4c6601c6086ebb4f9a4453418c238adf>`_

[BUGFIX] Inspector Image Cropper should not open if dummy-image is shown
-----------------------------------------------------------------------------------------

Else, this is very confusing for users which accidentally open the (empty)
image cropper by clicking on the Neos dummy image

Fixes: NEOS-130

* Commit: `1882989 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1882989129db869406be50802a184528e09b1421>`_

[BUGFIX] Pages created without entering a name should work
-----------------------------------------------------------------------------------------

Creating pages wihout entering a name for the new page ended
up in an exception and wrong "null" entry for the page that
was not created. With this change a new page that has got no
name will be "unnamed" automatically and prevent the exception.

Fixes: NEOS-86

* Commit: `43cf518 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/43cf518a72d5d3c37e4b50ea82069591c7b7841d>`_

[BUGFIX] Fix small typo in 1.1.0 change log introduction
-----------------------------------------------------------------------------------------

* Commit: `9584631 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/958463132f84e770f18c1d09ff2ac52ea5706460>`_

[BUGFIX] (Sites Management) Importing site fails if kickstarter is not installed
-----------------------------------------------------------------------------------------

When the site kickstarter is not installed, the "Package Key" and "Site Name" input
fields are not rendered in the "Create Site" dialog. Because they are marked as
required parameters, the following property mapping exception occurs on form submission::

	The bug is 'Required argument "packageKey" is not set.'

This is fixed with this change by marking the arguments as optional.

Fixes: NEOS-128

* Commit: `0c2f498 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0c2f4982821041757532eafba9394cdcf83a5330>`_

[TASK] Hide search field if a select box has less than five items
-----------------------------------------------------------------------------------------

A select box with less than 5 items does not need to be searchable. If a
select has only 2 items, the search box is even very confusing due to the
contrast.

Resolves: NEOS-133

* Commit: `c0c4ad1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c0c4ad120b5e2969440aa954988558d593107d00>`_

[BUGFIX] Secondary Inspector Panel should close on changed node
-----------------------------------------------------------------------------------------

Secondary inspector panels are used for additional editors that
do not fit the inspector like the HTML editor or the media
selector. The secondary panel should close when the selected
node changes (for example by changing the page).

* Fixes: `#59452 <http://forge.typo3.org/issues/59452>`_
Relates: NEOS-124

* Commit: `c30d2f0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c30d2f0d797e9639c22092963567274213dfcc81>`_

[TASK] Add cache configuration to documentation example for shared footer
-----------------------------------------------------------------------------------------

Updates the documentation example for the shared footer to add a missing
content cache configuration.

Resolves: NEOS-132

* Commit: `2f52832 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2f52832b938c367d779396e7f607887f04e28840>`_

[TASK] Add change log for 1.1.0
-----------------------------------------------------------------------------------------

* Commit: `2ab5d14 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2ab5d141d7f1980a5933353deabe65b50694b3fa>`_

[TASK] Add release notes and change log for 1.1.0
-----------------------------------------------------------------------------------------

* Commit: `1205d24 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1205d2481500561bc107418253dfb2189041b672>`_

[TASK] Add ContentCache documentation to the documentation index
-----------------------------------------------------------------------------------------

* Commit: `a545c62 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a545c623ef244d950cba4e0b5666de1c59f5e359>`_

[TASK] Add Content Cache documentation
-----------------------------------------------------------------------------------------

* Commit: `e43a7d6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e43a7d665f2dc7465cd32fe0b6304fc0ce871a7a>`_

[BUGFIX] Content element wrapping should fail gracefully
-----------------------------------------------------------------------------------------

If the content element wrapping can't find a node on the
node variable it should return the content instead of
throwing an exception.

This e.g. happens if a TypoScript object like "Text" is
rendered standalone without a Node.

* Commit: `c67faf5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c67faf59116c2c5af0f7e659bd244d9b577ecc7d>`_

[!!!][BUGFIX] Menu state should not be calculated based on a shortcut
-----------------------------------------------------------------------------------------

Fixes wrong behavior of menu states, introduced with the refactored
MenuImplementation. Especially behavior of shortcuts pointing to a
subpage of themself showed wrong current states.

This is only breaking compared to the 1.1 branch not to 1.0.
If you need a link to the site root page with correct active state
you shouldn't create a shortcut pointing to it but rather include
the real site root in the menu, by using the itemCollection
property of the Menu TypoScript object.

TypoScript example::

  itemCollection = ${q(site).add(q(site).children('[instanceof TYPO3.Neos:Document]')).get()}

* Commit: `7ab1f36 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7ab1f3682869f2725d46ae24564a252122f62f2f>`_

[BUGFIX] Exception on deleting used Assets
-----------------------------------------------------------------------------------------

Referenced Assets (like images) were not checked for usage in
nodes so on next rendering an exception would be thrown
effectively rendering the site unaccessible.
This change prevents deletion of Assets that are still referenced.

Needs: I56f8e922f84c00d9402837591d308583f7069b3f

* Commit: `2ac9987 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2ac99872332fc6a359bddb981574140d7f8e5a93>`_

[BUGFIX] UserPreferenceController indexAction missing template
-----------------------------------------------------------------------------------------

The index action in UserPreferenceController is lacking a fluid
template so any call will raise an exception. This was now
changed to return a json representation of the preferences.

Note: it seems at the moment this action is never called in the
Neos backend.

* Commit: `61108ee <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/61108eec1b44533078896a2ce34dc94dfe8fc0c0>`_

[BUGFIX] The site import / export does not handle properties of type array
-----------------------------------------------------------------------------------------

The AssetList stores an array of images / assets on a node which are not
exported or imported. This change adds support for importing and exporting
them.

There is still a bug wit serializing the Image objects on persist for which
NEOS-121 is created.

* Commit: `8b549ef <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8b549ef348ddb02083f05672b75cf2a05eb42b55>`_

[TASK] add alignment example for Aloha
-----------------------------------------------------------------------------------------

* Commit: `857965c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/857965c43534d3cea9a84af3618badabb0ae453e>`_

[BUGFIX] Alignment configuration for Aloha editor broken
-----------------------------------------------------------------------------------------

It's not possible to use the alignment configuration due to broken
logic in the plugin itself and wrong configuration of Aloha settings.

* Related: `#45020 <http://forge.typo3.org/issues/45020>`_
* Commit: `b2347c0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b2347c010205f7b07581e3f496a6eba372d2ae45>`_

[BUGFIX] Site import service duplicates image resources
-----------------------------------------------------------------------------------------

If a site is imported multiple time the images in the database
get duplicated.

* Commit: `d9eb89b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d9eb89b0c58e9d78ec07d6ca8fe0741fa23d14f3>`_

[BUGFIX] Content cache should be cleared when discarding changes
-----------------------------------------------------------------------------------------

The WorkspacesController discarded changes by direct calls to the
NodeDataRepository, which is highly discouraged as important signals
will not be emitted by that.

This change updates the controller to use the PublishingService that
will emit the correct signals and does not change behavior.

* Commit: `ea5c878 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ea5c878fedf59635763dc805ca4a730c8da06ae7>`_

[BUGFIX] Use NodeNameGenerator to ensure unique node names
-----------------------------------------------------------------------------------------

* Fixes: `#58428 <http://forge.typo3.org/issues/58428>`_
* Commit: `8fda18e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8fda18e3b9134d0994f7faeb9da44217b24576fe>`_

[BUGFIX] Hide formatting button when no options are available
-----------------------------------------------------------------------------------------

When configuring the aloha editor not to have any formatting
options, the selector is still shown although useless. This
makes sure it's hidden if no options are available.

* Related: `#45020 <http://forge.typo3.org/issues/45020>`_
* Commit: `615d1f2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/615d1f28f8214e6dcb455248e80931235def71c9>`_

[BUGFIX] Page tree reloads on every page change
-----------------------------------------------------------------------------------------

When not using content dimensions the page tree gets
reloaded on every page change due to a broken check if
there are no content dimensions in the node path.

Introduced in Ic06ff0c679d5a141959c031e3dc296523a8dd2e1

* Commit: `8ea57cf <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8ea57cf615ae8b5727ab795f1bb10000b9d5c58d>`_

[BUGFIX] Title used in publishing notice relies on page reload
-----------------------------------------------------------------------------------------

Currently the title used when publishing relies on the page being
reloaded since it gets the property from the DOM instead of the VIE
entity. This is needed when the title is inline editable.

* Related: `#45020 <http://forge.typo3.org/issues/45020>`_
* Commit: `7a06454 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7a064548cc78348d8c83ac479606384bf02e65c4>`_

[TASK] Move CreateJS to InlineEditing folder
-----------------------------------------------------------------------------------------

This change also removes typo3MidgardEditable, which was not used anymore.

* Commit: `5a46e0d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5a46e0d27c926589f8028423189c423ae54698ca>`_

[TASK] Add Unit Test for NodeTypeSchemaBuilder
-----------------------------------------------------------------------------------------

* Commit: `214dffe <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/214dffef691000341e8eff094fcec6802d1e15de>`_

[TASK] Update createjs
-----------------------------------------------------------------------------------------

Updates CreateJS to after alpha4 and including the
pull requests made by Christopher.

* Commit: `38be80a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/38be80ab572ad552f13cc037885f33a0c6732f69>`_

[TASK] Move vie/instance and vie/entity
-----------------------------------------------------------------------------------------

* Commit: `4327b44 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4327b44829710283685eeedb07a60972a94f0a6c>`_

[TASK] Update FlowQueryOperationReference
-----------------------------------------------------------------------------------------

* Commit: `5e5d60b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5e5d60bf942b0da2fba3ce21125b7831e8e5e2b2>`_

[FEATURE] Activate and deactive user commands
-----------------------------------------------------------------------------------------

* Commit: `3bde471 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3bde471c097bdafb3d71ba4bb483a427c2cb9a5e>`_

[FEATURE] List command for listing existing users
-----------------------------------------------------------------------------------------

* Commit: `0f5a88b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0f5a88bd1b97d8c37089413a2dad853d9a315ee2>`_

[BUGFIX] Publishing nodes gives a server error
-----------------------------------------------------------------------------------------

Publishing changed and removed nodes gives a internal
server error because of an incorrect property mapping
configuration. Besides that possible validation errors
resulted in a 403 access denied as the errorAction on the
AbstractServiceController was not added to the Policy.yaml

Since I304e0b76164f83a85c3ca3f4d0ed630b04319426 the
convertNodes method is also obsolete and removed in this
change.

* Commit: `08047e8 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/08047e80993ee2f075514b54763581073ae3e465>`_

[BUGFIX] Asset editor calls server without identifier
-----------------------------------------------------------------------------------------

When the list of assets allows multiple assets and has
no value set it will send a json encoded empty array
to the asset metadata endpoint. This results in an internal
server error that is thrown to the user without further
reason as we can just remove the loading state.

* Commit: `2a6f583 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2a6f5831198ac8f602bcfb875577f49fa21eacda>`_

[TASK] Add generated Eel helper documentation
-----------------------------------------------------------------------------------------

Add generated documentation for Eel helpers. The documentation can
be generated using the TYPO3.DocTools package with the following
command::

    ./flow reference:render --reference EelHelpers

* Commit: `8068cab <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8068cab4a59c4cf901a2a8637d4ee0292b96350e>`_

[FEATURE] Make NodeTree baseNodeType configurable
-----------------------------------------------------------------------------------------

Allows configuring the baseNodeType used in the node tree. The
naming of the configuration keeps into account that the node tree
should support multiple presets in the future.

Example configuration::

  TYPO3:
    Neos:
      userInterface:
        navigateComponent:
          nodeTree:
            presets:
              default:
                baseNodeType: 'TYPO3.Neos:Document,!My.NodeType:ToIgnore'

* Commit: `79165fa <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/79165fa5b5c538a400a30face673f0b1418616d7>`_

[TASK] Move Aloha to InlineEditing/Content/Editors/Aloha
-----------------------------------------------------------------------------------------

* Commit: `78fc98a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/78fc98af28c1f05c7a901a367001574876f42559>`_

[TASK] Remove unused testrunners
-----------------------------------------------------------------------------------------

* Commit: `1553159 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1553159584973183234ba4503349b7a93c9dad8b>`_

[FEATURE] Configuration module
-----------------------------------------------------------------------------------------

A configuration module to get an overview of merged
configuration. All types of configuration can be
viewed and are validated when viewing. The state
of the viewed configuration is stored and expanded
with every generation.

* Commit: `4dabbdd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4dabbdd58f65e87d42d9d78ac0b1fb886e5b7ac6>`_

[TASK] Include require as non-conflicting in modules
-----------------------------------------------------------------------------------------

To be able to use require for more than just bootstrapping
the backend inside modules, we need to not rely on the
data-main attribute and instead use it directly like it's
done in the content module for the same reason.

* Commit: `8ad35e9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8ad35e9e9beae2f93c02a6f6e29139dcb440b275>`_

[BUGFIX] ConvertUris throws exception with NULL values
-----------------------------------------------------------------------------------------

This happens if a node property doesn't have a default
value, but uses the processor on the value.

* Commit: `42e86f1 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/42e86f18af7cf5c649d99d82d97ed034cbd2101b>`_

[FEATURE] Placeholder support for inline editable properties
-----------------------------------------------------------------------------------------

Instead of using a default value to ensure that the editor can
edit the inline editable properties, it's now possible to define
a placeholder text that will be shown if the property is empty.

Example configuration::

  'TYPO3.Neos.NodeTypes:Text':
    properties:
      text:
        type: string
        ui:
          inlineEditable: TRUE
          aloha:
            placeholder: 'Enter text here'

* Resolves: `#40305 <http://forge.typo3.org/issues/40305>`_
* Commit: `9a18fa9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9a18fa95152bbfd3741414467df6f33caf9e9f30>`_

[FEATURE] Support message for inline notifications
-----------------------------------------------------------------------------------------

Also fixes an issue where html entities were escaped in titles.

* Commit: `e73d544 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e73d544d9c2d9d2334552716463bf7c2246e3b38>`_

[TASK] Include jquery.cookie plugin for tree states
-----------------------------------------------------------------------------------------

Also fixes an issue where the jQuery with dependencies
is generated before some of it's dependencies, resulting
in using a off by one version of the dependency.

* Commit: `3d047fb <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3d047fb36d5cf156c19f42eb05a77a6ef73c3e8d>`_

[FEATURE] Textarea inspector editor
-----------------------------------------------------------------------------------------

A textarea editor for the inspector that looks
like the normal input text, but expands when
focussed allowing for extended lengths of text.

Example usage::
  'TYPO3.Neos.NodeTypes:Page':
    properties:
      'description':
        type: 'string'
        ui:
          label: 'Description'
          inspector:
            group: 'document'
            editor: 'TYPO3.Neos/Inspector/Editors/TextAreaEditor'
            editorOptions:
              rows: 7

* Commit: `f049d19 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f049d191aae00b14eae7cad63591aa8722833ff0>`_

[TASK] Add class name for inspector editor container
-----------------------------------------------------------------------------------------

Introduce a generated class name for all inspector
editor to be able to style the editors container.

* Commit: `b5d4f32 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b5d4f328989341c7e450b9caa8938fa1395dd6af>`_

[FEATURE] Has FlowQuery operation
-----------------------------------------------------------------------------------------

A operation for reducing the set of matched element
to those that have a descendant that matches the
selector or given elements.

Example::
  closestParentWithImageChild = ${q(node).parents()
    .has('[instanceof TYPO3.Neos.NodeTypes:Image]').first()}

* Commit: `5f228e7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5f228e767885054fb52444d2a1fd4800948d3039>`_

[BUGFIX] Find FlowQuery operation returns array with NULL
-----------------------------------------------------------------------------------------

Instead of returning an empty array the find operation
returns an array with NULL when a child node cannot be found.

* Commit: `dd5af3c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/dd5af3cb665f2d95a98d1594784dcaa4c617166f>`_

[BUGFIX] Children operation optimization bypasses filters
-----------------------------------------------------------------------------------------

Additional attribute filters are bypassed when doing early
optimization of filters for the FlowQuery children operation,
limiting the possibilities of the children operation.

* Commit: `621b658 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/621b658289fb21708e3a394e855b48a89e26f7af>`_

[BUGFIX] Filter operation instanceof only works with node interface
-----------------------------------------------------------------------------------------

* Commit: `8365bac <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8365bac7f6b2f5c702a1434b915fe023cacdf741>`_

[BUGFIX] Adjust UnitTest to changed console implementation
-----------------------------------------------------------------------------------------

Adjusts the ``UserCommandControllerTest`` to the
CommandController that has been adjusted with
I063742aca1898695f2e40f36b3e207248ac6e55c

* Related: `#49016 <http://forge.typo3.org/issues/49016>`_
* Commit: `fe1bc6b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fe1bc6b34ad7a9f43e93d83121dfaa186bbd9854>`_

[BUGFIX] Instanceof Fizzle operator only works with nodes
-----------------------------------------------------------------------------------------

Neos overwrites the instanceof Fizzle operator behavior
breaking the normal behavior when not dealing with nodes.

Example::

  [image instanceof TYPO3\\Media\\Domain\\Model\\ImageVariant]

* Commit: `863b2cb <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/863b2cb20491fed905ab7fadbc1af636d0ac6a2a>`_

[TASK] Remove custom ArrayConverter
-----------------------------------------------------------------------------------------

With I304e0b76164f83a85c3ca3f4d0ed630b04319426 the custom
ArrayConverter that has been implemented in order to properly convert
arrays of entities is no longer required.

Depends: I304e0b76164f83a85c3ca3f4d0ed630b04319426
* Related: `#58696 <http://forge.typo3.org/issues/58696>`_
* Commit: `f1c9cbe <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f1c9cbe12af23d74de7622e73834ba6ab07eb499>`_

[BUGFIX] Inline editable properties re-initialized after publishing
-----------------------------------------------------------------------------------------

When publishing changes all inline editable properties are
re-initialized by Aloha in the callback due to the VIE entity
being updated. This causes the cursor to be moved among other
issues. To prevent this we update workspace for the entity silently.

* Related: `#45020 <http://forge.typo3.org/issues/45020>`_
* Commit: `edaca6b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/edaca6b54ac64025724857839d683655754fd4eb>`_

[TASK] Document != operator in Fizzle for FlowQuery
-----------------------------------------------------------------------------------------

* Commit: `f965aa6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f965aa67babd35464ed081ce09f6b3a35f1fd49d>`_

[TASK] Add typehints for NodeInterface to RoutePartHandlers
-----------------------------------------------------------------------------------------

* Commit: `0e59c02 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0e59c02d006d8bdaf032a97badf57d50a91e90fd>`_

[TASK] Replace a few remaining occurrences of "locales" dimension
-----------------------------------------------------------------------------------------

Replaces occurrences of "locales" with "languages" and changes the UI
label for the languages dimensions to "Language".

* Commit: `cce021e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/cce021ed33df124fff07996c53f226708182836e>`_

[BUGFIX] Commit correct changelog for 1.1.0-beta3
-----------------------------------------------------------------------------------------

* Commit: `f1a3f65 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f1a3f65ac8c89e5980c72a1cbb13382364b4b19a>`_

[TASK] Add 1.1.0-beta2 and 1.1.0-beta3 changelogs to master
-----------------------------------------------------------------------------------------

* Commit: `f7d4bb8 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f7d4bb816b9c6f705ed068978c2598834882b9a7>`_

[TASK] Add basic validation for content dimension preset configuration
-----------------------------------------------------------------------------------------

This adds some basic safe guard to the setConfiguration() method which
throws an exception if a non-existing content dimension preset has been
defined as the default preset.

* Commit: `7dcc31e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7dcc31e77b187a96e053005ffafc28c0621ccba6>`_

[TASK] Adjust NodeTypes.schema.yaml
-----------------------------------------------------------------------------------------

Adjusts the NodeTypes schema to allow all supported headlines in the
aloha format setting.

Besides this removes a left-over "nonEditableOverlay" from the
NodeTypes configuration.

* Commit: `82dc124 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/82dc12478011dd69a3a5ab8aa90ced673046c213>`_

[TASK] Remove request from context
-----------------------------------------------------------------------------------------

This removed the request from the TypoScript context as with
I9c95bccce0f34dc4d4c9faa85a16b8a36006cd96 the context is added in the
default context to always have the current request in the context.

Needs: I9c95bccce0f34dc4d4c9faa85a16b8a36006cd96

* Commit: `79682d2 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/79682d2982cb70de369e69f81786f3d89758f77e>`_

[TASK] Cosmetic changes and clean ups
-----------------------------------------------------------------------------------------

As a preparation for the further development of the content dimensions
support, this change contains a few cosmetic changes to existing code.

* Commit: `6c52dcc <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6c52dcc6d7d31bd504f8f95ebab474cd0a58297f>`_

[TASK] Rename content dimension "locales" to "languages"
-----------------------------------------------------------------------------------------

This change renames the previously introduced content dimension "locales"
to "languages" as "locales" was too unspecific.

If you relied on the name previously, you'll have to adapt your code
accordingly.

Resolves: NEOS-116

* Commit: `1d7c337 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/1d7c3378436ea491274a8cf8be67c6130a4c8400>`_

[TASK] Only show images in image media browser
-----------------------------------------------------------------------------------------

This change adds a second controller next to the MediaBrowserController
to browse only images. This controller is used for the media selection
in the ImageEditor.

* Commit: `6dd99c0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6dd99c0f24844e8073f83cdefef24273bb263b93>`_

[TASK] Amend documentation in EditableViewHelper
-----------------------------------------------------------------------------------------

This tries to explain the user the need for correct metadata wrapping
if the ViewHelper is used with a given node.

Also some unused import statements are removed.

* Commit: `f2d0b51 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f2d0b51630ebccb4fad2769958bf0cf586045a86>`_

[BUGFIX] Node tree search/filtering incompatible with PHP 5.3
-----------------------------------------------------------------------------------------

Due to the use of $this inside a Closure it throws an error on PHP 5.3.
To circumvent that problem the class instance is referenced instead.

* Commit: `d8e955c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d8e955c7cdabc9580c352564ab15be890325cd5f>`_

[TASK] Make items in Breadcrumb prototype an array, not FlowQuery
-----------------------------------------------------------------------------------------

The items in a Breadcrumb were a FlowQuery instance. This changes
unwraps the query and makes items a simple array.

That way it is consistent with the other menu types' behavior.

* Commit: `8c53781 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8c53781a73222b36ffe9ffb51af6457ce72bb944>`_

[BUGFIX] Resolve hardcoded URIs in Backend context
-----------------------------------------------------------------------------------------

This removes occurrences of hard coded URIs to
end points, modules etc. This finally enables
using Neos with custom routes or being installed
below a subdirectory.

* Fixes: `#58588 <http://forge.typo3.org/issues/58588>`_
* Commit: `ad3380e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ad3380e354fd58f2585fc1575a697f7c4e9039b2>`_

[FEATURE] uri.module view helper
-----------------------------------------------------------------------------------------

This introduces an uri.module view helper as counterpart
to the link.module view helper.

* Related: `#58588 <http://forge.typo3.org/issues/58588>`_
* Commit: `5d75e38 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5d75e38df1422aa74440d74706df10546f718f3b>`_

[TASK] Small addition to the Developer Guide's "Behat" chapter
-----------------------------------------------------------------------------------------

* Commit: `6eee818 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6eee818c6103e3cfdb1c51a0566c52fbb3b647af>`_

[BUGFIX] Padding for sub headers in create dialog
-----------------------------------------------------------------------------------------

Add more space around sub-headers in the create new dialog.

* Commit: `4cb2a9c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4cb2a9c33b52f2e563812ee69e0e77eb2eb56958>`_

[FEATURE] Cancel button after selecting image for upload
-----------------------------------------------------------------------------------------

Makes it possible to go back after having selected an image
for upload in the image editor without having to unselect and
reselect the element.

* Commit: `c2e36b0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/c2e36b0367a4ae8338a97f78180747da0bb26386>`_

[BUGFIX] Show correct TypoScript path in exception handler messages
-----------------------------------------------------------------------------------------

This change sets the default TypoScript exception handler to
"ThrowingHandler". This way an exception will be re-thrown until it is
handled by a path that has another exception handler configured (e.g.
the NodeWrappingHandler). A new "ContextDependentHandler" is introduced
to switch between HtmlMessageHandler in Development or XmlCommentHandler
in Production. It's configured at the TypoScript root-level to catch
unhandled exceptions.

This way we can show the correct TypoScript path in messages and not
stop at all calls to tsRuntime->render(...) that was handled with
an "HtmlMessageHandler" by default.

* Commit: `fd42bec <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fd42bec8edbc641786316ea226a64ab29039a6ed>`_

[TASK] Remove duplicate method in reference editor
-----------------------------------------------------------------------------------------

* Commit: `6034ff7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6034ff7fce7ff07e17806ce8e95cdc74ea0b8af6>`_

[BUGFIX] Preview of image not matching uploaded image
-----------------------------------------------------------------------------------------

When selecting an image for upload a preview is shown,
this upload preview didn't match the selected image
preview shown after upload.

Additionally the solution is made more simple and
removes unnecessary code from the asset editor.

* Commit: `796d34c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/796d34c5cabbcd1241fd68d9e215f11c9e171cc4>`_

[TASK] Implement "cacheLifetime" and "context" FlowQuery operations
-----------------------------------------------------------------------------------------

Implement FlowQuery operations to get the cache lifetime of nodes in a
content collection. This is done with modular operations that can also
be used when rendering nodes outside of a content collection (e.g.
rendering a list of document nodes with a filter).

Additionally fix a functional test that broke through a Runtime
refactoring.

Resolves: NEOS-69

* Commit: `87b7739 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/87b7739da2969ec64284837beac22f80175a39e7>`_

[TASK] Hide empty inspector groups
-----------------------------------------------------------------------------------------

An inspector group with no properties should not be shown.

* Resolves: `#58502 <http://forge.typo3.org/issues/58502>`_
* Commit: `79bdf24 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/79bdf24aa07a001e0fc05ce5cf76374f0ba400e1>`_

[BUGFIX] Wrong arguments for pasteBefore in node actions
-----------------------------------------------------------------------------------------

* Commit: `f904199 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f90419939015e4ab02679cf52eda40ab22dfeccf>`_

[BUGFIX] Position of icons incl. loader in content handles
-----------------------------------------------------------------------------------------

* Commit: `930092b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/930092be797e698246424a136b98858bd1c89bea>`_

[BUGFIX] Auto-publish causes connection error loop
-----------------------------------------------------------------------------------------

When auto-publishing is enabled a loop of connection
errors occurs due to the controller not allowing an
empty array of nodes.

Fixes: NEOS-113

* Commit: `6680938 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6680938cf2af67d86df5ce0ee2cc0cfb84f0495a>`_

[BUGFIX] Discard all workspace command broken
-----------------------------------------------------------------------------------------

* Commit: `578d72d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/578d72dd56e10a18564a9d58ae01e74a22d4285a>`_

[TASK] Replace old syntax Fluid if conditions
-----------------------------------------------------------------------------------------

* Commit: `3fffc9b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3fffc9b48d6f39c6225cf5988b6c694fdd74fcc8>`_

[TASK] Code cleanup and CGL violation fixes
-----------------------------------------------------------------------------------------

* Import of FQL namespaces
* Inline type hinting
* CGL violations
* Missing class references
* Minor tweaks
* Commit: `871166b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/871166b7cec4bba3772d54ae4695a4772180174c>`_

[BUGFIX] Loading indicator when pasting never stops
-----------------------------------------------------------------------------------------

When pasting content using the content element handles
the loader never stops and also it's not tied to the
specific element that the paste button was clicked on.

Fixes: NEOS-41

* Commit: `74c7967 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/74c7967c2356187bda7bf9b91ca5167953ce74e4>`_

[BUGFIX] Context structure tree not updated when pasting
-----------------------------------------------------------------------------------------

Fixes: NEOS-84

* Commit: `b02367c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b02367c6d5e35c1e24f9dd0e8ca151950feed4e3>`_

[FEATURE] Introduce "user:show" command for showing user details
-----------------------------------------------------------------------------------------

This commit adds a new command "user:show" which mainly allows for
checking if a given user exists. If it does, a few user details are
shown, such as username, person name and email address.

* Commit: `bc2a4e0 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/bc2a4e0b962c994c3f1289283bf7ede84e68052e>`_

[BUGFIX] FrontendNodeRoutePartHandler should resolve node by context path
-----------------------------------------------------------------------------------------

Currently the FrontendNodeRoutePartHandler ignores node dimensions for
the live workspace, which causes the frontend to fail to render
localized plugins in the frontend that try to render URIs.

* Commit: `26dde71 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/26dde71461cf5ee6b5c9b5a97b845a2536b94447>`_

[BUGFIX] Behat Tests are green again
-----------------------------------------------------------------------------------------

Adapts the behavior tests to the changes in the UI.

Note: The scenario Features/Content/InlineEditing.feature:7 is unstable
because of server communication errors showing up sometimes.

Resolves: NEOS-74

* Commit: `4b8af89 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4b8af89a977b097dd565ad751e9b766d9e675c2e>`_

[BUGFIX] Use node full label in Menu and Breadcrumb
-----------------------------------------------------------------------------------------

Currently the Menu and Breadcrumb use the NodeInterface::getLabel(). The
label is created by the NodeLabelGeneratorInterface and cropped if
longer than 30 characters. This change use the
NodeInterface:getFullLabel() to display the full label in the menu.

* Commit: `eee825f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/eee825f1347993384abfb42261e1a4d4e33eb0ea>`_

[TASK] Disable notifications for aborted HttpClient requests
-----------------------------------------------------------------------------------------

When HttpClient requests are aborted it's application logic and
not something we want to display as an error. E.g. when clicking
between image elements before the request finished.

* Commit: `7748525 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7748525f3905faa6b20554c65f32801dc16cd0ce>`_

[BUGFIX] Backend endpoints with CSRF must not be cached
-----------------------------------------------------------------------------------------

The "neosBackendEndpoints" header part must not be cached because it
contains the CSRF token that depends on the user session.

* Commit: `6e89a55 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6e89a55f99d6e7acb907d910e62c77b42a191de6>`_

[TASK] Fix documentation version
-----------------------------------------------------------------------------------------

Sets the version of this documentation to "master" to match the released
version.

Also enable PDF rendering of the documentation.

* Commit: `df59e90 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/df59e90d1dd3ab5925c77178ffbbc26dcc11373d>`_

[TASK] Push changelog for 1.1.0-beta1 to master
-----------------------------------------------------------------------------------------

* Commit: `5954d69 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5954d699a32503f7ccbe9fd4c0586b52042836f7>`_

[FEATURE] Implement BreadcrumbMenu to replace Breadcrumb
-----------------------------------------------------------------------------------------

This streamlines the "items" property provided by the Breadcrumb
TypoScript prototype to match the "items" array provided by the Menu
prototype.

This change is not breaking, but deprecates the
TYPO3.Neos:Breadcrumb TypoScript object. Switch to
TYPO3.Neos:BreadcrumbMenu for additional features and future
compatibility.

Resolves: NEOS-107

* Commit: `444d7b5 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/444d7b5c419710faad426b9ae5a34459743f629f>`_

[BUGFIX] Workspace wide publishable entities not cleared immediately
-----------------------------------------------------------------------------------------

Related: #NEOS-105

* Commit: `5584cfe <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5584cfe2ddc26259707079926b952758d1eda215>`_

[TASK] Reload the nodeTree if the content dimensions change
-----------------------------------------------------------------------------------------

If a link is clicked in Neos that results in a change of the content
dimensions (like a link to a different language) the NodeTree now
refreshes.

* Commit: `22eacd3 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/22eacd33960e858bdd33b3dcdcf2e18375d59451>`_

[TASK] Navigate to newly created pages automatically
-----------------------------------------------------------------------------------------

When creating a new page the normal use case is to add content
to that page so it should be navigated to automatically.

That also solves the issue with having to reload the page to
update the menus in case the new page should be displayed.

Resolves: #NEOS-102

* Commit: `825a772 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/825a772fde02c551bf8c0684e54ba1a1f2645d96>`_

[FEATURE] Mark unpublished nodes in context structure tree
-----------------------------------------------------------------------------------------

Show a unpublished indicator for each content element that
is unpublished in the context structure tree. This gives an
overview over unpublished changes on the current page.

Resolves: #NEOS-104

* Commit: `94c302b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/94c302b2c7c72f4841efb839dcc7b39f0a211929>`_

[BUGFIX] Edit/preview mode slider breaks without modes
-----------------------------------------------------------------------------------------

* Related: `#48240 <http://forge.typo3.org/issues/48240>`_
* Commit: `f67324d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f67324dc7b1b7c52d9ddf4e5b5751bf01d60c5f2>`_

[FEATURE] Scrolling for multiple edit/preview modes
-----------------------------------------------------------------------------------------

Integrate the "Sly" plugin to add smooth scrolling
behaviour inside the edit/preview panel.

The scrolling function is enabled as soon as the
width of all buttons exceeds the width of the edit or
preview panel.

* Related: `#48240 <http://forge.typo3.org/issues/48240>`_
* Commit: `42a1c7d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/42a1c7d46ae4fd87285968c5103bbcc4631fd9c0>`_

[FEATURE] Linking to assets in Aloha editor
-----------------------------------------------------------------------------------------

This change introduces the possibility to link to files within
text elements. The autocomplete wizard of the link wizard now
displays pages and assets in the result list.

The ConvertNodeUrisImplementation is also renamed to
ConvertUrisImplementation to reflect that it does convert uris
and not only node uris.

Aloha's table wizard and link wizard are also moved below
the #neos-application element for better separation of styling.

Resolves: NEOS-20

* Commit: `f8b7c11 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f8b7c11f429b330cef6b9d168cb0ae82f2b6fc0a>`_

[BUGFIX] Publish/discard all count not updated
-----------------------------------------------------------------------------------------

When a page or all changes are published or discarded
the publish/discard all count isn't updated accordingly.

Fixes: #NEOS-105

* Commit: `2636627 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2636627ab57a668247134a62913350147ce710b5>`_

[TASK] Use HttpClient instead of $.get in references editor
-----------------------------------------------------------------------------------------

* Commit: `4e76e46 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/4e76e46f0c1b2b200bc23662db1ca1f8ed47875c>`_

[TASK] Mark newly created pages unpublished instantly
-----------------------------------------------------------------------------------------

* Commit: `d6ade90 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d6ade90211dc471bff392d6d65a0364e81c02857>`_

[BUGFIX] Notifications not shown after publishing/discarding
-----------------------------------------------------------------------------------------

Fixes: #NEOS-106

* Commit: `9479834 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9479834ca468dfc6a027d5c1b527556c0b34b18c>`_

[BUGFIX] Publishable nodes count not context aware
-----------------------------------------------------------------------------------------

The total count of unpublished changes does not take
context in account leading to several problems, e.g.
not being able to mark dirty pages when using content dimensions.

Fixes: #NEOS-103

* Commit: `622dbfd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/622dbfdde23c2ed72ac3961f83a92233146e2a18>`_

[BUGFIX] Creating or moving a page does not update publishing state
-----------------------------------------------------------------------------------------

Fixes: #NEOS-85

* Commit: `57012fd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/57012fd0ed4b448a2b472222f97936acea114aaf>`_

[TASK] Improve notification for failed AJAX requests
-----------------------------------------------------------------------------------------

* Commit: `407ed49 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/407ed49d240323b44faa75ffc7ba00ffe2be485f>`_

[BUGFIX] AJAX error handlers using undefined variable
-----------------------------------------------------------------------------------------

I5e964543e9b67209859dccbb0b84e9fcf2980beb introduced a
regression regarding handling of the error responses.

* Commit: `56f8f12 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/56f8f1283ed9a2badd99f6b5766d537032029f79>`_

[BUGFIX] Unpublished indicator in node tree pushes title
-----------------------------------------------------------------------------------------

Nodes marked dirty in the node tree are indented more
than their siblings due to an extra left border.

* Commit: `0036c29 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/0036c293fb1f58536184bf25e4ba86e2b1151e8d>`_

[TASK] Code cleanup in Aloha link plugin
-----------------------------------------------------------------------------------------

* Commit: `23fc562 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/23fc5627219f6d0439d67a07c96b0b3bd38c0881>`_

[TASK] Pasting in node trees should paste after by default
-----------------------------------------------------------------------------------------

The most common usage case for pasting nodes is wanting to
paste after a specific node, this also keeps the default
consistent with the create new position.

Resolves: #NEOS-80

* Commit: `f8e876c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f8e876c8bcda6e65538df0a128c03dc2af0a4634>`_

[BUGFIX] Loading 404 pages breaks backend by reloaded the page
-----------------------------------------------------------------------------------------

Fixes: NEOS-77

* Commit: `ceb774f <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ceb774ff8a618657f52bd7474ffed0e0daaef366>`_

[TASK] Remove unnecessary duplicate of internal node type
-----------------------------------------------------------------------------------------

Instead of adding an additional node type property for internal
use, we use the typeof that already contains the node type.

The node type switching also introduced the node type as a property,
but that can't be relied on since it depends on the node type
configuration.

* Commit: `141b120 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/141b120cde482e59ae48e26d9e5cec72263b34b3>`_

[TASK] Prevent multiple initializations of publishable nodes
-----------------------------------------------------------------------------------------

* Commit: `8c4af9e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8c4af9e245b11eb751ec752c036a30a3d747c5a7>`_

[BUGFIX] Creating a new page won't activate the publish button
-----------------------------------------------------------------------------------------

When a new page is created in the node tree that page should
be navigated to. When navigating to a new page the publishable
nodes is re-initialized ensuring the publish button is activated
and the publish count updated.

Fixes: #NEOS-96

* Commit: `a8c20bf <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/a8c20bfaede4dd862d45a741d59fba4ee5f7a1b6>`_

[TASK] Publish/discard all changes in one request
-----------------------------------------------------------------------------------------

Instead of sending one request for each change when
publishing/discarding changes, they're all send in
one request to prevent race conditions and unnecessary
requests.

Fixes: #NEOS-95

* Commit: `9cbde03 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9cbde03e95007ad2e134b20d92f89d8ca142d345>`_

[BUGFIX] Fix adding nodes with a cached version of a collection
-----------------------------------------------------------------------------------------

The content cache will be flushed when a Node is created. But the
flushing was moved to a shutdown method, so it's done after the content
for the collection containing the new node was rendered. This causes
problems if a cached version of that collection already existed.

The change introduces a flag for the Neos version of the TypoScript view
that allows to disable the content cache for this case.

Fixes: #NEOS-78

* Commit: `fb0b38a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/fb0b38aeadafd80be9a4a6ff63cb698fed13e9fb>`_

[FEATURE] AssetEditor for inspector
-----------------------------------------------------------------------------------------

This change adds an editor and updates Neos to support two new property
types: TYPO3\\Media\\Domain\\Model\\Asset for a single reference to an Asset
entity and array<TYPO3\\Media\\Domain\\Model\\Asset> to select or upload
multiple assets.

The ContentElementWrappingService was changed to export all public
properties only for the ImageVariant type and support for the Asset
types was added. This part of Neos needs more refactoring in the future.

* Commit: `8cde996 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8cde9966affd0e5df661017880003c94dfb409fd>`_

Revert "[BUGFIX] Publishable nodes count not context aware"
-----------------------------------------------------------------------------------------

This reverts commit 18412635ba056b97a11f91d14277c0db8f598fef

* Commit: `adbac71 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/adbac7108dca246b6e1892618ba2fe647bc347cd>`_

[BUGFIX] Publishable nodes count not context aware
-----------------------------------------------------------------------------------------

The total count of unpublished changes does not take
context in account leading to several problems, e.g.
not being able to mark dirty pages when using content dimensions.

Fixes: #NEOS-103

* Commit: `1841263 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/18412635ba056b97a11f91d14277c0db8f598fef>`_

[BUGFIX] Content cache is not domain specific
-----------------------------------------------------------------------------------------

The content cache does not take the visited domain into account. This
leads to problems when multiple domains point to the same site node.
The first domain used while accessing a node will be used for generating
the cache entries, and will be served for subsequent requests even if
those originates from a different domain. This is a problem as it would
redirect the user to a different domain, and can even break AJAX
requests in the Neos backend as they will be blocked by browser policies
as being cross-domain requests.

* Fixes: `#56902 <http://forge.typo3.org/issues/56902>`_
* Commit: `77857a6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/77857a6ddbfc34721a176d852068fb141e15f0a6>`_

[BUGFIX] Discard all operation must reload the page tree
-----------------------------------------------------------------------------------------

Fixes: #NEOS-55

* Commit: `9702b5b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/9702b5ba36f6d47d74f02006f13c82f4770fcd62>`_

[TASK] Fix typo in comment for method generateUriForNode
-----------------------------------------------------------------------------------------

* Commit: `b2c5483 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/b2c5483f04b99faa9dde689b2bffab565d08515f>`_

[BUGFIX] New nodes not included in publishable node count
-----------------------------------------------------------------------------------------

After creating new content elements rendered through AJAX
the publishable node count doesn't regard the new nodes as
publishable because the attributes doesn't contain the
workspace due to the VIE entity not having it's template
for getting the custom attributes when needed

Fixes: #NEOS-44

* Commit: `49e291c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/49e291c5f6c4197d86480c873c6783c5836f4eff>`_

[BUGFIX] File upload doesn't work without global jQuery
-----------------------------------------------------------------------------------------

There was a missing RequireJS dependency to jQuery that causes the
global jQuery instance to be used (if available).

* Commit: `5daf100 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5daf10008d634784da193795807c9abaa1f588e8>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `2a79a33 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2a79a33ae9629ae31dacfe8ead59bd68af69b9a7>`_

[TASK] Clean up docblock in NodeWrapping exception handler
-----------------------------------------------------------------------------------------

* Commit: `262d1f9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/262d1f9132e1190219ad7af0b3c1b0022e8687e9>`_

[BUGFIX] Negative entryLevel renders wrong menu
-----------------------------------------------------------------------------------------

When using a negative entryLevel on a Menu, the rendered menu renders
"one level above" the expected.

This is caused by calculateNodeDepthFromRelativeLevel() returning a 0
based result in certain cases.

* Commit: `72873fd <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/72873fd40c52ba60a3b0533361c4f72b31bec438>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `506d6d4 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/506d6d4e99971443af80a112e0e2c88827780569>`_

[TASK] Rework the NodeTypeService to cache the NodeTypeSchema
-----------------------------------------------------------------------------------------

This change makes sure the NodeTypeService will always directly
returning the schema without doing a separate ajax request to
the server with a superType filter on the NodeTypeSchema.

* Commit: `dd0b801 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/dd0b8011df5fdd5489cabac00e8b7c448a6d65c6>`_

[TASK] Ext.Direct replacement
-----------------------------------------------------------------------------------------

This change removes the dependency to the TYPO3.ExtJS package. It replaces
the usage of the global ExtDirect controllers and uses instances of
the HttpClient which should from now on be used for server communication.

The HttpClient handling uses Ember.Deferred. Also the usages of
$.Deferred are replaced by Ember.Deferred.

This change will be the basis for more refactoring in the server side
services and JavaScript code, but is already a good improvement.

* Commit: `3be4148 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/3be41482bca473316a4aef4b4c54a4c63ba0c9bf>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `2d9971e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2d9971eb80c6061e653b882049e293ddffa26079>`_

[FEATURE] Node type switching support
-----------------------------------------------------------------------------------------

This patch adds a new select box in the Inspector for node types
based on TYPO3.Neos:Content and TYPO3.Neos:Document to allow
changing the current node type.

* Related: `#48307 <http://forge.typo3.org/issues/48307>`_
* Commit: `680d87a <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/680d87a42342eb86a51209b88faa5a5212535f67>`_

[BUGFIX] Discarding changes does not flush TS content cache
-----------------------------------------------------------------------------------------

When changes in a workspace are discarded the TS content cache is not
flushed because the discard operation does a direct removal of NodeData
instances.

* Commit: `7ad21ab <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/7ad21ab5c34693b57c0ae30917210d645a36c339>`_

[BUGFIX] Transparent text for editing titles in node tree
-----------------------------------------------------------------------------------------

When editing titles in the node tree the text color of the input
field is blue for the current page and transparent for other pages.

* Commit: `6dfd63d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6dfd63d1305da323c2c7566fdc222018bdcbad98>`_

[FEATURE] allow to set dimension values in URL if not in live workspace
-----------------------------------------------------------------------------------------

As preparation for a translation user interface, we need the ability
to set dimension values (like "locale") in the URI, such that it can be
set like::

    features@user-admin;locales=de_DE,mul_ZZ.html

This change allows to set the dimension-values in the URI if not in live
workspace.

This is not yet integrated into the LocalizedFrontendNodeRoutePartHandler.

Additionally, removed a leftover conversion from UUID to nodes when generating URIs.

* Commit: `e1f10de <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e1f10de90dbb2fac96a7fa13b0851ab125bea10c>`_

[BUGFIX] Select box editor values inaccessible in inspector
-----------------------------------------------------------------------------------------

If a select box editor has options that are longer than the
available height in the inspector they are inaccessible.

Also removes the mouse scroll binding that makes it impossible to
scroll the inspector down when after scrolling the options to the bottom.

* Related: `#48307 <http://forge.typo3.org/issues/48307>`_
* Commit: `45f1115 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/45f1115ed86f27a6dc258bc878182b1c689fc1d8>`_

[TASK] Grunt concat inconsistent with library file
-----------------------------------------------------------------------------------------

The NProgress source file doesn't match the current
preprocessed file, this change just updates with the
output from grunt concat.

* Commit: `637694c <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/637694c51af82ffb5c366055a8f9a95d17d204bf>`_

[FEATURE] Localized node routing and consistent use of context path
-----------------------------------------------------------------------------------------

This change adds a LocalizedFrontendNodeRoutePartHandler that can be
configured for sites using localization. A new strategy for getting
the locales dimension values from a URI segement is added with
ContentDimensionPresetSourceInterface and a Settings based
implementation.

For consistent use of content dimensions in nodes, several parts of Neos
are updated to use the context path consistently.

Controllers and services in Neos are updated to use the new methods
in the ContextInterface instead of directly accessing the node data
through NodeDataRepository.

How to use
==========

In order to use the localized routing, the following needs to be inserted
to Objects.yaml::

    TYPO3\\Neos\\Routing\\FrontendNodeRoutePartHandlerInterface:
      className: TYPO3\\Neos\\Routing\\LocalizedFrontendNodeRoutePartHandler

Furthermore, a "locale" dimension must be configured, e.g. by using the
following Settings.yaml::

    TYPO3:
      TYPO3CR:
        contentDimensions:
          locales:
            default: mul_ZZ

After that, the site must be re-imported from XML.

This must be merged together with the corresponding changes in the TYPO3CR
package.

* Commit: `e5f9ead <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/e5f9ead20ba63294821eae05b1efacd2b6441b45>`_

[TASK] Make use of TYPO3.TYPO3CR PublishingService
-----------------------------------------------------------------------------------------

Adjust to change If13788febbf94a905080daea749b6d8bad50a931 where
the package is made independent of TYPO3.Neos, allowing the default
publishing service to be replaced using Objects.yaml

* Resolves: `#46464 <http://forge.typo3.org/issues/46464>`_
* Commit: `2798404 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/279840463ce30ea3b704f5e5d0ae5b38c4d46b64>`_

[TASK] Update CodeMirror from version 2 to 3
-----------------------------------------------------------------------------------------

Also fixes and improves various styling.

* Commit: `af1946e <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/af1946e26b700f8142936d5bd46ced12594b4565>`_

[FEATURE] Synchronize link ViewHelper arguments with Fluid
-----------------------------------------------------------------------------------------

Adds "section", "addQueryString" and
"argumentsToBeExcludedFromQueryString" to the link and uri
ViewHelpers for Neos to be in sync with the link action
ViewHelper.

This is also a first step to enable section index menus in Neos.

* Commit: `6885ee9 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6885ee96edcb7704de902c4e34508bc3b0352bf9>`_

[TASK] remove unused TypoScript for Raw Content Mode
-----------------------------------------------------------------------------------------

* Commit: `6a486c8 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/6a486c86ff9327057c27612ec6c86639b1900b56>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `ab85b8b <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/ab85b8bf08ac247a888831c0e0a9a545cd4c20a1>`_

[BUGFIX] Fix product-name in ValidationErrors.xlf
-----------------------------------------------------------------------------------------

* Commit: `d4055e6 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d4055e6c50cf3c1e898a1b884f8334a3cda06c2e>`_

[TASK] Update translations from translation tool
-----------------------------------------------------------------------------------------

* Commit: `5839ffb <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/5839ffb3ad41365f2a4e4224ab9f3f099be0086b>`_

[BUGFIX] add missing property initialization
-----------------------------------------------------------------------------------------

For testing edit for example the node title more
than once in the inspector and the title in the
trees should also be actualized.

* Commit: `d9513c7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/d9513c77477e023e7e6d57c4612a0921cd11005e>`_

[FEATURE] Prune a single site on command line
-----------------------------------------------------------------------------------------

Introduces the new argument site-node-name for the site prune
command to prune a single site based on the root node name.
Will clear all nodes and domains for this site as well as the
site object.

* Commit: `172fe76 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/172fe760dd92f94051de53dfe4f2ac5c8ba9528d>`_

[FEATURE] Recursive node type and identifier support in FindOperation
-----------------------------------------------------------------------------------------

Adds support for finding a node by its identifier within the
node context by using the syntax::

  ${q(site).find('#60216562-0ad9-86ff-0b32-7b7072bcb6b2')}

Adds support for finding all nodes of a specific node type
inside the scope of the node context using the syntax::

  ${q(site).find('[instanceof TYPO3.Neos.NodeTypes:Text]')}

Depends on I08b957467eea91f52cc6f2fea71ab45c797e4a8f

* Related: `#48278 <http://forge.typo3.org/issues/48278>`_
* Commit: `f7b095d <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/f7b095d07fc96908c2a0eb4c8f25ce473fed41d0>`_

[BUGFIX] Fix wrong publishable node counts with custom rel="x" markup
-----------------------------------------------------------------------------------------

The VIE library that is used to parse entities via RDFa returns entities
also for every "rel" attribute that is used to mark a relation to other
entities in RDFa (see http://www.w3.org/TR/rdfa-syntax/#A-rel).

The check for entities outside the "live" workspace did not check if
the entity attributes contain a workspace at all and just returned true
for unknown entities.

* Commit: `94b7ccf <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/94b7ccf46039ebd597b5eca2cad2b3b0e6171007>`_

[BUGFIX] improve documentation for PluginViews
-----------------------------------------------------------------------------------------

* Commit: `229d9ea <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/229d9ea7c52975be3c357ef34a0774bd7ad0de2c>`_

[BUGFIX] link.node and uri.node lack "arguments" parameter
-----------------------------------------------------------------------------------------

This adds an "arguments" parameter to the view helpers, allowing to
add arbitrary arguments to the generated links.

* Fixes: `#56732 <http://forge.typo3.org/issues/56732>`_
* Commit: `2f05ba7 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/2f05ba7b1ad109a885053006614249aa066ff065>`_

[TASK] Clarify documentation for nodePublished signal
-----------------------------------------------------------------------------------------

* Commit: `8d43410 <https://git.typo3.org/Packages/TYPO3.Neos.git/commit/8d4341053c2c0f72105058aa09c819ae95b29827>`_

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TYPO3.Neos.NodeTypes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[TASK] Mark migration as merged
-----------------------------------------------------------------------------------------

This commit marks some migrations as merged that are not needed on this
package. This speeds up core:migrate and avoids potential errors.

* Commit: `cbce144 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/cbce1443f2e208994bda7494b8eebb2929d1a05b>`_

[BUGFIX] Adjust remaining code migration identifier
-----------------------------------------------------------------------------------------

This is another follow-up for I3dc57f55ba052bee2399ba5b97e5f985fd0a4e3a
that fixes the identifier for a code migration.
Besides this contains the corresponding "Migration" footers so that
migrations won't be applied again.

Related: FLOW-110

* Commit: `6f30890 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/6f30890735f54a61adc93411808fe0a544c19d49>`_

[BUGFIX] Adjust code migration identifier pattern to contain the full timestamp
-----------------------------------------------------------------------------------------

Previously code migrations are expected to have a class name with the
pattern ``Version<YYYYMMDDhhmm>`` and the unique identifier was
determined extracting the last 12 characters of the class name (which
are expected to be the timestamp).

This change adjusts existing code migrations to use the full timestamp in
order to establish the new guideline (note: those migrations still
return the old identifier so that they won't be applied again with a
new identifier).

Related: FLOW-110

* Commit: `c5222ab <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/c5222ab7facde3031202984bebdcca44aba44a28>`_

[BUGFIX] Adjust remaining code migration identifier
-----------------------------------------------------------------------------------------

This is a follow-up for I3dc57f55ba052bee2399ba5b97e5f985fd0a4e3a that
adjusts a remaining code migration that has been left out in the previous
commit.

Related: FLOW-110

* Commit: `130d24d <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/130d24d43ecbd41b82ea4c89ac2026e598497816>`_

[TASK] Adjust HtmlEditor to CodeEditor
-----------------------------------------------------------------------------------------

Related: NEOS-379

* Commit: `3e184e3 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/3e184e3200b26951740d39a466771bff03fbb284>`_

[!!!][TASK] Hide document layout properties by default
-----------------------------------------------------------------------------------------

Since many websites won't use the layout features, it's
disabled by default but still easily available by setting
the inspector group for the properties.

If you rely on these properties, adjust your node type configuration
by setting the group on the two layout properties::

  'TYPO3.Neos.NodeTypes:Page':
    properties:
      'layout':
        ui:
          inspector:
            group: 'layout'
      'subpageLayout':
        ui:
          inspector:
            group: 'layout'

(cherry picked from commit 1e0b3112416e53bf16a365e2946c6b39be02e514)

* Commit: `425206f <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/425206f350389521cb4f4de4a2ada2f535bcbbf5>`_

[TASK] Update composer manifest
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/typo3-neos-branch/4/

* Commit: `e94fa06 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/e94fa066f3b7b3cb1aa5f41c018982c7be2cb6ca>`_

[!!!][TASK] Change default inline editing options
-----------------------------------------------------------------------------------------

Disables the underline tag as well as sub- and super script
tags by default. This is done since their usage is not common
enough to have as defaults.

Additionally a new del (strikethrough) tag option is added,
but disabled for easy configuration reference.

Confirmed by other editors like medium.com, squarespace, CKEditor
and TinyMCE.

* Commit: `c88a133 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/c88a13328d90120c46efdcefe2737ec64c800f4f>`_

[!!!][TASK] Use strong and em instead of b and i as default
-----------------------------------------------------------------------------------------

Might be breaking if relying on non-native browser styling
of b and i tags.

* Commit: `6f3fd67 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/6f3fd67ba752a83d7e51b4f11d31105791cf0940>`_

[TASK] Use different icon for Headline to distinguish from Text
-----------------------------------------------------------------------------------------

* Commit: `7c59b6f <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/7c59b6f68577cb0b45cacb5fb84186f97dc6c7a1>`_

[BUGFIX] Fix a spelling error in NodeTypes.Content.yaml
-----------------------------------------------------------------------------------------

Resolves: NEOS-503

* Commit: `9732376 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/97323767173f36581e519f2f48b2d4807f606561>`_

[BUGFIX] Menu item attributes should have access to item in context
-----------------------------------------------------------------------------------------

This change updates the Fluid template for menu rendering to pass
the item variable to the attributes rendering.

Resolves: NEOS-276

* Commit: `9649f42 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/9649f42bf4614ef3452b0a972a6673165a586fc1>`_

[FEATURE] Manual node selection in Menu element
-----------------------------------------------------------------------------------------

This change allows manual selection of reference nodes
in the menu node type.

Resolves: NEOS-371

* Commit: `7e0d051 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/7e0d051fede2e34a9225fc8ae334aa46b62e15bf>`_

[TASK] Adjust to link editor feature
-----------------------------------------------------------------------------------------

Adds the new link editor to the Image node type and postprocessing
of the link data to the TypoScript prototype.

Resolves: NEOS-174

* Commit: `2e7a1d4 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/2e7a1d48edf116f04e5594597e88f656531c6ff3>`_

[TASK] Introduce mixins to avoid illogical inheritance
-----------------------------------------------------------------------------------------

Introduces new reusable mixins to use for building node types.
Additonally the inheritance chain is altered so TextWithImage
no longer super types Text and Image.

The following mixins are introduced:

 - ``TYPO3.Neos.NodeTypes:TitleMixin``
 - ``TYPO3.Neos.NodeTypes:TextMixin``
 - ``TYPO3.Neos.NodeTypes:ImageMixin``
 - ``TYPO3.Neos.NodeTypes:ImageCaptionMixin``
 - ``TYPO3.Neos.NodeTypes:ImageAlignmentMixin``
 - ``TYPO3.Neos.NodeTypes:LinkMixin``
 - ``TYPO3.Neos.NodeTypes:ContentImageMixin``

Resolves: NEOS-382
Related: NEOS-239

* Commit: `6dca255 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/6dca255420c7dbe218efecc709868d1333aa5826>`_

[TASK] Replace dummy image for image elements with SVG
-----------------------------------------------------------------------------------------

* Commit: `ae12cc1 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/ae12cc10922f7046ea979569548dab0f02a87a5d>`_

[BUGFIX] Incorrect indentation for document properties
-----------------------------------------------------------------------------------------

* Commit: `c4a8b59 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/c4a8b598b6f11113210df888ab6ab5327e845806>`_

[TASK] Swap access check with workspace check
-----------------------------------------------------------------------------------------

Change I038acef327dea63393f1fe4925c6746582265d30 added a new template.

This change inverts a check for the workspace being not the live
workspace and for access to the TYPO3_Neos_Backend_GeneralAccess
resource.

See Ibe30042ec079ececf7441295dd21ffd9b0259760 for more details.

Related: NEOS-337

* Commit: `c69607a <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/c69607a9e6adefaabd27a7f1ed2b5f3d9e81e599>`_

[TASK] Add default settings for node type position
-----------------------------------------------------------------------------------------

This change adds setting for position to node types
that appear in the insert new panels so that they
have a default sorting.

* Commit: `1c361e2 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/1c361e28088a278a174c3bbfcfa31b181edfee6a>`_

[FEATURE] Add new content element for inserting records
-----------------------------------------------------------------------------------------

Add a new content element for inserting one or more records from either
the same page or another page as a reference which then make editing
possible from both locations.

Resolves: NEOS-337

* Commit: `a1a4d38 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/a1a4d385bae7ca57e952c2fabfa252873d69faee>`_

[BUGFIX] Avoid exception when rendering new asset list element
-----------------------------------------------------------------------------------------

A freshly created asset list element contains no assets array, thus a foreach
triggers a notice throwing an exception. This change fixes that by checking for
the assets value being an array before using it.

Resolves: NEOS-229

* Commit: `531b35c <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/531b35c2b78a82c265a748f9ab3326731cd07818>`_

[TASK] Work around Image serialize bug
-----------------------------------------------------------------------------------------

This change adds a workaround typoscript object for the AssetList node
type that prevents the related assets from being serialized during the
site import.

Related: NEOS-121

* Commit: `8089b7b <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/8089b7b7a34c5a1ac97f414b120fbfc4fc68cf04>`_

[TASK] Remove obsolete "priority" from NodeTypes configuration
-----------------------------------------------------------------------------------------

Replaces an occurrence of the deprecated "priority" setting by
"position" in ``NodeTypes.Content.yaml``.

* Commit: `f06a1a2 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/f06a1a28345033578eee5562c81508525d2a1570>`_

[TASK] Update to use TYPO3.Neos:ConvertUris
-----------------------------------------------------------------------------------------

This change updates the TypoScript to use the
TYPO3.Neos:ConvertUris TypoScriptObject which is now
introduced to handle node:// and asset:// links.

Related: NEOS-20

* Commit: `b8e9a94 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/b8e9a943135e9896c64dc31df4eb7f3648d718d5>`_

[FEATURE] Add asset list node type
-----------------------------------------------------------------------------------------

This change adds a new AssetList node type that allows to select
multiple assets and renders them as a list of links to the files.

* Commit: `47dd69d <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/47dd69d3285be36c2f5197b437c8aae0a00ed351>`_

[TASK] Split node types configuration into documents and content
-----------------------------------------------------------------------------------------

Related: NEOS-72

* Commit: `ed949d9 <https://git.typo3.org/Packages/TYPO3.Neos.NodeTypes.git/commit/ed949d96f83e3f465889e41d3b0c2254daf2b300>`_

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TYPO3.Neos.Kickstarter
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[TASK] Adjust Sites.xml template to new format
-----------------------------------------------------------------------------------------

With support for content dimensions the XML format has been adjusted. This
change updates the template used to kickstart sites to that new format.

The indentation is changed from tabs to spaces, as the site export uses spaces
to indent as well.

Related: NEOS-166
Related: NEOS-158

* Commit: `b89877e <https://git.typo3.org/Packages/TYPO3.Neos.Kickstarter.git/commit/b89877e52f5d48916b7385fc1de6f194903c29bb>`_

[TASK] Update composer manifest
-----------------------------------------------------------------------------------------

See https://ci.neos.typo3.org/job/typo3-neos-branch/4/

* Commit: `83b7421 <https://git.typo3.org/Packages/TYPO3.Neos.Kickstarter.git/commit/83b7421c7833239a1dd348f755afd04e27f4cd01>`_

[TASK] Kickstarter should use the proper TypoScript path
-----------------------------------------------------------------------------------------

Create the same folder structure for TypoScript in all packages.

Related: NEOS-390

* Commit: `3b91f4d <https://git.typo3.org/Packages/TYPO3.Neos.Kickstarter.git/commit/3b91f4dec9b448f481a17878b4f7f829abd77475>`_

[TASK] Update page TypoScript to match best practice
-----------------------------------------------------------------------------------------

The page TypoScript declaration needs to use the correct property
for head javascripts. The includes also had to be declared as an Array
property instead of overriding the complete "javascripts" definition for
further extension.

This change additionally adds the body javascripts as an additional
section to the template for an easier start for the integrator.

* Commit: `1a577c1 <https://git.typo3.org/Packages/TYPO3.Neos.Kickstarter.git/commit/1a577c1ae01d8f6cff19387492e57da50a9f0f6a>`_

[TASK] No namespace include in autogenerated TypoScript
-----------------------------------------------------------------------------------------

The namespace include in the generated TypoScript is not saving
much typing and will just confuse beginners, therefor it is
removed.

* Commit: `5fcb40c <https://git.typo3.org/Packages/TYPO3.Neos.Kickstarter.git/commit/5fcb40c537368bcd140cfb05a06a85141d9e9c9b>`_

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TYPO3.TYPO3CR
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[BUGFIX] Allow importing/exporting DateTime properties
-----------------------------------------------------------------------------------------

Fixes: NEOS-727

(cherry picked from commit 095cbe9e3aab5e70f23fc012cb6cde49b8f87e8c)

* Commit: `290e0b8 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/290e0b8f2b23cdbd46179cdbf1a59d9dcec7149b>`_

[BUGFIX] Adjust code migration identifier pattern to contain the full timestamp
-----------------------------------------------------------------------------------------

Previously code migrations are expected to have a class name with the
pattern ``Version<YYYYMMDDhhmm>`` and the unique identifier was
determined extracting the last 12 characters of the class name (which
are expected to be the timestamp).

This change adjusts existing code migrations to return the old identifier
so that they won't be applied again.

Related: FLOW-110

* Commit: `888739a <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/888739ac6c1ce9a621b294e9b3fd1b8dfe3099f9>`_

[TASK] Move node related FlowQuery operations to TYPO3.TYPO3CR
-----------------------------------------------------------------------------------------

This adds all FlowQueryOperations from TYPO3.Neos in TYPO3.TYPO3CR
as they belong in the TYPO3CR package. For more information see
the change that removes the operations from TYPO3.Neos (available at
https://review.typo3.org/32746).

A code migration to automatically correct the updated namespace is
provided and can be applied with::

    ./flow core:migrate --package-key [PackageKey]

Resolves: NEOS-405

* Commit: `e49fc93 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/e49fc93fe5b7c8f0f30c680ff7623e93d0c56f04>`_

[TASK] Don't flush the complete routing cache for moved nodes
-----------------------------------------------------------------------------------------

With Ic131d828f491b8559d93647625298a5eccaeb131 only routing cache
entries for related nodes will be flushed.

Related: NEOS-296

* Commit: `2e57389 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/2e573891c3d4f7bb507cc55618204b312f46e2dd>`_

[TASK] Type cast integer properties to actual integers
-----------------------------------------------------------------------------------------

Related: NEOS-419

* Commit: `3318240 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/331824087ca7a650d5d7d3244ce9e66b9f8a0087>`_

[BUGFIX] Node type migration filter's ``withSubTypes`` option broken
-----------------------------------------------------------------------------------------

The node type node migration filter's ```withSubTypes`` option breaks
for unstructured nodes.

* Commit: `513a5a1 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/513a5a133162e94b925852cb1ed6794fa2dbb24e>`_

[BUGFIX] adoptNode to context with different dimension and workspace
-----------------------------------------------------------------------------------------

Adopting a node to a different context that will also change the
workspace results in wrong dimension values that were persisted by
cloning the original NodeData. This change fixes the problem by creating
a new NodeData and using similarize. A Behat scenario reproduces the
problem.

Fixes: NEOS-651

* Commit: `608f708 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/608f708ce9bf944231802ab6f44b6a61d4ff1038>`_

[TASK] Add current node data to nodePathChanged signal
-----------------------------------------------------------------------------------------

This extends the signal ``nodePathChanged`` in the NodeData class that
is triggered whenever the path of a node is changed by adding the
changed node data instance as argument.

This is backwards compatible because exceeding arguments will be
ignored by the slot.

We currently need this to flush related routing caches only.

Related: NEOS-296

* Commit: `d83b1db <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/d83b1db1db0e992795ff5326d7ed995aee4cb411>`_

[TASK] Introduce signal for node property changes
-----------------------------------------------------------------------------------------

This adds a signal ``nodePropertyChanged`` to the Node class.
The signal is triggered whenever the property of a node is added
or changed.

We currently need this signal to flush related routing caches
whenever the "uriPathSegment" property of a node is modified.

Related: NEOS-296

* Commit: `86cc54b <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/86cc54b31dbb1bcf4786d511f9b39a4ec4068af8>`_

[TASK] Add on cascade delete on NodeDimension NodeData property
-----------------------------------------------------------------------------------------

As a NodeDimension must have a NodeData relation, if we remove the
NodeData, we need to remove the NodeDimension. By using on cascade delete,
the database can handle this in a performant way.

Resolves: NEOS-531

* Commit: `5555f7e <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/5555f7e0382b66eb1697c25b682d154df59dd8f6>`_

[!!!][TASK] Mark NodeInterface::getFullLabel deprecated
-----------------------------------------------------------------------------------------

Currently the NodeLabelGenerator has support for cropping and the method
NodeInterface::getFullLabel returns the label of the current node without
cropping. For consistancy and flexibility, the cropping should be done
in the view. Therefor Node::getLabel() will now return the full label
without cropping.

In this change, the method NodeInterface::getFullLabel is marked
deprecated since 1.2 but returns the same full label as before that is
now also returned by NodeInterface::getLabel.

This change is marked breaking because NodeInterface::getLabel now returns
labels of any length so you need to take care to shorten the labels
if needed and additionally because NodeInterface::getFullLabel is
considered deprecated and the NodeLabelGeneratorInterface no longer
mentions the $crop argument.

Resolves: NEOS-441

(cherry picked from commit 0894df29dd18e28e94e9d6ac0c94018e407890a6)

* Commit: `0a968e3 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/0a968e32515d29e2808cee05a2645940a1793ec8>`_

[BUGFIX] Renaming nodes to an existing path is accepted
-----------------------------------------------------------------------------------------

When a node is renamed CR doesn't check if the target path already
exists. This leads to the unexpected behaviour that all subnodes
are basically moved to the already existing node, and the moved
node disappears.

This change throws adds an exception to setPath() if the path
already exists. Additionally a case where a node is renamed to a
previously renamed node is supported.

Fixes: NEOS-591

* Commit: `6126d9e <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/6126d9e022774ba7a53f8ff1dd3bc7efa6ab3232>`_

[TASK] Adjust Behat scenarios for inheritance of node type constraints
-----------------------------------------------------------------------------------------

The change I4e541185fdfb49a145a09d8a2286e59c518b861e did not update
the Behat feature for node type constraints to the new behavior.

Related: NEOS-239

* Commit: `02a5764 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/02a5764346b5f818f5ee2b64c98c75d1b8457078>`_

[BUGFIX] UnitTest adapted to change in NodeData::createSingleNodeData
-----------------------------------------------------------------------------------------

The change I5945de459b8564d67698e189e956ed93664d2ac6 introduced a
regression in this UnitTest as the call structure changed.

* Commit: `15529ff <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/15529ff82b8e0461ddc42233d313aecbbc158741>`_

[BUGFIX] Node type set afterwards leads to race conditions
-----------------------------------------------------------------------------------------

When creating new node data instances, the node type is set
after the initial persisting which can lead to race conditions.
Problem is that doctrine executes update statements in specific
order. Then when querying the node data repository in the same
request the query might fire before the update, causing the
new node not to be found.

Fixes: NEOS-355

* Commit: `c25d2e5 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/c25d2e5410ba4ebb2f9844826b4e3ebabf4219e8>`_

[BUGFIX] Exclude shadow nodes from unpublished nodes
-----------------------------------------------------------------------------------------

Publishing a workspace with a moved node in a new ContentCollection
left an open change due to a shadow node that overlapped the moved node
when getting the unpublished nodes.

This is solved by excluding shadow nodes in the repository method.

Fixes: NEOS-507

* Commit: `de9215c <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/de9215c5be0a6f0f18674a6ffe0eecaf36062c02>`_

[BUGFIX] Renaming nodes is broken
-----------------------------------------------------------------------------------------

When a node property is set and the node name is changed
(node is renamed) a unique constraint occurs since the introduction
of the shadow nodes.

This is fixed by considering added nodes (the node is materialized when
updating any property) when searching for other node variants to set
the node path.

Fixes: NEOS-578

* Commit: `21132c6 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/21132c648255fc09cb23fca13955cccac52ffa98>`_

[BUGFIX] Correctly adjust shadow nodes for materialized nodes
-----------------------------------------------------------------------------------------

Moving nodes in a workspace creates shadow nodes to hide the original
version of a live workspace. For some scenarios the shadow node was
not created correctly, so that the original node re-appeared.

In order to fix this we have to work around the order of SQL operations
that is executed by Doctrine to keep the unique key constraint correct.

Resolves: NEOS-447

* Commit: `05b5be8 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/05b5be818d95c157bdac81c3921b50a55f30ca9d>`_

[BUGFIX] Method with CompileStatic needs to be called with static
-----------------------------------------------------------------------------------------

For an effective CompileStatic cache the method needs to be called with
"static" to use late static binding instead of calling the original
uncached method with "self".

* Commit: `abbbac2 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/abbbac253fd2dd8df63cf9287fa05bafdc06e563>`_

[FEATURE] Node export / import service with content dimensions support
-----------------------------------------------------------------------------------------

This change introduces a new export / import service written which
allows to programmatically export a TYPO3CR node tree including all
of its resources.

For conversion of special property types to and from XML this services
uses the property mapper.

Resolves: NEOS-165

* Commit: `7ca2e0f <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/7ca2e0f6af0e65a7d8d4d4da6c565e4f8b2bfa7d>`_

[TASK] Remove useless require_once call
-----------------------------------------------------------------------------------------

* Commit: `4060c56 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/4060c567c9759affcf6187dc55aa53d749b7fc4a>`_

[TASK] Add missing PostgreSQL migration
-----------------------------------------------------------------------------------------

In change I5425ff41fa2ac9e9b240dc4871098573f08492ae a migration for MySQL
was added, but the one for PostgreSQL was missing.

Related: NEOS-313

* Commit: `64e77d7 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/64e77d71937dc26f03484d5d711eb78cd7f8c0ab>`_

[FEATURE] Introduce plugin functionality for the node:* commands
-----------------------------------------------------------------------------------------

This extracts the create-missing-childnodes functionality of the node:repair
command into a "plugin". This allows us to introduce further tasks which are
executed by node:repair but are implemented in other packages than TYPO3CR.

More specifically we need this feature for being able to generate missing
URI path segments for the translated URI functionality in Neos.

Related: NEOS-296

* Commit: `5eb9836 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/5eb98367acba81796d00f6778b924375f9edf7f2>`_

[TASK] Expose isShadowNode method for node
-----------------------------------------------------------------------------------------

Related: NEOS-389

* Commit: `7fdbdc7 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/7fdbdc73a90173698724ca358128eb132095d2f5>`_

[BUGFIX] Moving nodes on same level should only apply on user workspace
-----------------------------------------------------------------------------------------

Fixes a regression where a node was moved in the live workspace when
the path of the node did not change (and thus the node was not
materialized by setPath).

* Commit: `2043548 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/2043548f5dd6ca8fce2d8a06435783a6a6812583>`_

[!!!][BUGFIX] Consistently move all nodes across dimensions
-----------------------------------------------------------------------------------------

In order to have a predictable behavior for TYPO3CR when working
with different dimensions, moving a node in one dimension should also
move the same node in other dimensions consistently. However, a
different workspace should not be affected.

Resolves: NEOS-370

* Commit: `1278291 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/127829135804889e38acb7939cce84f9afaa5d2a>`_

[FEATURE] Allow simple search/replace in ChangePropertyValue transformation
-----------------------------------------------------------------------------------------

This adds simple search/replace to the ChangePropertyValue transformation,
so that adjusting existing values becomes possible (as opposed to setting
new values).

* Commit: `9775024 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/9775024e72b88376824d78f9158935efb8cecdd8>`_

[FEATURE] Handle properties of type array
-----------------------------------------------------------------------------------------

Related: NEOS-419

* Commit: `0c448fd <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/0c448fd161d5f0fb7c086cc2fb946772b4a808ad>`_

[!!!][TASK] New node label management
-----------------------------------------------------------------------------------------

Node label generation is moved from ``NodeData`` into ``Node`` with
a few additional changes and improvements.

The ``NodeLabelGeneratorInterface`` and ``DefaultNodeLabelGenerator``
were renamed to NodeData* and both deprecated.

The new NodeLabelGeneratorInterface now expects a ``NodeInterface`` to
generate the label with. Default implementation is the
``ExpressionBasedNodeLabelGenerator`` that accepts an EEL expression
to generate the node label. To make this easy to use the simplest way
of configuring an alternative expression is now::

  'My.NeosSite:SomeNodeType':
    label: "{q(node).property('someLabelProperty')}"

If you need more complex logic you can still employ an implementation
of the NodeLabelGeneratorInterface and configure it like this::

  'My.NeosSite:SomeNodeType':
    label:
      generatorClass: 'My\\NeosSite\\TYPO3CR\\SomeNodeLabelGenerator'

In the deprecation phase this will also accept implementations of
``NodeDataLabelGeneratorInterface`` for backwards compatibility
reasons.

The code migration 20140911160326 takes care of changing existing
implementations of the old ``NodeLabelGeneratorInterface`` to the
deprecated ``NodeDataLabelGeneratorInterface`` and to change the
NodeTypes configuration to the new format.

Resolves: NEOS-257
Resolves: NEOS-399

* Commit: `a87bfc1 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/a87bfc10e4bfaa99cb616a9844975583ccc0a0bc>`_

[BUGFIX] findOneByPathInContext does not respect isRemovedContentShown
-----------------------------------------------------------------------------------------

* Commit: `ee62a41 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/ee62a41eb718b7b9935f4585fcb6d0ca89489bad>`_

[FEATURE] Inheritance for NodeType constraints
-----------------------------------------------------------------------------------------

Needs documentation, maybe more tests, but should work.

Direct constraints have precendence over inheritance,
besides the * constraint.
SuperTypes nearer to the actual type have precedence,
in case there is a FALSE and TRUE on the same, highest level
the FALSE will win.

Resolves: NEOS-239

* Commit: `bf7e461 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/bf7e46160fb05769c10aebdd4677a05e28342658>`_

[FEATURE] Allow advanced default values for properties of type date
-----------------------------------------------------------------------------------------

This patch makes node date properties support default values like
"now", "+1 day", "tomorrow", "next monday" etc.

Resolves: NEOS-172

* Commit: `1f75d96 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/1f75d96a270edc48c861163934a08562b61f52dd>`_

[BUGFIX] Changing node types uses custom logic for default properties
-----------------------------------------------------------------------------------------

This patch refactors the NodeService so creation and
changes to content nodes uses the same logic for getting
default values for properties.

Fixes: NEOS-286

* Commit: `16a423e <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/16a423e2d6523c71774dab307db4735791385f14>`_

[BUGFIX] Correctly handle node variant fallbacks in workspaces
-----------------------------------------------------------------------------------------

- Respect content dimensions before workspace hierarchy when reducing
  possible node results
- Create shadow NodeData when moving nodes to handle shine-through nodes
  correctly, set a reference between the moved node and the shadow
  node
- Refactor large parts of the NodeDataRepository for unified querying

Resolves: NEOS-313

* Commit: `dd9e877 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/dd9e877e53a5e2bde71d40dd0297eb0d220c2f16>`_

[TASK] Move tests from Neos package to TYPO3CR
-----------------------------------------------------------------------------------------

The move of the ConfigurationContentDimensionsPresetSource from Neos
broke a unit test, this showed some of the tests should have been moved
as well (see If52b4b570d52c9f39c06ce192421d785e85f54bc).

* Commit: `f9d0fa4 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/f9d0fa4fc57d03c60fd9bcccd262b6fc0ac23d37>`_

[!!!][TASK] Unify dimension settings into TYPO3CR
-----------------------------------------------------------------------------------------

With this change dimension presets are mandatory for dimension
configuration in TYPO3CR, only setting the default value is not
enough anymore. That makes sure that the TYPO3CR knows about all
possible dimension values.

Additionally the ContentDimensionPresetSource service and interface
have been moved to TYPO3CR.

Related: If1f56f9a8cab7ba1dff46f7835acf9893ebcb9e9

* Commit: `e87f840 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/e87f840b1a163b7f57ab20566d4d06a74746b503>`_

[TASK] Remove external package dependencies in tests
-----------------------------------------------------------------------------------------

This change removes the external dependencies to TYPO3.Neos
and TYPO3.Neos.NodeTypes and the demo site package for running
the tests of TYPO3.TYPO3CR.

Related: NEOS-34

* Commit: `7deac94 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/7deac9418c54ced99a327c948dad68b1112672e3>`_

[TASK] Rename node:autocreatechildnodes command to node:repair
-----------------------------------------------------------------------------------------

This change renames the node:autocreatechildnodes to node:repair and
by that creates a command which can perform further "repair" tasks in
the future. From a user's perspective simply running "repair" will likely
solve all structural node problems.

Further more, the command controller is moved to the TYPO3CR package
and thus consists of two commits: this one which adds the controller to
TYPO3CR and a second one which removes it from Neos.

Resolves: NEOS-325

* Commit: `7a68993 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/7a68993ee7d1d5f5adebdd25ab0d0c9fe9c65933>`_

[BUGFIX] Searching node properties works only case sensitive
-----------------------------------------------------------------------------------------

Search for the given identifier in the repository method
``findByRelationWithGivenPersistenceIdentifierAndObjectTypeMap``
should be done case sensitive because case insensitive search
won't work on blob fields in MySQL.

Since case sensitive like was merged in Flow with
I53cd80e145eb49bcf8251f0045b9f3ec4fd61105 the feature to
prevent deletion of used assets was broken.

* Commit: `c96fe2e <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/c96fe2ec2f4620dcdc1b8ce45f301f0a63e12a34>`_

[BUGFIX] Auto created childNodes can not be copied
-----------------------------------------------------------------------------------------

When a node type has auto created child nodes that are not explicitly
allowed in a constraint the node creation is still allowed. As copying
a node is a similar operation we should also allow those nodes to be
created on copy operations.

This change allows copied auto created child nodes to be created even
if the node type constraints would not allow the node type if the node
would not be auto created.

Besides fixing the copy command the change adds a test to verify that
moving node types with similar constraints on auto created child nodes
is possible.

Fixes: NEOS-319

* Commit: `8588341 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/8588341d05b4aabe2685367e104ecb614bee4bbd>`_

[BUGFIX] RenameDimension transformation should not delete all
-----------------------------------------------------------------------------------------

The RenameDimension transformation was previously deleting all
existing NodeDimensions therefor removing all nodes from existence
for any API methods. The nodes itself still existed.
This change fixes the behavior to work as expected.

* Commit: `6661f1e <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/6661f1e6df379f88835d673444de370861bbddd0>`_

Revert "[TASK] Minor comment changes to Node class"
-----------------------------------------------------------------------------------------

This reverts commit 4c9e688356e4d840008defd009e4bf23dc2503a2.

* Commit: `6b1cffe <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/6b1cffed4a9b3b002a34fd6a65aa3ba0861a22ad>`_

[TASK] Minor comment changes to Node class
-----------------------------------------------------------------------------------------

* Commit: `4c9e688 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/4c9e688356e4d840008defd009e4bf23dc2503a2>`_

[TASK] Make Behat context extendable
-----------------------------------------------------------------------------------------

This change adds a private getter for the publishing service
in the step definition trait to allow the trait to be reused by
the Neos Behat tests where it can return the Publishing service
available in Neos.

For the master branch this change applies to the trait, for the
1.1 branch the method has to be added to the FeatureContext as
the trait didn't yet exist.

* Commit: `734bbbd <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/734bbbd3f98324a4910d8b66029b3c371722de1c>`_

[BUGFIX] UnpublishedNodes includes root node in PublishingService
-----------------------------------------------------------------------------------------

The getUnpublishedNodes method in the PublishingService shouldn't
include the root node, since it's not publishable.

Besides that the getUnpublishedNodes() method now returns 0
if it's called for the live workspace as this workspace will
never have unpublished nodes.

* Commit: `8cf763a <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/8cf763a9e9cf0f297e3fd22e57c273cde9e02ae7>`_

[TASK] Replace occurrences of the "languages" dimension with "language"
-----------------------------------------------------------------------------------------

This change adjusts code examples in comments and tests to follow the
renaming of the "languages" content dimension to "language" in Neos.

Related: NEOS-211

* Commit: `0c46982 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/0c469825675250e78ff3b463c5d040180bd99179>`_

[BUGFIX] Default value support for internal node data properties
-----------------------------------------------------------------------------------------

This fixes setting default values for internal node data (_*) properties.
Before setting a default value meant that it would end up being set in
the property array with the prefixed key never to be used again.

Fixes: NEOS-169

* Commit: `bda136a <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/bda136a5ea082814e356c7d5ff2d868f2ae74766>`_

[FEATURE] Custom Node implementations
-----------------------------------------------------------------------------------------

To allow custom build-in functionality for NodeTypes it is now possible
to configure a ``class`` for a NodeType. All nodes of this type will
then be instances of the given class. Note that the class HAS TO
implement from ``NodeInterface`` and currently should extend the default
``Node``.
The configuration can look like this::

  'My.Custom:NodeTypeWithClass'::
    class: 'My\\Custom\\TYPO3CR\\NodeTypeWithClass'
    ...

Resolves: NEOS-298

* Commit: `d1e37a8 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/d1e37a8231b62e63fb24638ef4685fc0989d3831>`_

[TASK] Allow all child nodes by default if nothing is configured
-----------------------------------------------------------------------------------------

When no constraints have been configured the default behavior is
to disallow all child nodes. Instead all child nodes are allowed
if nothing is configured, since the feature should only take affect
in intentionally used.

Resolves: NEOS-321

* Commit: `4de7947 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/4de7947d6675906467cbb9a0fc02775483d74ac3>`_

[BUGFIX] Publishable nodes in Neos UI uses wrong dimensions
-----------------------------------------------------------------------------------------

This fixes a bug in the TYPO3CR Publishing Service which did not consider
content dimensions when retrieving the currently unpublished nodes.

See also the related change in TYPO3.Neos (see topic NEOS-308).

Related: NEOS-308

* Commit: `f4b075c <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/f4b075c129860f34e9c7ad475ab6cb2aa802cec0>`_

[TASK] Code cleanup in node type converter
-----------------------------------------------------------------------------------------

* Commit: `f4dc403 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/f4dc4036096167470a7eb76989c466bb1eec163a>`_

[BUGFIX] ContextFactory does not check dimension configuration
-----------------------------------------------------------------------------------------

The ContextFactory should check if the given dimension values are
arrays as specified or something else to prevent non meaningful
error messages. The case now produces an exception with a clear
error message stating that the dimension configuration is wrong.

Fixes: NEOS-280

* Commit: `cbae8dd <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/cbae8dd352b4d57ce7847ce41cccdd953e6a4a0d>`_

[BUGFIX] pathExists anonymous function uses $this
-----------------------------------------------------------------------------------------

The query without authorization checks should not use this in
the anonymous function scope.
This fixes a bug introduced with the mentioned related change,
that didn't happen during testing.

Related: Ic05fd961da353f3166e17f11e1744431ed272433

* Commit: `145f386 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/145f3865571669cb17db74bcf30cfade3fbd3c02>`_

[TASK] Make error message a tiny bit more helpful
-----------------------------------------------------------------------------------------

When copying a node fails due to node type constraints, express that
reason to help the developer.

* Commit: `ecdad63 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/ecdad63dbca4e939d265acbdffe6b31493b02724>`_

[TASK] Make properties optional in ContextFactory->create()
-----------------------------------------------------------------------------------------

Since there are defaults and one could already pass an empty array to
ContextFactory->create() this change makes the $contextProperties
argument optional.

* Commit: `e62aef4 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/e62aef43bb600b2f390400b3888985143b3acc64>`_

[BUGFIX] Remove removed nodes without existing node when publishing
-----------------------------------------------------------------------------------------

Nodes that are created and removed in a user workspace were not removed
when publishing them to the live workspace. This can have sideeffects
in the Neos backend where removed nodes are rendered and causes problems
where a changed or removed node type throws exceptions.

This change fixes the problem and provides a migration to remove any of
these removed nodes that stayed in the content repository.

Run the following node migration to remove published nodes that are
removed::

    ./flow node:migrate 20140708120530

Fixes: NEOS-236

* Commit: `eb3f18c <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/eb3f18c5b673b235277a511e95f53925f7e2e5dc>`_

[BUGFIX] ContextFactory: PHP throws notice if dimension doesn't exist
-----------------------------------------------------------------------------------------

This change fixes the error handling within ContextFactory which didn't
throw an exception on an invalid dimension name because of a wrongly
built exception message.

* Commit: `7b4bf3b <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/7b4bf3b43aca2112888040eceb85a73283ce0b94>`_

[FEATURE] NodeType constraints in TYPO3CR
-----------------------------------------------------------------------------------------

Introduces constraint configurations for Nodes. Currently
allowing/disallowing of NodeTypes is implemented for direct
child nodes and for grand-child nodes that are auto created.

An example configuration looks like this::

  'TYPO3.Neos.NodeTypes:Column':
    constraints:
      nodeTypes:
        'TYPO3.Neos:ContentCollection': TRUE

This whitelists 'TYPO3.Neos:ContentCollection' as only possible
child node type for 'TYPO3.Neos.NodeTypes:Column'.

Using the Node API will result in a NodeConstraintException if the
operation cannot be completed due to configured constraints.

In order to understand the full API possibilities, please
look at the ChildNodeConstraints.feature which is part of
this commit.

Related: NEOS-34

* Commit: `d8d8a3e <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/d8d8a3e5fceb6aa356a191febf8c637dc7437039>`_

[BUGFIX] Danish/Norwegian letters converted incorrect in node name
-----------------------------------------------------------------------------------------

The Danish/Norwegian letters "Ø/Å" are converted incorrect when the node
title is transliterated into a valid node name. Instead of being
converted to "oe/aa" they are just converted into "o/a".

Fixes: NEOS-170

* Commit: `f640cbf <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/f640cbf21d7fd55c4b4f8dcde8762c9694c9909f>`_

[TASK] Support time and time zone offset in date properties
-----------------------------------------------------------------------------------------

Use the \\DateTime::W3C format for converting dates for date
properties in the node converter, which supports time and
time zone offsets.

The time zone is then converted to the servers default time zone
to match the systems time zone.

Related: NEOS-203

* Commit: `5dae042 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/5dae0429887af9054eaff3ca6a64bdfaa2374292>`_

[TASK] Behat: Move step definitions into re-usable trait
-----------------------------------------------------------------------------------------

This change moves the Behat step definitions of this package's feature
context to a trait which can be used in other package's feature contexts
(e.g. in TYPO3.Neos).

I favoured a trait over Behat's sub context feature because the latter
would only provide the step definitions per se and not the other useful
functions. Another reason was that the step definitions rely on Flow's
object manager - a dependency which I wasn't able to implement as nicely
as with traits.

Related: NEOS-167

* Commit: `cbad5a8 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/cbad5a8baba0aa24b28ec0327311ace4e7586f18>`_

[BUGFIX] Behat Feature works with PHP 5.3
-----------------------------------------------------------------------------------------

Array Access to an array return from a function is not allowed
in PHP 5.3. It was replaced by a backwards compatible access
to the value.

* Commit: `ed9e80b <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/ed9e80b5399a1b0c018d02fe0187bd64fe77b791>`_

[TASK] Prevent entity constraints in pathExists() method
-----------------------------------------------------------------------------------------

* Commit: `a82d17d <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/a82d17dc7f3ae38bab8c320f1c15103bb8b14f69>`_

[BUGFIX] createVariantForContext() fails if workspace differs from source
-----------------------------------------------------------------------------------------

This change fixes a bug with Node::createVariantForContext() which fails
if the specified target workspace differs from the workspace of the
reference node's workspace.

The root cause for this bug is that Node Data objects have been update()d
on every modification regardless if they are new or not. Since most of
the other operations were typically only used on nodes which have been
persisted previously, the bug did not appear. createVariantForContext()
however will create a clone of the reference node if the workspace differs
which causes Repository->update() to fail.

This change also contains some small cosmetic changes and doc comment
improvements related to content dimensions.

* Commit: `9fa4d0b <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/9fa4d0b6af3e0ba9a72ab451b947de22d0287b6e>`_

[TASK] Skip failing functional test on SQLite
-----------------------------------------------------------------------------------------

Followup to I56f8e922f84c00d9402837591d308583f7069b3f, the tweak is
included in the change for the 1.1 branch directly.

* Commit: `957d929 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/957d929a9789ea999aa7d4846146d77bfd422539>`_

[TASK] Method to find entity relations in Node properties
-----------------------------------------------------------------------------------------

Needed to detect linked media assets in nodes. But useful to
find all kinds of related entities.

* Commit: `023acf2 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/023acf2d7965f23827848c3e15db298a6959b330>`_

[TASK] Method to find if a given path exists anywhere in the CR
-----------------------------------------------------------------------------------------

* Related: `#58428 <http://forge.typo3.org/issues/58428>`_
* Commit: `95201c9 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/95201c9df1ac321069e6f1a0dfe51fe7e1de7afa>`_

[BUGFIX] Fix three risky unit tests
-----------------------------------------------------------------------------------------

* Commit: `73a0f44 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/73a0f445a4464c92a612fe1fdd84df7f31527405>`_

[BUGFIX] Copy into the correct reference node
-----------------------------------------------------------------------------------------

A copyAfter() and copyBefore() call will currently first copy the node
into the reference node and then move after it in a second step. This is
not only resource inefficient but also error prone.

* Commit: `6caee32 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/6caee3213e61b0bbbc151e3fcd36524aa43eabac>`_

[TASK] Adjust NodeType schema to recent changes
-----------------------------------------------------------------------------------------

Validating the NodeType configuration shows some errors due to the
recently introduced "validation" key.
This adjusts the NodeType YAML schema accordingly.

* Commit: `86aae73 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/86aae7321287758f250af2cb9f2ee55a8d771cfa>`_

[BUGFIX] Nodes copied recursive under circumstances
-----------------------------------------------------------------------------------------

The copy of a node leads to recursive copy.
Result is f.e. and endless copy of an image on itself.
This happens because a comparison of objects fails.
I don't know exactly wich property is not equal, but i think it is
the FirstLevelNodeCache, wich is a part of the node context.
I guess, this cache changed during runtime in some circumstances.
So the check is done now by comparison of the node->getIdendifier().

* Resolves: `#58272 <http://forge.typo3.org/issues/58272>`_
* Commit: `31389ff <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/31389ff9e8108e1b7a096d738e9898360558cfab>`_

[BUGFIX] Remove var_dump() from RenameDimension
-----------------------------------------------------------------------------------------

no comment

* Commit: `27485a9 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/27485a962e4323effb44d310b4ba78af32fa1911>`_

[TASK] Remove support for "locale" context property
-----------------------------------------------------------------------------------------

In a previous change, some backwards compatible handling of the "locale"
context property was introduced which set the "locales" content dimension
value accordingly if a "locale" context property was found.

This change removes support for this old context property and silently
ignores it if present.

Background: although the "locale" context property was allowed previously
it never had any effect in terms of Neos' or Flow's behaviour. Supporting
the "locale" context property like we did before this change would
additionally bind TYPO3CR to the Neos content dimension for languages.

Also provides a Node migration to move from locales to languages to keep
existing translations from previous betas:

   ./flow node:migrate 20140516221523

Related: NEOS-116

* Commit: `53c4a73 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/53c4a731a9ea45fe201e6b70d358c348d3bed536>`_

[TASK] Adjust to renaming of "locales" dimension to "languages"
-----------------------------------------------------------------------------------------

Event though TYPO3CR does not specifically support or even know about
the "languages" content dimension in Neos, tests do mention this dimension
for testing purposes. Since "locales" has been renamed to "languages"
in Neos, all occurrences of "locales" have been replaced by
"languages" by this change.

* Commit: `d636e51 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/d636e51b964cd9b3daf66fb449da3447f5cc1da6>`_

[BUGFIX] Fix findNodeDataInTargetWorkspace to work with shine-through nodes
-----------------------------------------------------------------------------------------

This change fixes a bug which was the cause that created multiple new nodes of
node variants instead of updating / removing the existing ones. The main issue
here was, that the "findNodeDataInTargetWorkspace" method didn't take the real
node dimensions into account which can be different from the context dimensions
that that method used so far.

* Commit: `d942c97 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/d942c972af2fb8eb73dca415b9ce9775a737b7ae>`_

[BUGFIX] Make the Behavior test more compatible to custom Setups
-----------------------------------------------------------------------------------------

Currently the "iShouldHaveTheFollowingNodes" asserts the properties
to be exactly as specified. Problem is that this can cause the Tests to fail
when custom properties with defaults are added by local Sitepackages.
This change alters that test to assert each specified property to be equal
ignoring additional existing properties.

* Commit: `198ba9c <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/198ba9c1c9b0cebe3f5923c62b3bcfe6d899c639>`_

[FEATURE] Add FileMonitor to watch changes in NodeTypes.yaml
-----------------------------------------------------------------------------------------

Custom FileMonitor to watch for changes in NodeTypes used
to flush the Neos Content Cache.

Needs Id4aebb951f27b7befe1c1be81301b12679440bfc in TYPO3.Flow

* Commit: `427e86f <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/427e86f0c88027764d74f9967c2035732e6971a9>`_

[FEATURE] Migration to dimensions
-----------------------------------------------------------------------------------------

Adjusts NodeData to actually allow changing the dimensions.
Adds Migration Filter for DimensionValues and a Transformation
to SetDimensions. With those you can migrate from a state
without dimensions to the default dimension values and also
from any specific dimension set to another set. Which is useful
to change the default language at some point.

The Node Migration added is to move a site from a state without
dimensions to configured default dimension values.

* Commit: `05a2d14 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/05a2d14e3480a829c8fdd5ecbfc9a8efa09c9229>`_

[TASK] Add documentation to NodeDataRepository about internal use
-----------------------------------------------------------------------------------------

The internal use of that class was not documented correctly.

* Commit: `f905602 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/f905602d9a0eb4a605dc63a904beb4136d8d8d79>`_

[BUGFIX] Node references throws exception during mapping
-----------------------------------------------------------------------------------------

If44540ce476c6c85f4665ab3c4bf938fa0cf7d33 introduced a
regression caused by trying to parse all node property
types, causing InvalidTypeException for unknown types
like "reference" and "references".

* Commit: `6030215 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/60302152e1549352e7ea74638d69bd7c14d30aa7>`_

[BUGFIX] Adopted node ignores dimensions within context
-----------------------------------------------------------------------------------------

When adopting a node that already exists in the context it's
returned even if the node dimensions don't match the context target
dimensions. Same happens for nodes that can be retrieved through
fallback dimensions in another context. Instead the node should be
adopted to the specific target dimensions of the context or an existing
node that matches the target dimension values should be reused.

* Commit: `afcfe49 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/afcfe49c67d7f5b7065c59fc8d4c000a9258ddf8>`_

[TASK] Add test for node createVariantForContext
-----------------------------------------------------------------------------------------

* Commit: `cb25901 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/cb259016fdcc87a5d405fcfe9f34079360e128b0>`_

[FEATURE] Support array with element type for node properties
-----------------------------------------------------------------------------------------

This change adds support for arrays with element type
(e.g. array<TYPO3\\Media\\Domain\\Model\\Asset>) as a node property type.

This is needed for multi-valued node properties (AssetEditor in Neos).

* Commit: `313ae96 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/313ae9603d9cae14007083fc1c32c30f036779a4>`_

[BUGFIX] Node factory ignores dimensions for internal cache
-----------------------------------------------------------------------------------------

When creating new nodes from node data the node factory ignores
the dimension values of the node data causing it to return cached
nodes with different dimension values.

* Commit: `e853e20 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/e853e207526d73c9273c0106b29cb63c756ce416>`_

[BUGFIX] Show master plugins in PluginView inspector
-----------------------------------------------------------------------------------------

The integration of "content dimensions" (implemented with
I96dd82bc2b9861508d180cc265da0e22e8ee56f3) introduced a regression
that prevents the "master plugin" from being displayed in the PluginView
inspector.

This change fixes this by adjusting
``NodeDataRepository::findByParentAndNodeTypeRecursively()`` to the
modified signatures of the lower level methods.

* Commit: `c636f20 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/c636f207f27a50dd84be7f7df93bd34babc22732>`_

[TASK] Use caching when adoptNode creates new variants
-----------------------------------------------------------------------------------------

* Commit: `647f8eb <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/647f8ebc1baf53b156b144676f3bf49711915706>`_

[TASK] Use caching for getNodesOnPath in context
-----------------------------------------------------------------------------------------

* Commit: `de631f5 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/de631f5ebba0270f8655dd9b438c642e43059662>`_

[!!!][TASK] Node Migrations work on NodeData
-----------------------------------------------------------------------------------------

Node Migrations now work on NodeData directly and do not
take Context into consideration anymore.

Another change will follow to filter by workspace if that
is really needed for a migration.

This is considered breaking if you added your own Transformations
or Filters for Node Migrations or rely on them to only apply to a
specific workspace.

Resolves: NEOS-43

* Commit: `1bce157 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/1bce157137bde511880dfcbf83bed93c8a4a019d>`_

[BUGFIX] Revert automatic child node cleanup on publish
-----------------------------------------------------------------------------------------

With I0119e356d415f5d1d881a09fdcb6aedba97a0d46 a regression was
introduced that could lead to loosing content on publishing of
ContentCollections due to the automatic cleanup of child nodes.

The automatic removal was removed, child nodes are no longer
cleaned up after switchting the node type. This problem will be
solved in a later commit.

Fixes: NEOS-94

* Commit: `8e2403a <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/8e2403afa36949148c9f02ff5cdf4cc5947f80bb>`_

[BUGFIX] Use generated node identifier for stable child node creation
-----------------------------------------------------------------------------------------

The change I71e9ae994c361d72804f49a3080f6706e8e62e82 introduced a
regression when creating multiple nodes without an identifier that are
nested and have the same child node names. The identifier of a node
created with "createNode" and no given identifier will be always the
same for all child-nodes.

Fixes: NEOS-90

* Commit: `1b093d7 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/1b093d7fd459f81292d0a14de105b5190a167c1e>`_

[BUGFIX] Child nodes that are auto-created have to be materialized
-----------------------------------------------------------------------------------------

If a node is adopted to a different context or materialized to a
different content dimension the child nodes that are auto-created were
not correctly processed.

Additionally fix a problem with auto-created child nodes and multiple
dimensions through createNode() where the child nodes hat different
identifiers.

* Commit: `939e8d5 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/939e8d5a244fd3ba92198b33cef1814950647265>`_

[BUGFIX] Child nodes are not deleted when a node is deleted
-----------------------------------------------------------------------------------------

This moves deletion of child nodes of a node from NodeData::remove()
to Node::remove() so that all child nodes get materialized into current
workspace and marked for deletion.

Fixes: #NEOS-49

* Commit: `d43528b <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/d43528bd4b5773b5380be92114368ccab816991f>`_

[BUGFIX] Consistent generation of dimension hash
-----------------------------------------------------------------------------------------

Removes some duplicated code for generating the dimension
values and moves the generation of the hash into the same method
that generates the array of dimension values to have them in
sync all the time. Additionally sorts the dimension array by key
to have consistent hashes generated at all times.

* Commit: `8c61de1 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/8c61de100e6714d93fa7e53ac6a3331966cd12ec>`_

[BUGFIX] isNodeOfType() uses method call on string
-----------------------------------------------------------------------------------------

The isOfNodeType() method on NodeService accepted strings per docblock
but inside the argument was handled like a NodeType instance. Now
NodeType is used and requested.

* Related: `#48307 <http://forge.typo3.org/issues/48307>`_
* Commit: `7f5c8f7 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/7f5c8f7a24c4c51fd8bde90849c46efa6b089d9d>`_

[FEATURE] Allow split source for node types configuration
-----------------------------------------------------------------------------------------

Resolves: NEOS-72

* Commit: `ff91a3a <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/ff91a3a869c17841cb3abf5db133009cd5c07704>`_

[FEATURE] Node Type Switching
-----------------------------------------------------------------------------------------

Adds NodeType switching support to the ``NodeConverter``.
The NodeConverter now supports:

* Changing the NodeType of a given Node
* Creating missing child nodes
* Setting node default values

Changing the NodeType is not allowed in `live` workspace.
The invalid properties / child nodes are not removed, to allow the
use to restore the previous NodeType without data lost. The Node
will be cleaned up during publishing.

This patch also makes sure care that a published node contains only
valid properties and child nodes. Currently all child nodes based on
``TYPO3.Neos:Document`` are never removed. This means that if the
child node based on TYPO3.Neos:Document is declared in the childNodes
section of NodeType, it will not be removed.

* Resolves: `#48307 <http://forge.typo3.org/issues/48307>`_
* Commit: `253b930 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/253b930263426bd79677625d8997c070a2594093>`_

[FEATURE] Add discard methods to the PublishingService
-----------------------------------------------------------------------------------------

Changes could be published but not discarded from user workspaces.
Now the PublishingService had discardNode() and discardNodes() for
that purpose.

* Commit: `bb6693a <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/bb6693a5447ed6bfe1f5fbee857fe6f43927f133>`_

[TASK] Fix doc block for NodeDataRepository findOneByPathInContext
-----------------------------------------------------------------------------------------

* Commit: `97c3092 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/97c3092528a48292a8248b13b528951708c28ef3>`_

[TASK] code cleanup in NodeConverter and NodeTemplateConverter
-----------------------------------------------------------------------------------------

* Commit: `7d5a021 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/7d5a02192787eb1bad246bbf97d4f1d53362ac60>`_

[BUGFIX] followup to Idf348e02bb581ffde1db849375c30088b82de1bb, fixing a fatal error
-----------------------------------------------------------------------------------------

* Commit: `c4c9850 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/c4c985078fb3844f2ebfe9be03b197fa961435a5>`_

[BUGFIX] support multiple-value dimensions
-----------------------------------------------------------------------------------------

Before this change, this was not supported in the regex which parses
context node paths.

* Commit: `b9bf798 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/b9bf798406b5e567598211c350fa508f170164e1>`_

[TASK] refactored dimension value extraction
-----------------------------------------------------------------------------------------

* Commit: `15d566a <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/15d566a765a8c644411ca059f2debf03fff716f3>`_

[TASK] add functional tests for NodeConverter
-----------------------------------------------------------------------------------------

Related: NEOS-35

* Commit: `72fe716 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/72fe716f6384d9f33252a810e3fc0571fa9d37f9>`_

[FEATURE] Remove dependency on TYPO3.Neos PublishingService
-----------------------------------------------------------------------------------------

Remove dependency to publishing service in TYPO3.Neos
by providing a PublishingServiceInterface that
can be overwritten in Objects.yaml

Also introduce a generic publishing service for easy
extending of another publishing mechanisms.

* Resolves: `#46464 <http://forge.typo3.org/issues/46464>`_
* Commit: `0c3ac3b <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/0c3ac3b670da24faf0af07a637c4a2af7877a518>`_

[BUGFIX] Dimension support in NodeConverter and removal of UUID string support
-----------------------------------------------------------------------------------------

Because UUID strings do not carry dimension information, we cannot
support them anymore.

* Commit: `bb1acdb <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/bb1acdb6050185fb6ff986bdeccec8b22dd972b0>`_

[TASK] Use DQL in NodeDataRepository::renumberIndexesInLevel
-----------------------------------------------------------------------------------------

This patch improve performance if a lots of node are in the current level
by using DQL for the select and the update operation.

* Commit: `d97ed5c <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/d97ed5c75ceffd8f4e1c59f4c19ecdc51e433519>`_

[BUGFIX] The context path of a node should always contain the workspace name
-----------------------------------------------------------------------------------------

This is a bugfix for content dimensions.

* Commit: `c5f6d5a <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/c5f6d5ad20721f1795f6176153c6d23b50a74c8e>`_

[TASK] Introduce removeAllInPath
-----------------------------------------------------------------------------------------

To be able to remove all nodes inside a certain path a new
low level method was introduced that accepts a node path
and will remove all NodeData entries below that path
(but not the node with the exact path).
This method does not care about workspaces or dimensions
it will directly delete all matching NodeData entries.

* Commit: `aff8cea <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/aff8cea3a2bb999af6a9f9d81a9fd928a220e57b>`_

[BUGFIX] fix boolean property conversion when not using ExtDirect
-----------------------------------------------------------------------------------------

There are not only _hidden and _deleted as boolean properties,
but they can be arbitrary. That's why this conversion must be done
for all conversions in the schema.

This bug was not triggered yet because the change which gets rid
of ExtDirect was not yet merged.

* Commit: `954ba16 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/954ba16cb1824589f24f56911c9147a670b64252>`_

[FEATURE] Add recursive flag to findByParentAndNodeTypeInContext
-----------------------------------------------------------------------------------------

Add a recursive flag to the findByParentAndNodeTypeInContext,
which findByParentAndNodeType supports.

* Commit: `713f147 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/713f147ea8cb6b9bdba702d3b878224c4ed0dbf3>`_

[TASK] Fix various CGL violations
-----------------------------------------------------------------------------------------

* Commit: `bb62b87 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/bb62b875b208b0e2dbaf4e047ba6846bd37d748b>`_

[BUGFIX] PostgreSQL migration error: "dimensionshash" contains null
-----------------------------------------------------------------------------------------

This fixes an error while doctrine:migrate on a PostgreSQL database when
adding a NOT NULL column to table typo3_typo3cr_domain_model_nodedata
already having rows in it.

* Commit: `231f119 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/231f11946f663bcaab814618a95877b3131af18f>`_

[TASK] Clarify documentation for *NodePublishing signals
-----------------------------------------------------------------------------------------

* Commit: `047ed00 <https://git.typo3.org/Packages/TYPO3.TYPO3CR.git/commit/047ed00c6c75e23f417d03d6abdc5d33731ea8ae>`_

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TYPO3.TypoScript
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[TASK] Mark migration as merged
-----------------------------------------------------------------------------------------

This commit marks some migrations as merged that are not needed on this
package. This speeds up core:migrate and avoids potential errors.

* Commit: `270cf20 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/270cf20382d973f1ec0e25ed1165078679a1fe47>`_

[BUGFIX] Adjust code migration identifier pattern to contain the full timestamp
-----------------------------------------------------------------------------------------

Previously code migrations are expected to have a class name with the
pattern ``Version<YYYYMMDDhhmm>`` and the unique identifier was
determined extracting the last 12 characters of the class name (which
are expected to be the timestamp).

This change adjusts existing code migrations to return the old identifier
so that they won't be applied again.

Related: FLOW-110

* Commit: `2bb61ad <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/2bb61ad41cbec4b5d81beb50975ebdbf4914f5bd>`_

[TASK] Wrap HTML message exception handler title
-----------------------------------------------------------------------------------------

Related: NEOS-344

* Commit: `202d83e <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/202d83ee86d56bf47605b364f69867c55bb97bf9>`_

[FEATURE] TypoScript prototype to handle HTTP headers and response status
-----------------------------------------------------------------------------------------

This change add a new TypoScript prototype that can be used to generate
a standard HTTP head response::

    prototype(TYPO3.TypoScript:Http.ResponseHead) {
    	statusCode = 200
    	headers {
    		Content-Type = "application/json"
    	}
    }

This change also introduces another prototype ``TYPO3.TypoScript:Http.Message``
which extends ``TYPO3.TypoScript:Array`` and makes it easier to work with
HTTP messages. It is mostly a base prototype to render documents
that support setting HTTP header data.

Resolves: NEOS-449

* Commit: `70625fd <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/70625fd59a9e20bbc4cc31757d022e80aef4cfd1>`_

[FEATURE] Implement TypoScript inclusion globbing
-----------------------------------------------------------------------------------------

The "include: " statement of TypoScript now allows normal and recursive
file globbing.

* ``*`` – includes all of the ts2 files on that level
* ``**/*`` – includes all of the ts2 files recursively starting with that
  level.

This works with relative and ``resource://`` links. Recursion is avoided
by not allowing to include the same .ts2 file as the one from which it
was called.

Example ``Root.ts2``::

  # Include all .ts2 files in NodeTypes and it's subfolders recursively
  include: NodeTypes/**/*

Resolves: NEOS-440

* Commit: `da148ae <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/da148ae56b7439bd41a5b84b200a8573e3a1ed09>`_

[!!!][TASK] Adapt TypoScript path patterns
-----------------------------------------------------------------------------------------

We want to have the same folder structure for TypoScript in all packages.

Related: NEOS-390

* Commit: `cc09d06 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/cc09d0630eb526f80261e94f292399786aaa1c83>`_

[BUGFIX] Uncached context does not work with Doctrine Proxy
-----------------------------------------------------------------------------------------

Realted: NEOS-448

* Commit: `8662691 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/8662691edadd98403ac0827a4b77feb8afa4c9d6>`_

[FEATURE] @if meta property for conditional evaluation of paths
-----------------------------------------------------------------------------------------

Introduce a new @if meta property that can be used to add conditions
to paths. If one of these conditions (simple value, expression or object)
evaluates to FALSE, the path is evaluated to NULL.

The @if meta property can be applied to all TypoScript paths.

Example::

	example {
		@if.isSpecial = ${q(node).property('special')}
	}

Resolves: NEOS-109

* Commit: `7056d03 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/7056d035389d14bd6d88826459a27ea396518f69>`_

[BUGFIX] Ignore empty tags in @cache.entryTags configuration
-----------------------------------------------------------------------------------------

When unsetting a tag in TypoScript, the resulting value will be an empty
(null) tag. This is not allowed in the caching framework which will
throw an exception for this case.

This change ignores empty tag values so unsetting a key in the entryTags
configuration is possible.

* Commit: `c00459f <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/c00459f0d8771821425b26ba3fc443295539668e>`_

[!!!][TASK] Change handling of empty, false and null attribute values
-----------------------------------------------------------------------------------------

This change updates the rendering of boolean and null attribute values.
A boolean value is rendered as an empty attribute or no attribute
at all. A null or empty string attribute value will be rendered as an
empty attribute (HTML5 syntax).

This will be breaking if code relied on the previous conversion of values
or the output is used for XML, where the new meta property ``@allowEmpty``
should be used to disable empty attributes.

Resolves: NEOS-275

* Commit: `e3fda90 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/e3fda907b680b52c07f9a7bef048661ef327728b>`_

[TASK] Allow configuring exceptionHandlers on any TypoScript object
-----------------------------------------------------------------------------------------

Without this change the configured exceptionHandler is only used on the
root TypoScript object that is rendered by the Runtime::render() method.
Now every configured exceptionHandler is taken into account.

For this to work the change introduces a differentation between "inner"
(triggered by Runtime::evaluateInternal()) and "outer" (triggered by
Runtime::render()) exception handling to have different default handlers.
the default "inner" handler is the new "BubblingHandler" that wraps the
Exception in a RuntimeException and so bubbles it up until handled by
another handler. That way all "inner" Exceptions are at some point handled
by the "outer" Exception handler as before so in most cases behavior is
unchanged. Behavior is changed in cases where an inner exceptionHandler is
configured via TypoScript (for example the TYPO3.TypoScript:ResourceUri
prototype) that was ignored without this change.

Additionally handling an exception that is not handled by an
"AbsorbingHandler" will disable caching (which was before only done in
the "outer" exception handling in Runtime::render()).

Resolves: NEOS-326

* Commit: `6de2d2f <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/6de2d2f27942ce3c6a63b0956b0d7d92a657f127>`_

[BUGFIX] Underscore is not allowed as a TypoScript path value
-----------------------------------------------------------------------------------------

Furthermore, fixed some comment indentations in the Parser

* Commit: `0ee12bd <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/0ee12bd3db5f7189531cbc2ff4134d9211c3e674>`_

[TASK] Add JsonHelper to default context for TypoScript
-----------------------------------------------------------------------------------------

The newly added JsonHelper is available as ``Json`` in
TypoScript contexts now.

Related: I042025b5515bda19d09b5ddcab3c46bb3a2f61d9

* Commit: `e600557 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/e60055719a0dff4e37502c1fa4930979b8c0180c>`_

[FEATURE] Allow direct evaluation of Matcher renderer
-----------------------------------------------------------------------------------------

with the new configuration setting "renderer" the matcher
can now directly evaluate TypoScript as return value.
This setting has precedence over the renderPath and type
settings.

Example::
  root {
    fooMatcher {
      condition = ${TRUE}
      renderer = ${q(node).property('title')}
    }
  }

* Commit: `fecede4 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/fecede42f76c4f186b85cfd8302745ab206959ed>`_

[BUGFIX] TypoScriptRuntime should not intercept Login redirect
-----------------------------------------------------------------------------------------

This changes changes the TypoScript Runtime to rethrow any Security
exception it encounters. Without this the login redirect does not work.

* Commit: `555908b <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/555908bc8dbd98ea1879c6456629e7bc0731d8be>`_

[BUGFIX] Request in context cannot be serialized
-----------------------------------------------------------------------------------------

The request in the TypoScript context cannot be serialized for uncached
segments. This means an uncached TypoScript cannot use the request.
To have the current Request at any time in the context it is injected
together with the default context variables.

Additionally default context objects now come from the object manager
so singleton scope objects are correctly object managed.

* Commit: `9012e70 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/9012e704f0ba605595ea6840b77cf5674194698a>`_

[TASK] Apply migration TYPO3.Neos.NodeTypes-201309111655
-----------------------------------------------------------------------------------------

This is a tweaked version of the ``TYPO3.Neos.NodeTypes-201309111655``
code migration that break unit tests when applied without changes.

* Commit: `947535e <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/947535e1f615b0ee353d9c6fbb17f1298e60af78>`_

[BUGFIX] Context-specific prototype inheritance should work
-----------------------------------------------------------------------------------------

Let's imagine you have the following TypoScript::

    prototype(A).value = "Foo"
    prototype(B) < prototype(A)

    myValue.prototype(A).value = "Bar"
    myvalue.element = B

When rendering myvalue/element, we'd expect the "value" property to evaluate
to "Bar", because it has been *overridden* inside myvalue.*

Without this change, this did not work because the prototype inheritance
hierarchy was flattened on toplevel; and not recursively at runtime.

Fixes: NEOS-59

* Commit: `1d28ea1 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/1d28ea164029014793f7f2b68d74d82a66fa9461>`_

[TASK] Improve exception handling in TypoScript rendering
-----------------------------------------------------------------------------------------

If Fluid object access is used to render TypoScript objects (which is
the default of the generated template in the site kickstarter) and an
exception occurs during rendering, the rendered message should be at the
correct position in the template.

This change adds tests to verify the correct output of exception
messages in different scenarios.

* Commit: `399a582 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/399a582d132af48c7dd3bacd96e72e5d9240e2e3>`_

[TASK] Refactor cache functionality in Runtime
-----------------------------------------------------------------------------------------

Add a new class RuntimeContentCache that serves as the integration point
between the TypoScript Runtime and the ContentCache. The class holds
all runtime-global state and makes the Runtime implementation much
easier to follow.

* Commit: `6447b92 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/6447b9214d3ad22ce02ce7d554fae0dfd9c71ce9>`_

[TASK] Support configurable cache lifetime through TypoScript
-----------------------------------------------------------------------------------------

Add a @cache.maximumLifetime configuration for _every_ path in
TypoScript. A cached segment will use the minimum of the
maximumLifetime values (from embedded cache segments and itself).

All cached segments have an independent cache entry lifetime.

This allows to render time dependent data (like nodes with
hiddenAfterDateTime or hiddenBeforeDateTime) using additional helpers to
find the relevant lifetimes.

Resolves: NEOS-68

* Commit: `7ad1ac2 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/7ad1ac2f2533261826a16efccbd6d49979ca4fdb>`_

[TASK] Flush content cache in more occasions
-----------------------------------------------------------------------------------------

At the moment we clear the content cache if TypoScript, Fluid
or NodeTypes.yaml changes. This covers most cases, but not all.

This change also clears the content cache if settings, translations
or PHP code changes. This makes sure that the content cache does
not cause problems for people working in PHP plugins / TypoScript
objects or translation files.

* Commit: `08f692e <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/08f692ed69c3380c43c611f798a9cf29b5a0ab24>`_

[FEATURE] Re-throw unchanged exception in ThrowingHandler
-----------------------------------------------------------------------------------------

To get accurate TypoScript paths for the original exception, the
ThrowingHandler should just throw the given exception without
unwrapping a TypoScript RuntimeException.

Since there could now be a RuntimeException at the outer TypoScriptView
render call, we need to catch it and unwrap it there.

The system logger calls are moved to the exception handlers to save some
calls since duplicated exceptions would show up for each instance of a
ThrowingHandler.

* Commit: `29d8aaa <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/29d8aaacf9ff2f1d3a8e9b6cd915d0f0f04e8b3a>`_

[FEATURE] Add FileMonitor for TypoScript and Cache clearing
-----------------------------------------------------------------------------------------

Custom FileMonitor to watch changes in TypoScript files.
Adds flushing of the content cache when either NodeTypes,
TypoScript or Template files are changed.

Needs: Id4aebb951f27b7befe1c1be81301b12679440bfc in TYPO3.Flow

* Commit: `f77928e <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/f77928e7097b5828e27d45ef474fcd8072b0efec>`_

[TASK] Build entryIdentifier from valid context values by default
-----------------------------------------------------------------------------------------

This change updates the Runtime to use all valid context values
(string, integer, boolean, object implementing CacheAwareInterface)
as the default cache identifier values if no "@cache.entryIdentifier"
configuration is given.

If the user specified an invalid value in the "@cache.entryIdentifier"
configuration an exception will be thrown.

Resolves: NEOS-75

* Commit: `c3bdd0c <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/c3bdd0c86e19bcfbe4a841973ee5a7c31903e90e>`_

[TASK] improve functional test coverage of TypoScript
-----------------------------------------------------------------------------------------

* Commit: `4218c46 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/4218c468556b1dd0342d11fd08b4cc0de4bb3f85>`_

[BUGFIX] Remove cache segment markers also if an exception occurred
-----------------------------------------------------------------------------------------

This removes cache segment markers also if an exception occurred in an
inner cached path. This fixes the problem where leftover cache segment
markers showed up in the content.

* Commit: `7f96c8c <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/7f96c8c3aeb4a04f60f12aee8ab7a7ef77f36ae6>`_

[TASK] Throw an exception if an uncached segment has no context
-----------------------------------------------------------------------------------------

Currently an uncached TypoScript cache segment without at least one
context variable throws a really nasty exception. The user can not
understand that the problem came from the cache configuration. This
patch adds a proper Exception for this case.

Resolves: NEOS-83

* Commit: `ca51344 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/ca5134481fcaa6d183d74ec4dcc8a075fdced4af>`_

[BUGFIX] Fixes Incompatibility with PHP 5.3
-----------------------------------------------------------------------------------------

Replaced call to self:: in an anonymous function to prevent PHP 5.3
from throwing a Fatal Error (Cannot access self:: when no class scope
is active).

* Resolves: `#57465 <http://forge.typo3.org/issues/57465>`_
* Commit: `2e859b1 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/2e859b1c0b44dd6f34b648aeec2780e5988543eb>`_

[TASK] Fix various CGL violations
-----------------------------------------------------------------------------------------

* Commit: `a3609c8 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/a3609c8a67a24e3bc139530fadffd137762e5559>`_

[TASK] Register the TYPO3.Eel MathHelper in the TypoScript EEL context
-----------------------------------------------------------------------------------------

This change enables the use of MathHelper functions inside TypoScript
EEL expressions:

	maximumWidth = ${Math.round(1200 / gallery.rows)}

Note that there aren't so many functions in MathHelper for now, but that
will probably change.

* Commit: `cc5fc65 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/cc5fc6521ed5ce728bf4918eb5bb0009a04dd435>`_

[TASK] Disable content caching if an exception occurs
-----------------------------------------------------------------------------------------

This change disables the content cache in the render() method of the
TypoScript runtime if an exception occurred. Previously, error messages
might have been cached and thus displayed even if the error does not
occur anymore.

While this is not the most graceful or beautiful solution, it solves the
problem of cached error messages.

* Commit: `06a2947 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/06a29470eabf2c9d9e241e2b8371a9248662a138>`_

[TASK] Clean up docblocks in core exception handlers
-----------------------------------------------------------------------------------------

* Commit: `11cfcf0 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/11cfcf068501a0d6cb67db2a944fa47651c6cc05>`_

[BUGFIX] TYPO3.TypoScript:UriBuilder uses undefined method
-----------------------------------------------------------------------------------------

The TYPO3.TypoScript:UriBuilder objects uses getTsRuntime() internally.

This is probably a leftover because it first extended the
TemplateImplementation object. This change replaces the call
by accessing the tsRuntime property directly.

* Fixes: `#56891 <http://forge.typo3.org/issues/56891>`_
* Commit: `cb6ee89 <https://git.typo3.org/Packages/TYPO3.TypoScript.git/commit/cb6ee8913393c97ef2fabe63a4e7cf6476c3f383>`_

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TYPO3.Media
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[TASK] Mark migrations as merged
-----------------------------------------------------------------------------------------

This commit marks some migrations as merged that are not needed on this
package. This speeds up core:migrate and avoids potential errors.

* Commit: `e293398 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/e293398b341726e4242392a3919b59e084408953>`_

[FEATURE] ImageTag and ImageUri TypoScript objects
-----------------------------------------------------------------------------------------

Extracts some duplicate code into the ImageViewService and provides
TypoScript counterparts of the image and uri.image view helpers.

``ImageTag`` example::

  # Create an img tag with alt attribute for 100*100 cropped image
  exampleImageTag = TYPO3.Media:ImageTag {
  	asset = ${q(node).property('image')}
  	maximumWidth = 100
  	maximumHeight = 100
  	allowCropping = TRUE
  	allowUpScaling = TRUE
  	attributes.alt = 'Do not forget the alt text'
  }

``ImageUri`` example::

  # Create an image URI for 100*100 cropped image
  exampleImageUri = TYPO3.Media:ImageUri {
  	asset = ${q(node).property('image')}
  	maximumWidth = 100
  	maximumHeight = 100
  	allowCropping = TRUE
  	allowUpScaling = TRUE
  }

Resolves: NEOS-491

* Commit: `4a3ff90 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/4a3ff9047f062434b9e4ae7bc90705db99bb71d5>`_

[TASK] Throw correct exceptions in view helpers
-----------------------------------------------------------------------------------------

Throw actual view helper exceptions so Fluid
can handle them properly.

Additionally adds missing unique exception codes.

* Commit: `255fe77 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/255fe7730b843a822b06d0b2805d07b3eab5d189>`_

[TASK] Optimize the asset repository's countByTag method
-----------------------------------------------------------------------------------------

Optimizes the count by tag query by a factor 400-500% by not joining all
the subtype tables and tag table on, which doctrines does on its own.

This is needed because when having lots of tags results in long load
times for all media browser views where all the tags are displayed.
This is due to the count for each tag takes quite some time (16-30 ms),
which is a lot when multiplied by 100+.

Fixes: NEOS-642

* Commit: `205d066 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/205d06682c4ef0f7f55199d22d704651f5cef90c>`_

[TASK] Export identity of images and resources in ArrayConverter
-----------------------------------------------------------------------------------------

This exports the identity of Images contained in ImageVariants and of
Resources in Assets to the target array.

Related: NEOS-158

* Commit: `ca18001 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/ca18001b9c4ee56e3b912e06c964386daad724c0>`_

[BUGFIX] ImageVariant processing instructions ignored for thumbnails
-----------------------------------------------------------------------------------------

When the getThumbnail method on a image variant is called, the image
variant's processing instructions are ignored.

When creating a thumbnail for a image variant it doesn't make sense
to show the original image's thumbnail instead, if that is desired
that can easily be achieved.

Fixes: NEOS-386

* Commit: `6e846c7 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/6e846c7b74eff9435e127621808cedf2efbc693e>`_

[TASK] Replace assign with assignMultiple in AssetController
-----------------------------------------------------------------------------------------

This commit replaces the usage of assign with assignMultiple
where it is possible in the AssetController.

* Commit: `b47111a <https://git.typo3.org/Packages/TYPO3.Media.git/commit/b47111a9bb9d3a81c0493a94d83b1a9367fb504d>`_

[FEATURE] Support all assets in ArrayConverter
-----------------------------------------------------------------------------------------

This makes the ArrayConverter accept all AssetInterface instances and
provide basic conversion.

Related: NEOS-166

* Commit: `8b3c7aa <https://git.typo3.org/Packages/TYPO3.Media.git/commit/8b3c7aa8523629b3de335cfd40988dfa079ab78a>`_

[TASK] Unify button styling in Media management
-----------------------------------------------------------------------------------------

The submit button should be blue.

Resolves: NEOS-222

* Commit: `e656506 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/e6565064d389daa06a5e0aa44ca830b0527c2fc9>`_

[TASK] Escape caption text in thumbnail view
-----------------------------------------------------------------------------------------

Fixes: NEOS-237

* Commit: `47c3f74 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/47c3f745c2f28120d98f611cf9e6782970797a5e>`_

[TASK] Add support for animated GIF
-----------------------------------------------------------------------------------------

This change detects if the current image is an animated GIF to process
every layer correctly and keep the gif as animated.

Support for animated GIF is not available with the Imagine Gd or Gmagick
drivers, you must use Imagick. The driver can be configured in the
settings of TYPO3.Imagine package.

Resolves: NEOS-243

* Commit: `fb51c72 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/fb51c72f200fd4b0ad36192a56494357dfef26e6>`_

[TASK] Update default options, based on recent changes in Imagine
-----------------------------------------------------------------------------------------

The "quality" option of Imagine library has been renamed to
"jpeg_quality" and support for a new "png_compression_level"
options has been added.

This patch keeps our existing "quality" settings. This setting is
converted internally to the native Imagine options.

This change is related to I63683bc2c4dc77db98a1a53d9541cbd1db1fa45f

Resolves: NEOS-242

* Commit: `74dd4d7 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/74dd4d7eba9b2efa6f047ea81cdf3bb16306020a>`_

[FEATURE] Add Image(Variant) to array type converter
-----------------------------------------------------------------------------------------

This change adds a TypeConverter to use with the PropertyMapper. It will
transform Image and ImageVariant to array and is the counterpart to the
Image(Variant)Converter.

* Commit: `d3803d5 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/d3803d59dc700a860deae13523f7e6c793928c72>`_

[TASK] Trivial tweak to typos in comment and error message
-----------------------------------------------------------------------------------------

* Commit: `23a09db <https://git.typo3.org/Packages/TYPO3.Media.git/commit/23a09dbc4207bd0953bbdf08992f71d070767d51>`_

[TASK] Use filename instead of identifier as label for assets
-----------------------------------------------------------------------------------------

Related: NEOS-233

* Commit: `b8fa87e <https://git.typo3.org/Packages/TYPO3.Media.git/commit/b8fa87ef8da8005f7cf3e263cac3fc88fa9d0a35>`_

[TASK] Match filenames in asset search
-----------------------------------------------------------------------------------------

When searching for assets the filename is now included
in the search criteria allowing assets without titles
to be found.

Resolves: NEOS-234

* Commit: `cc58553 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/cc585530163caa95e6e99cb3249935d7a7291a78>`_

[BUGFIX] Functional tests use sys_get_temp_dir()
-----------------------------------------------------------------------------------------

The functional tests use the sys_get_temp_dir() function which
causes problems if Flow resides on a network share but PHP temp
dir is still set to a local disk.

When this happens PHP will fail to move the file from the local
disk to the network storage as this is not supported by PHP.

* Commit: `1b82b04 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/1b82b045254a4f965120cc8d874810adfb345e59>`_

[BUGFIX] Adjust tests to image size cache
-----------------------------------------------------------------------------------------

The new ImageService uses an additional API method of the
Resource that was not correctly mocked before.
Additionally an Exception for resources that are not images
is now thrown lazily when the actual image is initialized.
The test was adapted to that.

* Commit: `ba2d248 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/ba2d2482abdbf2d91d962f1ac2bb20b554ac30e9>`_

[FEATURE] Add cache for Image size and type
-----------------------------------------------------------------------------------------

The function getimagesize need to load the file from disk on every
call. This patch introduce a new cache to store the height, width
and image type based on resource unique hash.

* Resolves: `#55778 <http://forge.typo3.org/issues/55778>`_
* Commit: `86e505b <https://git.typo3.org/Packages/TYPO3.Media.git/commit/86e505b349b4a8e71f36e32c40babcbd0ab1b4b3>`_

[TASK] Add helper methods for linking to asset support
-----------------------------------------------------------------------------------------

This change adds filtering assets by search term or tag
to the AssetRepository.

Related: #NEOS-20

* Commit: `535db44 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/535db445a0c1efc6d94ea1cbf05004a6524045d5>`_

[BUGFIX] Selection of image in thumbnail view is broken
-----------------------------------------------------------------------------------------

With the fix for tagging in thumbnail view the selection of assets from
inside the Neos inspector was broken.

* Commit: `d1b1a90 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/d1b1a90d962af91892fa3da37a451f8bced95c8d>`_

[BUGFIX] Drag 'n drop tagging of thumbnails
-----------------------------------------------------------------------------------------

The identifier can only be found for the list view and not the
thumbnail view making it impossible to tag by drag 'n drop in
the thumbnail view.

Also when dragging a thumbnail the A tag is clicked so the link
is followed when dropping a thumbnail onto a tag.

Additionally when the A tag is used for dragging it's very
performance requiring, so only dragging the image container
improves performance drasticly.

* Commit: `d440b32 <https://git.typo3.org/Packages/TYPO3.Media.git/commit/d440b3261fdb1fed2eec869afd1bcd4294ca9a34>`_

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TYPO3.NeosDemoTypo3Org
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[TASK] Styling adjustments to language menu
-----------------------------------------------------------------------------------------

* Commit: `d93c6ce <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/d93c6ce5e93dbf1960434819b7bbd42d6c9a167a>`_

[FEATURE] Language menu
-----------------------------------------------------------------------------------------

* Commit: `5dfb3ab <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/5dfb3ab82dd42ce5518cdc151b88cb020075bd26>`_

[TASK] Re-export Sites.xml with tidy option
-----------------------------------------------------------------------------------------

This simply is a re-export of the site using the --tidy option to keep
the XML more readable.

This got lost with change I862b2b21e7a3da5cb07f825959e02cd08232fea1.

Also some unused resources are removed.

* Commit: `997309e <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/997309ec8925834e006cf123fc25254c5d59b2ac>`_

[FEATURE] Turn into a multi-lingual website
-----------------------------------------------------------------------------------------

This configures a "language" content dimension with some presets and
includes an updated Sites.xml export. The translation of the actual
content will be part of a separate change.

As Neos 1.2 will only support fallback based translation, all languages
are based on a default "en_US" language.

Resolves: NEOS-168

* Commit: `5d884ae <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/5d884aef0523b6772e720c5be227b6d39e1f6e6e>`_

[TASK] Migrate Sites.xml to translatable URIs
-----------------------------------------------------------------------------------------

Updated the Sites.xml dump using the "node:repair" command.

Related: NEOS-296

* Commit: `e1e5418 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/e1e541860b4ea99795e1e817a88349cb93fdb385>`_

[TASK] Simplify NodeTypes TS inclusion
-----------------------------------------------------------------------------------------

Uses the new TS include globbing to simplify the inclusion of the
NodeTypes TS files.

Related: NEOS-440

* Commit: `b4be05b <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/b4be05b2dc8c47140a8dbb02f5cbff79b527aaeb>`_

[TASK] Adjust to layout properties change
-----------------------------------------------------------------------------------------

(cherry picked from commit b1038d88c55776589bfea2f3866e9b1287ae5517)

* Commit: `6905c80 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/6905c80da3b59ed8cb3ceaa760cfddea8040a197>`_

[TASK] Adapt after the NodeInterface::getFullLabel removal
-----------------------------------------------------------------------------------------

Related: NEOS-441

(cherry picked from commit 3d020e5a50b86c62780fb564af1fe2e4d3a4457a)

* Commit: `2caf8d9 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/2caf8d9f3e4eb274c67f046a86eef72b52abb85b>`_

[BUGFIX] Adjust exported demo site to new shortcut handling
-----------------------------------------------------------------------------------------

Related: NEOS-375

* Commit: `2b1e85f <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/2b1e85f5bea138cd68885a4fd9c973f271d90a78>`_

[TASK] Cleaning up TypoScript folders and namespace usage
-----------------------------------------------------------------------------------------

All packages should use the same folder structure for typoscript files.
For historical reasons this wasn't the case in some packages like the
demo package. This was confusing for many users.

Also a best practise for the namespace usage should be found.

Site specific things can be written much shorter by using a namespace.

Additional packages should be referenced by the whole path it's easy to
find where the objects come from and to share code in snippets for
example.

Related: NEOS-390

* Commit: `1b9a4fe <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/1b9a4fea37472da5bec2b9cc1a2a9a06351c3ea3>`_

[BUGFIX] Fix broken Neos tests by allowing Text node types in teaser
-----------------------------------------------------------------------------------------

This is a workaround to fix broken tests in the Neos package that
depend on a teaser ContentCollection with Text nodes.

* Commit: `a13f26a <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/a13f26a855813fac11bdc35e328b7d0ef5071eb0>`_

[TASK] Apply node type constraints to teaser content collection
-----------------------------------------------------------------------------------------

Uses the new node type constraints to limit the options available
when inserting content in the banner content collection.

Resolves: NEOS-235

* Commit: `b9896b5 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/b9896b599303ef54184545ba7970f7e08d3f878d>`_

[TASK] Remove paragraph formatting in headline element
-----------------------------------------------------------------------------------------

The paragraph formatting in headline element should be removed by
default in TYPO3.Neos.NodeType package.

Related: NEOS-415

* Commit: `fd770f3 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/fd770f35abe9066d3fa0da09aed69f4c86f9c272>`_

[TASK] Adjust to configurable formatless pasting
-----------------------------------------------------------------------------------------

* Commit: `d4461ad <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/d4461ad04739717b006659143aff3b3f1bebbae9>`_

[TASK] Remove unnecessary cache mode configuration for ContentCollection
-----------------------------------------------------------------------------------------

Depends on I50bc64f3224ef79a5d77e5c9715963515d3d0a02

* Commit: `e410f25 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/e410f25a5058a24d4834d2a062acd97684aebb70>`_

[TASK] Remove leftover teaser ContentCollections in chapters
-----------------------------------------------------------------------------------------

The teaser ContentCollection is not an auto created child node for
chapters and the export contains leftovers which are not allowed
according to the Node Type Constraints

* Commit: `4213188 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/421318810168d37d51663a824cb220a30d799a58>`_

[TASK] Position YouTube content element video properties uppermost
-----------------------------------------------------------------------------------------

* Commit: `2a803f2 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/2a803f2fc259039f9a55f6a44665a53a09a4026a>`_

[TASK] Add the homepage to the main menu
-----------------------------------------------------------------------------------------

This change adds the homepage to the menu to show how this can
be done with the following setup:

* Site root contains homepage content
* Homepage should be in main menu without using a shortcut so
  it can have a current state

This is the recommended way to create a menu for this setup
since I4c0a92e3bf068b53c5d0286248feb6e8236894a7

* Commit: `2413956 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/2413956dafaa6c14ed334be638a77a08dc49f3ff>`_

[TASK] Add AssetList example element
-----------------------------------------------------------------------------------------

* Commit: `fc96b4b <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/fc96b4b8b63bc595917a3fe56c691d25ff0cb0e0>`_

[TASK] Update exported site (fixes duplicate images)
-----------------------------------------------------------------------------------------

* Commit: `b5f0669 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/b5f066943c106546b4ad6cf863cf9b80eb42b9e8>`_

[FEATURE] Make title inline editable for chapter pages
-----------------------------------------------------------------------------------------

As an example of using inline properties directly on the page,
the page title is turned into an inline editable property of
the chapter page. This also demonstrates the placeholder feature.

* Related: `#40305 <http://forge.typo3.org/issues/40305>`_
* Commit: `1343b59 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/1343b59c1721068826a54c7cf8efc7a4cf25d320>`_

[TASK] Use text area editor for chapter description
-----------------------------------------------------------------------------------------

* Commit: `bd2651d <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/bd2651d88e45f6ee72ae53b114c00a86a89f9f1f>`_

[BUGFIX] Use node full label instead of title for chapter pager
-----------------------------------------------------------------------------------------

* Commit: `8d0fdd8 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/8d0fdd84554816fc2df6cb03211565ebe031f319>`_

[TASK] Use new BreadcrumbMenu TS object instead of custom template
-----------------------------------------------------------------------------------------

With the new BreadcrumbMenu TypoScript object in TYPO3.Neos we don't
have to use a custom one for the demo site.

* Commit: `d324473 <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/d324473fc5b3a617e4c45f6630aee298069164cb>`_

[TASK] Use fluid container width when logged in
-----------------------------------------------------------------------------------------

Currently parts of the page is hidden behind the inspector
due to a fixed width based on a viewport media query.
Instead it's set to a maximum of that width, although fluid
when logged into the backend. This makes the content element
handles visible all the time.

* Commit: `510999f <https://git.typo3.org/Packages/TYPO3.NeosDemoTypo3Org.git/commit/510999fc1bc7ef936fb3e706da839b502909b47d>`_

